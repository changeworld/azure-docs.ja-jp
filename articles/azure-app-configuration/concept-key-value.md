---
title: Azure App Configuration のキー/値ストア | Microsoft Docs
description: Azure App Configuration に構成データが格納されるしくみの概要
services: azure-app-configuration
documentationcenter: ''
author: yegu-ms
manager: maiye
editor: ''
ms.service: azure-app-configuration
ms.devlang: na
ms.topic: overview
ms.workload: tbd
ms.date: 04/19/2019
ms.author: yegu
ms.openlocfilehash: c7a7e7994ef5e16640f59efdc672f6793bc4f18d
ms.sourcegitcommit: c105ccb7cfae6ee87f50f099a1c035623a2e239b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/09/2019
ms.locfileid: "67706472"
---
# <a name="keys-and-values"></a>キーと値

Azure App Configuration では、構成データがキーと値のペアとして格納されます。 キーと値のペアは、さまざまな種類のアプリケーション設定を表現する手段として、シンプルでありながら柔軟性が高く、開発者にも馴染みのある方法です。

## <a name="keys"></a>構成する

キーは、キーと値のペアの名前としての役割を果たし、対応する値を格納したり取得したりする際に使用されます。 区切り記号 (`/` や `:` など) を使用して、階層型名前空間にキーを整理するのが一般的です。 実際のアプリケーションに最も適した規則を使用してください。 App Configuration は、キーを 1 つのまとまりとして扱います。 キーを解析してその名前がどのような構造になっているのかを推測したり、名前に対して規則を適用したりすることはありません。

キーと値に対する具体的な名前付けスキームは、アプリケーション フレームワークにおける構成データの使われ方で決まる場合があります。 たとえば Java の Spring Cloud フレームワークでは、Spring アプリケーションに設定を提供する `Environment` リソースが、 *<アプリケーション名>* と *<プロファイル>* を含む変数によってパラメーター化されるように定義しています。 通常、Spring Cloud に関連した構成データのキーは、区切り記号でつながれた、この 2 つの要素で始まります。

App Configuration に格納されるキーは Unicode ベースの文字列で、大文字と小文字が区別されます。 *app1* と *App1* というキーはアプリ構成ストアでは区別されます。 アプリケーション内で構成設定を使用する際は、この点に留意してください。一部のフレームワークでは、構成キーの大文字と小文字が区別されないためです。 たとえば、ASP.NET Core の構成システムでは、大文字と小文字の区別がない文字列としてキーが扱われます。 ASP.NET Core アプリケーション内から App Configuration を照会する際の予期しない動作を回避するために、大文字と小文字の違いしかないようなキーは使用しないでください。

App Configuration に入力するキー名には、任意の Unicode 文字を使用できますが、`*`、`,`、`\` は例外です。 これらの文字は予約されています。 予約文字を含める必要がある場合は、`\{Reserved Character}` を使用してエスケープする必要があります。 キーと値のペアにはサイズの上限があり、全部合わせて 10,000 文字までとなります。 この上限には、キーに使用されているすべての文字とその値、そして関連するすべてのオプション属性が含まれます。 キーには、この制限の範囲内で、いくつでも階層レベルを設けることができます。

### <a name="design-key-namespaces"></a>キーの名前空間の設計

一般に、構成データに使用するキーには、フラット型と階層型の 2 とおりの命名方法があります。 アプリケーションの使用上の観点から言えばどちらの方法も似ていますが、階層型の命名方法には、次のような各種利点があります。

* 読みやすい。 1 つの長く連続した文字とは違って、階層型のキー名では、区切り記号が文中のスペースの働きをします。 また、単語間の区切りも自然です。
* 管理しやすい。 キー名の階層は、構成データの論理上のグループを表現します。
* 使いやすい。 階層構造からキーをパターンマッチングして構成データの一部だけを取得するようなクエリが書きやすくなります。 さらに、多くの比較的新しいプログラミング フレームワークは、アプリケーションから特定の構成設定を利用できるよう、階層型の構成データをネイティブでサポートしています。

App Configuration では、さまざまな方法でキーを階層に分けて整理することができます。 そうしたキーは [URI](https://en.wikipedia.org/wiki/Uniform_Resource_Identifier) と考えてください。 それぞれの階層キーはリソースの "*パス*" です。これは 1 つのコンポーネントか、または区切り記号で結合された複数のコンポーネントで構成されます。 区切り記号として使用する文字は、実際のアプリケーション、プログラミング言語、またはフレームワークの要件に基づいて選択します。 App Configuration では、キーごとに異なる区切り記号を使用することができます。

次に、キー名を階層構造に分ける方法の例をいくつか示します。

* コンポーネント サービスに基づく

        AppName:Service1:ApiEndpoint
        AppName:Service2:ApiEndpoint

* デプロイ リージョンに基づく

        AppName:Region1:DbEndpoint
        AppName:Region2:DbEndpoint

### <a name="label-keys"></a>ラベルのキー

App Configuration のキー値には、必要に応じてラベル属性を割り当てることができます。 ラベルは、同じキーを持つ複数のキー値を区別する目的で使用されます。 ラベル *A* とラベル *B* を持つキー *app1* は、アプリ構成ストア内で 2 つの独立したキーになります。 既定では、キー値のラベルは空 (`null`) です。

ラベルは、キーのバリアントを作成するための便利な手段です。 ラベルは一般に、同じキーに対して複数の環境を指定する場合に使用します。

    Key = AppName:DbEndpoint & Label = Test
    Key = AppName:DbEndpoint & Label = Staging
    Key = AppName:DbEndpoint & Label = Production

### <a name="version-key-values"></a>キー値のバージョン管理

キー値が変更されても App Configuration で自動的にバージョン管理されることはありません。 ラベルは、同じキー値の複数のバージョンを手動で作成する手段として使用します。 たとえば、アプリケーションのバージョン番号や Git のコミット ID をラベルとして入力すれば、特定のソフトウェア ビルドに関連付けられているキー値を識別することが可能です。

ラベルには任意の Unicode 文字を使用できますが、`*`、`,`、`\` は例外です。 これらの文字は予約されています。 予約文字を含めるには、`\{Reserved Character}` を使用してエスケープする必要があります。

### <a name="query-key-values"></a>キー値の照会

それぞれのキー値は、対応するキーとラベル (`null` の場合もあり) によって一意に識別されます。 キー値は、パターンを指定してアプリ構成ストアに照会します。 アプリ構成ストアからは、そのパターンに一致するすべてのキー値に加え、それに対応する値と属性が返されます。 App Configuration に対する REST API 呼び出しには、次のキー パターンを使用します。

| キー | |
|---|---|
| `key` を省略 (または `key=*`) | すべてのキーに一致します |
| `key=abc` | 厳密に **abc** であるキー名に一致します |
| `key=abc*` | **abc** で始まるキー名に一致します |
| `key=*abc` | **abc** で終わるキー名に一致します |
| `key=*abc*` | **abc** を含むキー名に一致します |
| `key=abc,xyz` | キー名 **abc** または **xyz** に一致します (CSV の上限は 5 つ) |

また、次のラベル パターンを含めることもできます。

| Label | |
|---|---|
| `label` を省略 (または `label=*`) | 任意のラベル (`null` を含む) に一致します |
| `label=%00` | `null` ラベルに一致します |
| `label=1.0.0` | 厳密に **1.0.0** であるラベルに一致します |
| `label=1.0.*` | **1.0.** で始まるラベルに一致します |
| `label=*.0.0` | **.0.0** で終わるラベルに一致します |
| `label=*.0.*` | **.0.** を含むラベルに一致します |
| `label=%00,1.0.0` | ラベル `null` または **1.0.0** に一致します (CSV の上限は 5 つ) |

## <a name="values"></a>値

キーに割り当てられる値も Unicode 文字列です。 値には、すべての Unicode 文字を使用できます。 それぞれの値には、ユーザー定義のコンテンツ タイプ (省略可) が関連付けられます。 この属性を使用して値に関する情報 (エンコード スキームなど) を格納し、アプリケーションでその値を適切に処理するために役立てることができます。

アプリ構成ストアに格納される構成データ (すべてのキーと値を含む) は、保存時であれ転送中であれ暗号化されます。 App Configuration は、Azure Key Vault に取って代わるソリューションではありません。 アプリケーション シークレットを格納することは避けてください。

## <a name="next-steps"></a>次の手順

* [ポイントインタイム スナップショット](./concept-point-time-snapshot.md)  
* [機能の管理](./concept-feature-management.md)  

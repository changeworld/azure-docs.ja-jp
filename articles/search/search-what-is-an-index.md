<properties
	pageTitle="Azure Search のインデックス | Microsoft Azure | ホステッド クラウド検索サービス"
	description="Azure Search のインデックスとその使用方法について"
	services="search"
	documentationCenter=""
	authors="HeidiSteen"
	manager="mblythe"
	editor=""
    tags="azure-portal"/>

<tags
	ms.service="search"
	ms.devlang="na"
	ms.workload="search"
	ms.topic="get-started-article"
	ms.tgt_pltfrm="na"
	ms.date="11/09/2015"
	ms.author="heidist"/>

# Azure Search のインデックス
> [AZURE.SELECTOR]
- [Overview](search-what-is-an-index.md)
- [Portal](search-create-index-portal.md)
- [.NET](search-create-index-dotnet.md)
- [REST](search-create-index-rest-api.md)

ホステッド クラウド検索サービスである Azure Search は、検索エンジンはもちろんのこと、Bing や Google のような操作をカスタム アプリケーションで実現できる各種検索機能、Azure Search を Web アプリケーションやデスクトップ アプリケーションと統合するための .NET API と REST API、および検索関連データの*インデックス*形式によるデータ保存を提供します。

##インデックスとは

*インデックス* とは、Azure Search サービスで使用される *ドキュメント* などの構成要素を永続的に保存したものです。ドキュメントは検索可能データの基本単位です。たとえば、小売店には各 SKU のドキュメントがあり、ニュース組織には各記事のドキュメントがあり、ストリーミング組織にはライブラリ内に各ビデオや音楽のドキュメントがあります。これらの概念をなじみのあるデータベースの同等のものに対応させるなら、 *インデックス* は概念的には *テーブル* に似ており、 *ドキュメント* はテーブルにおける *行* とほぼ同じです。

インデックスはフラットなデータセットです。通常は、販売取引、コンテンツ公開、購入アクティビティなどの通常の業務中にコンピューター化されたプロセスによって作成またはキャプチャされるデータのサブセットです。多くの場合、リレーショナル データベースまたは NoSQL データベースに格納されます。他のデータ ソースの行を含むデータセットをインデックスにプルまたはプッシュすると、インデックスはそのドキュメントを取得します。

##いつインデックスを作成するか

アプリケーションで使用できるように検索サービスをプロビジョニングする一環として、インデックスを作成する必要があります。インデックスを検索操作で使用できるようにするタスクは、次の 2 つのパートから成ります。最初に、スキーマを定義し、それを Azure Search にポストします。次に、スキーマに準拠しているユーザー定義のデータセットをインデックスに入力します。

インデックスを定義するスキーマを作成するには、ポータルを使用するか、.NET SDK または REST API を呼び出すコードを記述します (このトピックの冒頭にあるタブを参照してください)。インデックス作成後のデータ取り込みの詳細については、「[Azure Search へのデータのインポート](search-what-is-data-import.md)」を参照してください。

##インデックスの JSON スキーマの仕様

JSON ドキュメントであるインデックスには、フィールドと属性、スコアリング プロファイル、サジェスター、既定のスコアリング プロファイル、および CORS オプションの各セクションがあります。

 ![][1]

JSON データ交換形式で表現された Azure Search インデックスのメイン セクションは次のとおりです。

|セクション|説明|
|--------------|-----------|
|フィールド コレクション|フィールドはドキュメントを定義します。インデックスにプッシュまたはプルするデータセットでは、各フィールドに、スキーマで表されているデータ型およびフィールド長と互換性のある値または null 値を提供する必要があります。フィールドには [属性](#index-attributes): プロパティまたは注釈があります。これらは、フィールドに注釈を書き込んで、そのフィールドを対象にした検索関連の動作を有効にするために使用します。フィールドは検索、取得、並べ替えできるかどうかをすべてのフィールドごとに指定できます。また、フィールド レベルで言語アナライザーのオーバーライドを指定することもできます。
|[Suggesters](https://msdn.microsoft.com/library/azure/mt131377.aspx)|オート コンプリートや先行入力クエリとも呼ばれ、インデックス内にセクションとして定義されます。|
|[スコアリング プロファイル](https://msdn.microsoft.com/library/azure/dn798928.aspx)|検索ヒットのランキングを上げるために使用する条件で、通常よりも多くの特性をプロファイルに設定できます。たとえば、検索語句が製品名と製品の説明に一致する場合、製品名との一致を説明との一致よりもランキングの上位に位置付けることができます。複数のプロファイルを作成できます。|
|既定のスコアリング プロファイル|必要に応じて、スコアリング プロファイルのいずれかを既定値として指定することで、検索ランキング スコアを計算する組み込みロジックをオーバーライドすることができます。|
|CORS のオプション|必要に応じて、クロス オリジン リソース共有を有効にします。ドメイン境界を越えて発行された Web ページで使用されるリソースを要求します。インデックスに対して明示的に有効にしない限り CORS は常にオフです。|

<a name="index-attributes"></a>
##インデックスの属性

属性は個々のフィールドに設定されてフィールドの使用方法を指定します。次の表は指定できる属性です。

|**プロパティ**|説明|
|------------|-----------|
|**Retrievable**|検索結果でフィールドを返すことができるかどうかを設定します。|
|**Filterable**|**$filter** クエリでフィールドを使用できるようにします。|
|**Sortable**|結果セットの並べ替え列としてフィールドを使用できるようにします。|
|**Facetable**|ユーザー自律フィルター処理のファセット ナビゲーション構造でフィールドを使用できるようにします。通常は、複数のドキュメント (たとえば、1 つのブランドやサービス カテゴリに属する複数のドキュメント) をまとめてグループ化するために使用できる、反復する値があるフィールドが、ファセットとして最適です。|
|**キー**|ドキュメント検索に使用される各ドキュメントの一意の ID を提供する文字列です。各インデックスに、1 つのキーが必要です。1 つのフィールドだけをキーにすることができ、そのフィールドを Edm.String に設定する必要があります。|
|**Searchable**|フィールドをフルテキスト検索可能としてマークします。|


##Azure Search でのインデックスの使用方法

インデックスからのデータを使用して、検索結果の一覧、ファセット ナビゲーション構造体、または単一ドキュメントの詳細ページを構築します。Azure Search のインデックスには、フィルター式または検索ランキング スコアの向上に使われるスコアリング プロファイルで内部的に使用される検索できないデータも含まれることがあります。

Azure Search で実行されるデータ関連操作では、常にインデックスからデータを取得して使用したり返したりします。例外はありません。サービスでインデックス以外のデータ ソースを指定し、検索サービスによって発行される応答として外部データを返すことはできません。

当然ながら、オンライン小売りアプリの販売トランザクションのように、アプリケーションがデータを蓄積して操作する場合、Azure Search のインデックスはソリューション全体に対する追加的なデータ ソースになります。検索のためだけに専用のデータ ストレージを置くことは冗長に思われるかもしれませんが、次のような利点がある: リソースやデータの競合がなくなるため、検索結果の一貫性、揮発性の軽減、アプリケーションと Azure Search の間のラウンド トリップ回数の削減、および検索操作の全体的なパフォーマンスの向上が実現されます。

##スキーマ定義のガイダンス

スキーマは、JSON 構造として作成されます。Azure Search と統合するカスタム ソリューションごとにインデックスを 1 つ作成する必要があります。複数のインデックスをリンクしたり結合したりすることはできませんが、ソリューションでさまざまな検索シナリオに対応する際に必要となる複雑なインデックスを作成できます。たとえば、アプリケーションで複数の言語をサポートしている場合、インデックス内のフィールド コレクションでフィールドごとに言語固有のバリアントを設定できます。

インデックスを設計する際は、計画フェーズに時間をかけ、それぞれの決定項目を十分に検討してください。デプロイ後にインデックスを変更するには、再構築とデータの再読み込みが必要になります。コードでインデックスを作成すれば、ポータルで手動で作成する場合よりも、手順がはるかに簡単になります。

適切なスキーマを作成するうえで、元のソース データについて十分に理解することが重要です。データ型を正しく一致させ、インデックス内の各ドキュメントを一意に識別する*キー*として使用するフィールドと、検索結果の一覧または詳細ページに表示させるフィールドを把握する必要があります。

**リレーショナル データの開始**

リレーショナル データはフラット データセットに変換することが困難な場合があります。可能な場合、使用可能な場合は、会社のデータ ウェアハウスまたはレポート データベースの使用を試みます。モデルが既に非正規化されているので通常はその方がよい選択です。それ以外の場合、クエリに依存して必要な行セットを取得する必要があります。これを行う方法の例と説明については、「[Azure Search 用の AdventureWorks 在庫データベースのモデリング](http://blogs.technet.com/b/onsearch/archive/2015/09/08/modeling-the-adventureworks-inventory-database-for-azure-search.aspx)」を参照してください。

**バイナリ データを含む**

イメージ、オーディオ、ビデオ コンテンツが検索結果に含まれる必要がある場合があります。そのときは、リソースへの URL が格納される代理的なフィールドを含むインデックスで、どこかに格納する必要があります。検索できないコンテンツ、特にバイナリ コンテンツは、すべてインデックス以外の安いストレージに格納し、インデックスのフィールド内の URI で参照します。

**データの同期**

ご想像いただけるとおり、インデックスは、ソリューションで使用される他のデータ ソースと定期的に同期する必要があります。オンライン小売カタログであれば、検索結果に表示される情報には、販売トランザクションをキャプチャするインベントリ データベース内にあるのと同じ SKU、価格、在庫状況が使用される必要があります。ソリューションで許容される遅延の程度に応じて、データの同期を 1 日に 1 回や週に 1 回実行できるほか、インベントリ データベースと Azure Search インデックスの両方に対する同時書き込みを使用してほぼリアルタイムで実行することもできます。使用可能なオプションの詳細については、「[Azure Search へのデータのインポート](search-what-is-data-import.md)」を参照してください。

## クラウドのストレージ

Azure Search は、完全に管理されたサービスであるため、データ ストレージは内部操作として処理されます。プログラマは、Azure Search API をバイパスしてインデックスに直接接続することはできないこと、ポータルの通知または API 呼び出し以外の方法ではインデックスのサイズや正常性を監視できないことを理解しておくことが重要です。インデックスのバックアップと復元、ストレージ層のパフォーマンスの最適化や調整を行う機能はありません。内部では、データは BLOB ストレージとして格納されますが、インデックスの物理的なストレージと管理は、後から変更できる実装の詳細として捉えるのが最適な方法です。サービスの主な利点の 1 つは、検索アプリケーションのコンピューティング リソースを物理的に管理するハンズオフ アプローチです。

クエリ ボリュームとデータ ストレージの要件が随時変更される環境でも、レプリカとパーティションを追加または移動することで容量を増減できます。詳細については、「[Microsoft Azure で Search サービスを管理する](search-manage.md)」または「[サービスの制限](search-limits-quotas-capacity.md)」を参照してください。

<!--Image References-->
[1]: ./media/search-what-is-an-index/search-JSON-indexSchema.png

<!-----HONumber=AcomDC_1125_2015-->
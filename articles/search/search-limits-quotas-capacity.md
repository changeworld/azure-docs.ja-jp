---
title: レベルおよび SKU のサービスの制限
titleSuffix: Azure Cognitive Search
description: 容量計画で使用されるサービスの制限と、Azure Cognitive Search の要求および応答の上限について説明します。
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 02/02/2021
ms.openlocfilehash: 994ed74750d159dfdb83259e9fe921f870ec2241
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/19/2021
ms.locfileid: "99509369"
---
# <a name="service-limits-in-azure-cognitive-search"></a>Azure Cognitive Search におけるサービスの制限

インデックスやその他のオブジェクトのストレージ、ワークロード、および数量の上限は、[Azure Cognitive Search](search-create-service-portal.md) を **Free**、**Basic**、**Standard**、**ストレージ最適化** のどの価格レベルでプロビジョニングするかによって異なります。

+ **Free** は、Azure サブスクリプションに付属しているマルチテナント共有サービスです。 

+ **Basic** では、小規模な運用ワークロードに対して専用のコンピューティング リソースが提供されますが、一部のネットワーク インフラストラクチャは他のテナントと共有されます。

+ **Standard** は、すべてのレベルでさらに多くのストレージや処理能力を持つ専用マシン上で実行されます。 Standard には 4 つのレベル(S1、S2、S3、S3 HD) があります。 S3 高密度 (S3 HD) は、[マルチテナント](search-modeling-multitenant-saas-applications.md)と大量の小さなインデックス (サービスあたり 3,000 インデックス) 向けに設計されています。 S3 HD は、[インデクサー](search-indexer-overview.md)機能を提供しません。また、データ インジェストでは、ソースからインデックスにデータをプッシュする API を活用する必要があります。 

+ **ストレージ最適化** は、**Standard** よりも多くの合計ストレージ、ストレージ帯域幅、およびメモリを備えた専用マシンで実行されます。 このレベルでは、大型で、緩やかに変化するインデックスが対象となります。 ストレージ最適化は 2 つのレベルがあります: L1 と L2 です。

## <a name="subscription-limits"></a>サブスクリプションの制限
[!INCLUDE [azure-search-limits-per-subscription](../../includes/azure-search-limits-per-subscription.md)]

## <a name="storage-limits"></a>ストレージの制限
[!INCLUDE [azure-search-limits-per-service](../../includes/azure-search-limits-per-service.md)]

<a name="index-limits"></a>

## <a name="index-limits"></a>インデックスの制限

| リソース | Free | Basic&nbsp;<sup>1</sup>  | S1 | S2 | S3 | S3&nbsp;HD | L1 | L2 |
| -------- | ---- | ------------------- | --- | --- | --- | --- | --- | --- |
| 最大インデックス |3 |5 または 15 |50 |200 |200 |パーティションあたり 1,000、またはサービスあたり 3,000 |10 |10 |
| インデックスあたりの単純型フィールドの最大数 |1000 |100 |1000 |1000 |1000 |1000 |1000 |1000 |
| インデックスあたりの複合コレクション フィールドの最大数 |40 |40 |40 |40 |40 |40 |40 |40 |
| ドキュメントあたりのすべての複合コレクション全体での最大要素数&nbsp;<sup>2</sup> |3000 |3000 |3000 |3000 |3000 |3000 |3000 |3000 |
| 複合フィールドの最大深度 |10 |10 |10 |10 |10 |10 |10 |10 |
| インデックスあたりの最大[サジェスター](/rest/api/searchservice/suggesters) |1 |1 |1 |1 |1 |1 |1 |1 |
| インデックスあたりの最大[スコアリング プロファイル](/rest/api/searchservice/add-scoring-profiles-to-a-search-index) |100 |100 |100 |100 |100 |100 |100 |100 |
| プロファイルあたりの最大関数 |8 |8 |8 |8 |8 |8 |8 |8 |

<sup>1</sup> 2017 年 12 月より前に作成された Basic サービスは、インデックスでの制限が低くなっています (15 ではなく 5)。 Basic レベルにのみ下限 (インデックスあたり 100 フィールド) があります。

<sup>2</sup> 多数の要素があると、インデックスに必要なストレージは大幅に増えるため、要素には上限があります。 複合コレクションの要素は、そのコレクションのメンバーとして定義されます。 たとえば、[部屋の複合コレクションが記載されているホテル ドキュメント](search-howto-complex-data-types.md#indexing-complex-types)があるとします。部屋コレクション内の各部屋は、1 つの要素として見なされます。 インデックス作成時は、インデックス作成エンジンによって、ドキュメント全体で最大 3,000 の要素が安全に処理されます。 [この制限](search-api-migration.md#upgrade-to-2019-05-06)は `api-version=2019-05-06` で導入され、文字列コレクションや複合フィールドではなく、複合コレクションにのみ適用されます。

<a name="document-limits"></a>

## <a name="document-limits"></a>ドキュメントの制限 

2018 年 10 月現在、いずれのリージョンにおいても、課金対象レベル (Basic、S1、S2、S3、S3 HD) で作成された新しいサービスに関して、ドキュメント数の制限はありません。 2018 年 10 月より前に作成された古いサービスでは、ドキュメント数の制限がまだ適用される場合があります。

使用しているサービスにドキュメントの制限があるかどうかを判定するには、[GET サービス統計情報 REST API](/rest/api/searchservice/get-service-statistics) を使用します。 ドキュメントの制限が応答に反映され、`null` は制限がないことを示します。

> [!NOTE]
> このサービスによって課されるドキュメントの制限はありませんが、Basic、S1、S2、S3 の検索サービスでは、インデックスあたり約 240 億ドキュメントのシャード制限があります。 S3 HD の場合、シャード制限は、インデックスあたり 20 億ドキュメントです。 シャード制限に関しては、複合コレクションの各要素は個別のドキュメントとしてカウントされます。

### <a name="document-size-limits-per-api-call"></a>API 呼び出しごとのドキュメント サイズの制限

インデックス API を呼び出すときのドキュメント サイズの上限は約 16 メガバイトです。

ドキュメント サイズとは、実際にはインデックス API の要求本文のサイズに対する制限を意味します。 複数のドキュメントのバッチを一度にインデックス API に渡すことができるため、このサイズの制限は、現実的には、バッチ内のドキュメント数に左右されます。 バッチ内のドキュメントが 1 つの場合、最大ドキュメント サイズは JSON 形式で 16 MB です。

ドキュメント サイズを推定する場合は、検索サービスで使用できるフィールドのみを考慮してください。 ソース ドキュメント内のバイナリ データまたはイメージ データはすべて、計算から除外する必要があります。  

## <a name="indexer-limits"></a>インデクサー制限

サービスに全体としてのバランスと安定性を提供するために、最大実行時間が設けられていますが、より大規模なデータ セットでは、許可されている最大値よりも長いインデックス作成時間が必要になることがあります。 インデックス作成ジョブが最大許容時間内で完了できない場合は、スケジュールで実行してください。 スケジューラはインデックスの状態を追跡します。 スケジュールされたインデックス作成ジョブが何らかの理由で中断された場合、インデクサーは、次のスケジュールされた実行時に最後の終了状態を選択できます。


| リソース | Free&nbsp;<sup>1</sup> | Basic&nbsp;<sup>2</sup>| S1 | S2 | S3 | S3&nbsp;HD&nbsp;<sup>3</sup>|L1 |L2 |
| -------- | ----------------- | ----------------- | --- | --- | --- | --- | --- | --- |
| 最大インデクサー |3 |5 または 15|50 |200 |200 |該当なし |10 |10 |
| 最大データソース |3 |5 または 15 |50 |200 |200 |該当なし |10 |10 |
| 最大スキルセット <sup>4</sup> |3 |5 または 15 |50 |200 |200 |該当なし |10 |10 |
| 呼び出しあたりの最大インデックス作成負荷 |10,000 ドキュメント |最大ドキュメントによってのみ制限 |最大ドキュメントによってのみ制限 |最大ドキュメントによってのみ制限 |最大ドキュメントによってのみ制限 |該当なし |制限なし |制限なし |
| 最小限のスケジュール | 5 分 |5 分 |5 分 |5 分 |5 分 |5 分 |5 分 | 5 分 |
| 最大実行時間| 1 ～ 3 分 |24 時間 |24 時間 |24 時間 |24 時間 |該当なし  |24 時間 |24 時間 |
| スキルセット <sup>5</sup> のインデクサー最大実行時間 | 3 から 10 分 |2 時間 |2 時間 |2 時間 |2 時間 |該当なし  |2 時間 |2 時間 |
| BLOB インデクサー: BLOB の最大サイズ、MB |16 |16 |128 |256 |256 |該当なし  |256 |256 |
| BLOB インデクサー: BLOB から抽出されたコンテンツの最大文字数 |32,000 |64,000 |400万&nbsp; |&nbsp;800万 |&nbsp;1,600万 |該当なし |400万&nbsp; |400万&nbsp; |

<sup>1</sup> Free サービスのインデクサーの最大実行時間は、BLOB ソースの場合は 3 分、その他のすべてのデータ ソースの場合は 1 分です。 Cognitive Services に呼び出しを行う AI インデックスについては、トランザクションが強化パイプラインを正常に通過するドキュメントとして定義された場合、無料のサービスは 1 日あたり 20 個の無料トランザクションに制限されます。

<sup>2</sup> 2017 年 12 月より前に作成された Basic サービスは、インデクサー、データ ソース、およびスキルセットでの制限が低くなっています (15 ではなく 5)。

<sup>3</sup> S3 HD サービスには、インデクサー サポートが含まれません。

<sup>4</sup> スキルセットあたり最大 30 スキル。

<sup>5</sup> AI エンリッチメントと画像分析は、コンピューティングを集中的に使用し、使用可能な処理能力を大量に消費します。 キュー内の他のジョブにも、より多くの実行の機会が与えられるように、これらのワークロードの実行時間は短縮されました。

> [!NOTE]
> 「[インデックスの制限](#index-limits)」で説明したように、複合型をサポートする最新の GA API バージョン (`2019-05-06`) 以降では、ドキュメントごとのすべての複合コレクションに対する 3,000 要素の上限も、インデクサーによって適用されます。 つまり、以前のバージョンの API を使用してインデクサーを作成した場合、この制限の対象にはなりません。 最大の互換性を維持するために、以前のバージョンの API で作成され、API バージョン `2019-05-06` 以降で更新されたインデクサーは、引き続き制限から **除外** されます。 前述のように、非常に大きな複合コレクションがあると、悪影響が生じることに注意する必要があります。最新の GA API バージョンを使用して、新しいインデクサーを作成することを強くお勧めします。

## <a name="shared-private-link-resource-limits"></a>共有プライベート リンク リソースの制限

インデクサーでは、[共有プライベート リンク リソース API](/rest/api/searchmanagement/sharedprivatelinkresources) を使用して管理されている[プライベート エンドポイント経由](search-indexer-howto-access-private.md)で他の Azure リソースにアクセスできます。 このセクションでは、この機能に関連する制限について説明します。

| リソース | Free | Basic | S1 | S2 | S3 | S3 HD | L1 | L2
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| プライベート エンドポイント インデクサーのサポート | いいえ | はい | はい | はい | はい | いいえ | はい | はい |
| スキルセットがあるインデクサーのプライベート エンドポイントのサポート<sup>1</sup> | いいえ | いいえ | いいえ | はい | はい | いいえ | はい | はい |
| 最大プライベート エンドポイント | N/A | 10 または 30 | 100 | 400 | 400 | N/A | 20 | 20 |
| 個別のリソースの種類の最大数<sup>2</sup> | 該当なし | 4 | 7 | 15 | 15 | 該当なし | 4 | 4 |

<sup>1</sup> AI エンリッチメントと画像分析は、コンピューティングを集中的に使用し、使用可能な処理能力を大量に消費します。 このため、検索サービス自体のパフォーマンスと安定性に悪影響を及ぼさないように、下位層でプライベート接続は無効になっています。

<sup>2</sup> 個別のリソースの種類の数は、リソースの状態に関係なく、特定の検索サービスのすべての共有プライベート リンク リソースで使用される一意の `groupId` 値の数として計算されます。

## <a name="synonym-limits"></a>シノニムの制限

シノニム マップの最大数は、レベルによって異なります。 各規則には最大 20 の拡張を含めることができます。ここで、拡張は同義語です。 たとえば、"cat" の場合、"kitty"、"feline"、および "felis" (ネコ属) との関連は、3 つの拡張としてカウントされます。

| リソース | Free | Basic | S1 | S2 | S3 | S3-HD |L1 | L2 |
| -------- | -----|------ |----|----|----|-------|---|----|
| シノニムマップの最大数 |3 |3|5 |10 |20 |20 | 10 | 10 |
| マップごとの規則の最大数 |5000 |20000|20000 |20000 |20000 |20000 | 20000 | 20000  |

## <a name="data-limits-ai-enrichment"></a>データの制限 (AI エンリッチメント)

[エンティティ認識](cognitive-search-skill-entity-recognition.md)、[キー フレーズ抽出](cognitive-search-skill-keyphrases.md)、[センチメント分析](cognitive-search-skill-sentiment.md)、[言語検出](cognitive-search-skill-language-detection.md)、および[個人情報検出](cognitive-search-skill-pii-detection.md)の Text Analytics リソースに対して呼び出しを行う [AI エンリッチメント パイプライン](cognitive-search-concept-intro.md)は、データの制限を受ける可能性があります。 レコードのサイズは、[`String.Length`](/dotnet/api/system.string.length) で測定して 50,000 文字以下にする必要があります。 データをセンチメント アナライザーに送信する前に分割する必要がある場合は、[テキスト分割スキル](cognitive-search-skill-textsplit.md)を使用します。

## <a name="throttling-limits"></a>スロットルの制限

システムがピーク時の容量に近づくにつれて、API 要求が調整されます。 スロットルの動作は API によって異なります。 クエリ API (検索/提案/オートコンプリート) とインデックス作成 API は、サービスの負荷に基づいて動的に調整されます。 インデックス API とサービス操作 API には、静的な要求レート制限があります。 

インデックスに関連する操作の静的なレート要求の制限:

+ インデックスの一覧取得 (GET /indexes):1 秒あたり 3 件 (検索単位あたり)
+ インデックスの取得 (GET /indexes/myindex):1 秒あたり 10 件 (検索単位あたり)
+ インデックスの作成 (POST /indexes):1 分あたり 12 件 (検索単位あたり)
+ インデックスの作成または更新 (PUT /indexes/myindex):1 秒あたり 6 件 (検索単位あたり)
+ インデックスの削除 (DELETE /indexes/myindex):1 分あたり 12 件 (検索単位あたり) 

サービスに関連する操作の静的なレート要求の制限:

+ サービス統計情報 (GET /servicestats):1 秒あたり 4 件 (検索単位あたり)

## <a name="api-request-limits"></a>API 要求の制限
* 要求あたりの最大値: 16 MB<sup>1</sup>
* URL の最大長: 8 KB
* インデックスののアップロード、マージ、または削除のバッチあたりの最大ドキュメント数: 1,000
* $orderby 句の最大フィールド数: 32
* 検索用語の最大サイズ: UTF-8 でエンコードされたテキストの 32,766 バイト (32 KB - 2 バイト)

<sup>1</sup> Azure Cognitive Search では、要求の本文は上限 16 MB に左右され、それ以外では理論的制限によって制約されない個々のフィールドまたはコレクションのコンテンツに実際的な制限が課せられます (フィールドの構成と制約の詳細については、[サポートされているデータ型](/rest/api/searchservice/supported-data-types)に関するページをご覧ください)。

## <a name="api-response-limits"></a>API 応答の制限
* 検索結果のページごとに返される最大ドキュメント数: 1,000
* 検索候補 API 要求ごとに返される最大検索候補数: 100

## <a name="api-key-limits"></a>API キーの制限
API キーは、サービスの認証に使用されます。 次の 2 つの種類があります。 管理者キーは、要求ヘッダーで指定され、サービスに完全な読み取り/書き込みアクセス権を付与します。 クエリ キーは、読み取り専用で、URL で指定され、通常はクライアント アプリケーションに配布されます。

* サービスあたりの最大管理キー数: 2
* サービスあたりの最大クエリ キー数: 50

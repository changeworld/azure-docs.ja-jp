---
title: Azure Front Door - Azure のアプリケーション配信スイートでの負荷分散 | Microsoft Docs
description: この記事は、Azure で勧められているアプリケーション配信スイートでの負荷分散の方法を学習するのに役立ちます。
services: frontdoor
documentationcenter: ''
author: duongau
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/28/2020
ms.author: duau
ms.openlocfilehash: 50e047325ad17710794b1640715ab1938373fe85
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/19/2021
ms.locfileid: "96019465"
---
# <a name="load-balancing-with-azures-application-delivery-suite"></a>Azure のアプリケーション配信スイートでの負荷分散

## <a name="introduction"></a>はじめに
Microsoft Azure では、ネットワーク トラフィックの分散や負荷分散の方法を管理するための多数のグローバル サービスおよびリージョン サービスを利用できます。 

* Application Gateway
* Front Door 
* Load Balancer  
* Traffic Manager

Azure の多くのリージョンとゾーン アーキテクチャと共に、これらのサービスを一緒に使用することで、堅牢でスケーラブルな高パフォーマンスのアプリケーションをビルドすることができます。

:::image type="content" source="./media/front-door-lb-with-azure-app-delivery-suite/application-delivery-figure1.png" alt-text="アプリケーション配信スイート":::
 
これらのサービスは、次の 2 つのカテゴリに分類されます。
1. **グローバル負荷分散サービス** (Traffic Manager や Front Door など)。リージョン バックエンド全体、クラウド全体、さらにはハイブリッド オンプレミス サービス全体に、エンド ユーザーからのトラフィックを分散します。 グローバル負荷分散では最も近いサービス バックエンドにトラフィックをルーティングし、サービスの信頼性に対応し、ユーザーに対して Always On 可用性とハイ パフォーマンスが維持されます。 
1. **リージョン負荷分散サービス** (Load Balancer や Application Gateway など)。仮想ネットワーク (VNET) 内の仮想マシン (VM) またはリージョン内のサービス エンドポイントのトラフィックを分散できます。

これらのグローバルとリージョンの各サービスを組み合わせると、アプリケーションは、エンドユーザーから IaaS、PaaS、またはオンプレミスのサービスに送信される信頼性の高い、セキュリティで保護されたエンドツーエンドのトラフィックの恩恵を受けることができます。 次のセクションでは、これらの各サービスについて説明します。

## <a name="global-load-balancing"></a>グローバル負荷分散
**Traffic Manager** には、グローバルな DNS グローバル負荷分散機能が備わっています。 受信 DNS 要求を調べ、ユーザーが選択したルーティング ポリシーに従って、正常なバックエンドを使用して応答します。 ルーティング方法のオプションは次のとおりです。
- ** パフォーマンス ルーティングは、待機時間が最も少ないバックエンドに要求を送信します。
- **優先順位によるルーティング** では、すべてのトラフィックを 1 つのバックエンドに送信し、その他のバックエンドはバックアップとします。
- **重み付けラウンド ロビンによるルーティング** では、各バックエンドに割り当てた重み付けに基づいてトラフィックを分散します。
- **地理的ルーティング** では、特定の地理的リージョンをソースとする要求が、それらのリージョンにマップされたバックエンドによって処理されるようになります。 (たとえば、スペインからのすべての要求は、フランス中部の Azure リージョンに転送されます)
- **サブネット ルーティング** を使用すると、IP アドレス範囲をバックエンドにマップすることで、それらの IP に対する受信要求が特定のバックエンドに送信されるようにすることができます。 (たとえば、会社の本社の IP アドレス範囲から接続するすべてのユーザーは、一般的なユーザーとは異なる Web コンテンツを取得します)

クライアントはそのバックエンドに直接接続されます。 Azure Traffic Manager で、バックエンドが正常でないことが検出されると、クライアントが別の正常なインスタンスにリダイレクトされます。 サービスの詳細については、[Azure Traffic Manager](../traffic-manager/traffic-manager-overview.md) に関するドキュメントを参照してください。

**Azure Front Door** では、グローバル HTTP 負荷分散を含む動的 Web サイトの高速化 (DSA) が提供されます。  特定のホスト名、URL パス、構成されたルールについて、最も近いサービス バックエンドやリージョンへの受信 HTTP 要求ルートを調べます。  
Front Door では、Microsoft のネットワークのエッジで HTTP 要求を終了し、アクティブに調べ、アプリケーションまたはインフラストラクチャの正常性や待機時間の変化を検出します。  その後、Front Door では常に、最も高速で利用可能な (正常な) バックエンドにトラフィックをルーティングします。 サービスの詳細については、Front Door の[ルーティング アーキテクチャ](front-door-routing-architecture.md)の詳細と[トラフィックのルーティング方法](front-door-routing-methods.md)に関するページを参照してください。

## <a name="regional-load-balancing"></a>リージョン負荷分散
Application Gateway では、アプリケーション配信コントローラー (ADC) をサービスとして提供することで、さまざまなレイヤー 7 負荷分散機能をアプリケーションで利用できるようにします。 これにより、顧客は CPU 集中型の TLS 終端を Application Gateway にオフロードすることによって Web ファームの生産性を最適化できます。 着信トラフィックのラウンド ロビン分散、Cookie ベースのセッション アフィニティ、URL パス ベースのルーティング、単一の Application Gateway の背後で複数の Web サイトをホストする機能など、その他の追加のレイヤー 7 ルーティング機能も用意されています。 Application Gateway は、インターネット接続エンドポイント、内部専用エンドポイント、またはこの両方の組み合わせとして構成できます。 Application Gateway は完全に Azure で管理されており、スケーラビリティと高可用性を提供します。 管理しやすいように診断機能とログ機能が豊富に用意されています。

Load Balancer は、Azure SDN スタックの重要な構成要素であり、すべての UDP と TCP プロトコル向けの高パフォーマンス、低待機時間のレイヤー 4 負荷分散サービスを備えています。 受信接続をバックエンド プールにマップする規則を定義することによって、パブリックまたは内部の負荷分散エンドポイントを構成できます。 TCP または HTTPS を使用した正常性プローブの監視により、サービスの可用性の管理に役立ちます。

## <a name="choosing-a-global-load-balancer"></a>グローバル ロード バランサーの選択
グローバルなルーティングのために Traffic Manager と Azure Front Door の間でグローバル ロード バランサーを選択する場合は、2 つのサービスの類似点と相違点を考慮する必要があります。   両方のサービスで以下が提供されます。
- **複数の地理的冗長性:** 1 つのリージョンのサービスが停止した場合は、最も近いリージョンにトラフィックがシームレスにルーティングされます。アプリケーション所有者による操作は必要ありません。
- **最も近いリージョンへのルーティング:** トラフィックは自動的に最も近いリージョンにルーティングされます。

</br>次の表で、Traffic Manager と Azure Front Door との違いについて説明します。</br>

| Traffic Manager | Azure Front Door |
| --------------- | ------------------------ |
|**あらゆるプロトコル:** Traffic Manager は DNS レイヤーで動作するため、HTTP、TCP、UDP など、あらゆる種類のネットワーク トラフィックをルーティングすることができます。 | **HTTP の高速化:** Front Door では、Microsoft のネットワークのエッジでトラフィックがプロキシ処理されます。 HTTP/S 要求では、待機時間とスループットが向上し、TLS ネゴシエーションの待機時間が短縮されます。|
|**オンプレミス ルーティング:** DNS レイヤーでのルーティングにより、トラフィックは常にポイント間で送信されるようになります。  ブランチ オフィスからオンプレミス データセンターへのルーティングでは、直接パスを使用できます。Traffic Manager を使用する独自のネットワークでも同様です。 | **独立したスケーラビリティ:** Front Door で HTTP 要求が処理されるため、ルールと各アプリケーションのマイクロサービスの正常性に基づいて、さまざまな URL パスへの要求をさまざまなバックエンドやリージョン サービス プール (マイクロサービス) にルーティングすることができます。|
|**課金形式:** DNS ベースの課金ではユーザーに合わせてスケーリングが行われ、より多くのユーザーが使用するサービスでは、使用率上昇時の安定したコスト削減が実現します。 |**インライン セキュリティ:** Front Door ではレート制限や IP ACL 設定などのルールを有効にすることで、トラフィックがアプリケーションに到達する前にバックエンドを保護することができます。 

</br>HTTP が Front Door と連動することのパフォーマンス、運用およびセキュリティ上の利点が得られるため、HTTP ワークロードでは Front Door を使用することをお勧めします。 Traffic Manager と Front Door を並行して使用することで、アプリケーションのすべてのトラフィックを処理できます。 

## <a name="building-with-azures-application-delivery-suite"></a>Azure のアプリケーション配信スイートでの構築 
すべての Web サイト、API、サービスに地理的な冗長性を持たせることで、そのユーザーへのトラフィックを、できる限り最も近い場所から配信することをお勧めします。  複数の負荷分散サービスを組み合わせることで、地理的およびゾーンの冗長性を構築し、信頼性とパフォーマンスを最大限に高めることができます。

次の図では、これらすべてのサービスの組み合わせを使用してグローバル Web サービスを構築するアーキテクチャの例について説明します。 設計者は Traffic Manager を使用して、ファイルとオブジェクトの配信のためにトラフィックをグローバル バックエンドにルーティングしていました。 Front Door を使用して、パターン /store/* に一致する URL パスを、App Service に移行したサービスにグローバルにルーティングします。 最後に、他のすべての要求をリージョンの Application Gateway にルーティングします。

IaaS サービスの各リージョンで、アプリケーション開発者は、/images/* のパターンに一致する URL に VM の専用プールからサービスが提供されることを決定ます。 この VM のプールは、Web ファームの他の部分とは異なります。

さらに、動的コンテンツを提供する既定の VM プールは、高可用性クラスターでホストされているバックエンドのデータベースと通信する必要があります。 すべてのデプロイメントは Azure Resource Manager を通じて構成されます。

次の図は、このシナリオのアーキテクチャを示します。

:::image type="content" source="./media/front-door-lb-with-azure-app-delivery-suite/application-delivery-figure2.png" alt-text="アプリケーション配信スイートの詳細なアーキテクチャ":::

> [!NOTE]
> この例は、Azure が提供する多数の負荷分散サービスの 1 つの例に過ぎません。 Traffic Manager、Front Door、Application Gateway、Load Balancer は、負荷分散のニーズに合わせて組み合わせて使用できます。 たとえば、TLS/SSL オフロードやレイヤー 7 の処理が必要ない場合は、Application Gateway の代わりに Load Balancer を使用できます。

## <a name="next-steps"></a>次の手順

- [フロント ドアの作成](quickstart-create-front-door.md)方法について学習します。
- [Front Door のしくみ](front-door-routing-architecture.md)について学習します。

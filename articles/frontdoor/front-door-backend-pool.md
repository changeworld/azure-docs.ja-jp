---
title: Azure Front Door Service - バック エンドとバックエンド プール | Microsoft Docs
description: この記事は、Front Door 構成におけるバックエンドおよびバックエンド プールを理解するのに役立ちます。
services: front-door
documentationcenter: ''
author: sharad4u
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/10/2018
ms.author: sharadag
ms.openlocfilehash: 64d96d54b323d634703301e48cdaa28fa875fbbc
ms.sourcegitcommit: 32d218f5bd74f1cd106f4248115985df631d0a8c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2018
ms.locfileid: "46958800"
---
# <a name="backends-and-backend-pools-in-azure-front-door-service"></a>Azure Front Door Service の バック エンドとバックエンド プール
この記事では、アプリケーションのデプロイを Front Door にマップする方法に関するさまざまな概念について説明します。 また、アプリケーション バックエンドに関する Front Door 構成のさまざまな用語の意味を説明します。

## <a name="backend-pool"></a>バックエンド プール
Front Door のバックエンド プールとは、そのアプリケーションに関して同じ種類のトラフィックを受信できる同等のバックエンドのセットのことです。 つまり、これは同じトラフィックを受信して、想定される動作で応答することが可能な、世界中にあるアプリケーション インスタンスの論理グループになります。 これらのバックエンドは、通常はさまざまなリージョンにまたがっているか、または同じリージョン内に配置されます。 さらに、これらのバックエンドはすべてアクティブ/アクティブ デプロイ モードで指定できます。それ以外の場合は、アクティブ/パッシブ構成として定義されている可能性があります。

バックエンド プールは、正常性プローブを使用して、異なるバックエンドすべての正常性をどのように評価するか、またそれに応じてバックエンド間の負荷分散がどのように生じるべきかも定義します。

### <a name="health-probes"></a>正常性プローブ
Front Door では、構成したバックエンドそれぞれに HTTP または HTTPS プローブ要求を定期的に送信して、エンドユーザーの要求の負荷を分散するために、各バックエンドの近接性と正常性を判別します。 バックエンド プールの正常性プローブの設定では、アプリケーションのバックエンドの正常性状態をポーリングする方法を定義します。 次の設定は、負荷分散の構成で使用できます:

1. **パス**: バックエンド プール内のすべてのバックエンドに対するプローブ要求の送信先の URL パス。 たとえば、バックエンドの 1 つが `contoso-westus.azurewebsites.net` であり、パスが `/probe/test.aspx` に設定されている場合、Front Door 環境では、プロトコルが HTTP に設定されていると仮定して、正常性プローブ要求を http://contoso-westus.azurewebsites.net/probe/test.aspx に送信します。 
2. **プロトコル**: Front Door からバックエンドへの正常性プローブ要求を HTTP または HTTPS プロトコルのどちらを経由して送信するかを定義します。
3. **間隔 (秒)**: このフィールドは、バックエンドに対する正常性プローブの頻度、つまり各 Front Door 環境がプローブを送信する間隔を定義します。 注 - 高速フェールオーバーを求めている場合は、このフィールドを小さな値に設定してください。 ただし、値が小さくなると、バックエンドが受信する正常性プローブの量が多くなります。 バックエンドで Front Door により生成されるプローブの量に関してヒントを得るために、以下の例を参照してください。 たとえば、間隔が 30 秒に設定されおり、約 90 の Front Door 環境または POP が世界中に存在しているとします。 そして、各バックエンドは 1 秒あたり約 3 から 5 のプローブ要求を受信します。

詳細については、「[正常性プローブ](front-door-health-probes.md)」を参照してください。

### <a name="load-balancing-settings"></a>負荷分散の設定
バックエンド プールの負荷分散の設定では、バックエンドが正常または異常のどちらであるかを決定するために正常性プローブを評価する方法と、バックエンド プール内の異なるバックエンド間でトラフィックの負荷を分散する方法を定義します。 次の設定は、負荷分散の構成で使用できます:

1. **サンプル サイズ**: このプロパティは、バックエンド正常性評価を検討するために必要な正常性プローブのサンプル数を特定します。
2. **Successful sample size (成功サンプル サイズ)**: このプロパティは、前述の[サンプル サイズ]のように、正常としてバックエンドを呼び出すために成功とチェックする必要があるサンプル数を定義します。 
</br>たとえば、正常性状況の [*間隔*] が 30 秒、[*サンプル サイズ*] が '5' および[*Successful sample size (成功サンプル サイズ)*] が '3' に設定されているとします。 次に、この構成はバックエンドの正常性プローブを評価するたびに、最新の 5 つのサンプルが表示されることを意味します。これは直近 150 秒 (=5*30 s) 間継続し、これらのプローブが 3 つ以上成功がない場合は、バックエンドが異常だと宣言します。 たとえば、成功したプローブが 2 つしか存在しないと、異常であるとしてバックエンドにマークします。 次回評価を実行したときに、最新の 5 つのプローブで 3 つ成功したことが判明した場合、そのバックエンドは正常として再度マークします。
3. **Latency sensitivity (additional latency) (待機時間の感度 (追加の待機時間))**: [latency sensitivity (待機時間の感度)] フィールドでは、待ち時間測定に関して、Front Door で感度範囲内にあるバックエンドに要求を送信するか、または要求を最も近いバックエンドに送信するかを定義します。 詳細については、「[least latency based routing method (最小限の待機時間ベースのルーティング方法)](front-door-routing-methods.md#latency)」を参照してください。

## <a name="backend"></a>バックエンド
バックエンドは、リージョン内のアプリケーションのデプロイメントのインスタンスに相当します。 Front Door は、Azure と Azure 以外のバックエンドの両方をサポートします。そのためバックエンドは Azure リージョンにのみ限定されず、オンプレミス データ センターや他のクラウド内のアプリケーション インスタンスにすることもできます。

バックエンドは、Front Door のコンテキストでは、アプリケーションのホスト名やパブリック IP を指します。そのためクライアントの要求を処理することができます。 バックエンドは、データベース層やストレージ層などと混同しないでください。そうではなく、アプリケーション バックエンドのパブリック エンドポイントとして表示する必要があります。

Front Door のバックエンド プールにバックエンドを追加する場合、次の詳細を入力する必要があります。

1. **Backend host type (バックエンド ホストの種類)**: 追加するリソースの種類。 Front Door では、アプリケーション・サービス、クラウド サービス、またはストレージなどからの、アプリケーション バックエンドの自動検出をサポートしています。 Azure または Azure 以外のバックエンドで別のリソースが必要な場合は、'カスタム ホスト' を選択します。 注: 構成時に API では、Front Door 環境からバックエンドにアクセスできるどうかを検証しません。その代わり、バックエンドが Front Door により到達可能であることをユーザーが確認する必要があります。 
2. **Subscription and Backend host name (サブスクリプションとバックエンドのホスト名)**: バックエンド ホストの種類に 'カスタム ホスト' を選択した場合、適切なサブスクリプションと対応するバックエンドのホスト名をユーザー インターフェイスから選択して、バックエンドの範囲を絞り、選択する必要があります。
3. **Backend host header (バックエンド ホスト ヘッダー)**: 各要求でバックエンドに送信されるホスト ヘッダーの値です。 詳細については、「[Backend host header (バックエンド ホスト ヘッダー)](#hostheader)」をご覧ください。
4. **優先順位**: すべてのトラフィックでプライマリ サービス バックエンドを使用したい場合、優先順位をそれぞれのバックエンドに割り当てることができ、プライマリまたはバックアップのバックエンドが使用可能ではない場合は、バックアップを提供できます。 詳細については、「[優先順位](front-door-routing-methods.md#priority)」をご覧ください。
5. **重み**: 均等にまたは重み係数に従って一連のバックエンド間でトラフィックを分散する場合に、さまざまなバックエンドに重みを割り当てることができます。 詳細については、「[重み](front-door-routing-methods.md#weighted)」をご覧ください。


### <a name = "hostheader"></a>バックエンド ホスト ヘッダー

Front Door によりバックエンドに転送された要求には、バックエンドを使用して対象のリソースを取得するホスト ヘッダー フィールドがあります。 このフィールドの値は通常はバックエンドの URI から取得し、ホストとポートが含まれます。 たとえば、`www.contoso.com` に対する要求にはホスト ヘッダー`www.contoso.com`が含まれます。 Azure portal を使用してバックエンドを構成する場合は、このフィールドに設定された既定値はバックエンドのホスト名になります。 たとえば、バックエンドが `contoso-westus.azurewebsites.net` の場合、Azure portal では、バックエンド ホスト ヘッダーの自動設定された値は `contoso-westus.azurewebsites.net` になります。 
</br>ただし、Resource Manager テンプレートまたはその他のメカニズムを使用しており、このフィールドは明示的には設定しない場合、Front Door は受信ホスト名をホスト ヘッダーの値として送信します。 たとえば、要求が `www.contoso.com` に対して行われ、そのとき [Backend host header (バックエンド ホスト ヘッダー)] フィールドが空の状態でバックエンドが `contoso-westus.azurewebsites.net` の場合、Front Door はホスト ヘッダーに `www.contoso.com` を設定します。

大部分のアプリケーションのバックエンド (Web Apps、Blob Storage、Cloud Services など) には、バックエンドのドメインと一致するホスト ヘッダーが必要です。 ただし、バックエンドにルーティングするフロント エンド ホストには、www.contoso.azurefd.net などの別のホストが付けられます。 セットアップしているバックエンドで、ホスト ヘッダーがバックエンドのホスト名と一致する必要がある場合は、「バックエンド ホスト ヘッダー」も、バックエンドのホスト名であることを確認してください。

#### <a name="configuring-the-backend-host-header-for-the-backend"></a>バックエンドのバックエンドのホスト ヘッダーの構成
[バックエンド プール] セクションのバックエンドに対して、[バックエンド ホスト ヘッダー] フィールドを構成できます。

1. Front Door リソースを開き、構成するバックエンドが含まれるバックエンド プールをクリックします。

2. バックエンドを追加していない場合はバックエンドを追加するか、そうでない場合は既存のバックエンドを編集します。 [Backend host header (バックエンド ホスト ヘッダー)] のフィールドは、カスタム値に設定したり、空白のままにすることができます。空白の場合は受信要求のホスト名がホスト ヘッダーの値として使用されることを意味します。



## <a name="next-steps"></a>次の手順

- 「[Front Door の作成方法](quickstart-create-front-door.md)」をご覧ください。
- 「[Front Door のしくみ](front-door-routing-architecture.md)」をご覧ください。
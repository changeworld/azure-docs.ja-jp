---
title: Custom Speech 用のテスト データを準備する - Speech Services
titlesuffix: Azure Cognitive Services
description: Microsoft 音声認識の精度をテストしているか、または独自のモデルをトレーニングしているかどうかにかかわらず、(オーディオ形式またはテキスト形式の) データが必要になります。 このページでは、データの種類、使用方法、および管理方法について説明します。
services: cognitive-services
author: erhopf
manager: nitinme
ms.service: cognitive-services
ms.subservice: speech-service
ms.topic: conceptual
ms.date: 07/05/2019
ms.author: erhopf
ms.openlocfilehash: 6e1ffa11456fc6a021e370d674624d297463ac73
ms.sourcegitcommit: f10ae7078e477531af5b61a7fe64ab0e389830e8
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/05/2019
ms.locfileid: "67603193"
---
# <a name="prepare-data-for-custom-speech"></a>Custom Speech 用のテスト データを準備する

Microsoft 音声認識の精度をテストしているか、または独自のモデルをトレーニングしているかどうかにかかわらず、オーディオ形式とテキスト形式のデータが必要になります。 このページでは、データの種類、使用方法、および管理方法について説明します。

## <a name="data-types"></a>データの種類

この表には、許容されるデータの種類と、それぞれのデータの種類を使用する場合と推奨される数量が一覧表示されています。 モデルを作成するのに、すべてのデータの種類は必要ありません。 データ要件は、テストを作成するのか、またはモデルをトレーニングするのかによって異なります。

| データ型 | テストの使用 | Quantity | トレーニングに使用 | Quantity |
|-----------|-----------------|----------|-------------------|----------|
| [オーディオ](#audio-data-for-testing) | はい<br>目視検査に使用 | 5 つ以上のオーディオ ファイル | いいえ | 該当なし |
| [オーディオ + 人間というラベルが付いたトランスクリプト](#audio--human-labeled-transcript-data-for-testingtraining) | はい<br>精度を評価するために使用 | 0.5 - 5 時間のオーディオ | はい | 1 - 1,000 時間のオーディオ |
| [関連するテキスト](##related-text-data-for-training) | いいえ | 該当なし | はい | 1 - 200 MB の関連テキスト |

ファイルは種類別にデータセットにグループ化し、ZIP ファイルとしてアップロードする必要があります。 各データセットには、1 つのデータの種類のみを含めることができます。

## <a name="upload-data"></a>データのアップロード

データをアップロードする準備ができたら、 **[データのアップロード]** をクリックしてウィザードを起動し、最初のデータセットを作成します。 データのアップロードが許可される前に、データセットにより音声データ型を選択するように求められます。

![Speech ポータルからオーディオを選択する](./media/custom-speech/custom-speech-select-audio.png)

アップロードする各データセットでは、選択したデータの種類の要件が満たされている必要があります。 アップロードする前に、データを正しく書式設定することが重要です。 これにより、データが Custom Speech によって確実に処理されます。 要件は、以降のセクションに示されています。

データセットをアップロードした後は、いくつかの選択肢があります。

* **[テスト]** タブに移動して、オーディオのみまたはオーディオ + 人間というラベルが付いた文字起こしデータを目視で検査できます。
* **[トレーニング]** タブに移動し、オーディオ + 人間の文字起こしデータまたは関連するテキスト データを使用して、カスタム モデルをトレーニングできます。

## <a name="audio-data-for-testing"></a>テスト用のオーディオ データ

オーディオ データは、Microsoft の基準の音声テキスト変換モデルやカスタム モデルの精度をテストするのに最適です。 オーディオ データは、特定のモデルのパフォーマンスに関する音声の精度を検査するために使用されることに注意してください。 モデルの精度の定量化を検討している場合は、[オーディオ + 人間というラベルが付いた文字起こしデータ](#audio--human-labeled-transcript-data-for-testingtraining)を使用します。

次の表を使用して、Custom Speech で使用するためにオーディオ ファイルが確実に正しく書式設定されるようにします。

| プロパティ | 値 |
|----------|-------|
| ファイル形式 | RIFF (WAV) |
| サンプル レート | 8,000 Hz または 16,000 Hz |
| チャンネル | 1 (モノラル) |
| オーディオあたりの最大長 | 2 時間 |
| サンプル形式 | PCM、16 ビット |
| アーカイブ形式 | .zip |
| 最大アーカイブ サイズ | 2 GB |

オーディオがこれらのプロパティを満たしていない場合、または満たしているかどうかを確認する場合は、[sox](http://sox.sourceforge.net) をダウンロードしてオーディオを確認するか変換します。 コマンド ラインを使用してこれらの個々のアクティビティが実行される仕組みの例をいくつか次に示します。

| アクティビティ | 説明 | sox コマンド |
|----------|-------------|-------------|
| オーディオ形式の確認 | このコマンドを使用して、オーディオ ファイルの形式を確認します。 | `sox --i <filename>` |
| オーディオの形式の変換 | このコマンドを使用して、オーディオ ファイルを 16 ビット、16 KHz の 1 つのチャネルに変換します。 | `sox <input> -b 16 -e signed-integer -c 1 -r 16k -t wav <output>.wav` |

## <a name="audio--human-labeled-transcript-data-for-testingtraining"></a>テスト/トレーニング用のオーディオ + 人間というラベルが付いた文字起こしデータ

オーディオ ファイルを処理するときに、Microsoft の音声テキスト変換の精度を測定するには、比較のため、人間というラベルが付いた文字起こし (単語単位) を提供する必要があります。 多くの場合、人間というラベルが付いた文字起こしには時間がかかりますが、ユース ケースのモデルの精度を評価およびトレーニングするために必要です。 認識の向上は、提供されたデータによって決まることに注意してください。 そのため、高品質なトランスクリプトのみをアップロードすることが重要です。  

| プロパティ | 値 |
|----------|-------|
| ファイル形式 | RIFF (WAV) |
| サンプル レート | 8,000 Hz または 16,000 Hz |
| チャンネル | 1 (モノラル) |
| オーディオあたりの最大長 | 60 秒 |
| サンプル形式 | PCM、16 ビット |
| アーカイブ形式 | .zip |
| Zip の最大サイズ | 2 GB |

単語の削除や置換のような問題に対処するには、認識を向上させるために大量のデータが必要です。 一般に、約 10 から 1,000 時間分のオーディオについて単語単位の文字起こしを提供することをお勧めします。 すべての WAV ファイルの文字起こしは、1 つのプレーン テキスト ファイルに格納されている必要があります。 文字起こしファイルの各行には、いずれかのオーディオ ファイルの名前に続けて、対応する文字起こしが含まれている必要があります。 ファイル名と文字起こしは、タブ (\t) で区切る必要があります。

  例:
```
  speech01.wav  speech recognition is awesome
  speech02.wav  the quick brown fox jumped all over the place
  speech03.wav  the lazy dog was not amused
```
> [!NOTE]
> 文字起こしは、UTF-8 バイト オーダー マーク (BOM) としてエンコードされている必要があります。

文字起こしに対しては、システムによって処理できるように、テキストの正規化が行われます。 ただし、Custom Speech Service にデータをアップロードする "_前_" に、ユーザーが行う必要があるいくつかの重要な正規化があります。 文字起こしを準備する際に使用する適切な言語については、「[How to create a human-labeled transcription](how-to-custom-speech-human-labeled-transcriptions.md)」(人間とラベル付けされた文字起こしの作成方法) を参照してください。

オーディオ ファイルと対応する文字起こしを収集したら、Custom Speech ポータルにアップロードする前に、それらを 1 つの .zip ファイルにパッケージ化する必要があります。 これは、3 つのオーディオ ファイルと人間とラベル付けされた文字起こしファイルが含まれたデータセットの例です。

![Speech ポータルからオーディオを選択する](./media/custom-speech/custom-speech-audio-transcript-pairs.png)

## <a name="related-text-data-for-training"></a>トレーニング用の関連するテキスト データ

固有の製品名や機能があり、それらが正しく認識されるようにしたい場合は、トレーニングのために関連するテキスト データを含めることが重要です。 認識を向上させるため、次の 2 種類の関連するテキスト データを提供することができます。

| データ型 | このデータによりどのように認識が向上するか |
|-----------|------------------------------------|
| 発話または文 (およびその両方) | 文章のコンテキスト内で製品名や業界固有のボキャブラリを認識するときの精度を向上させることができます。 |
| 発音 | 一般的でない用語、略語、またはその他の発音が定義されていない単語の発音を向上させることができます。 |

発話は、1 つまたは複数のテキスト ファイルとして提供できます。 テキスト データが読み上げられる内容に近ければ近いほど、精度が向上する可能性は大きくなります。 発音は、1 つのテキスト ファイルとして指定する必要があります。 すべてを 1 つの ZIP ファイルとしてパッケージ化して、Custom Speech ポータルにアップロードできます。

### <a name="guidelines-to-create-an-utterances-file"></a>発話ファイルを作成するためのガイドライン

関連するテキストを使用してカスタム モデルを作成するには、サンプルの発話の一覧を提供する必要があります。 これらの発話は完全な文または文法的に修正する必要はありませんが、実稼働環境で期待する音声入力を正確に反映する必要があります。 特定の用語の重みを増やしたい場合は、これらの特定の用語を含む関連するデータ ファイルに複数の文を追加できます。

この表を使用して、発話の関連するデータ ファイルが確実に正しく書式設定されるようにします。

| プロパティ | 値 |
|----------|-------|
| テキストのエンコード | UTF-8 BOM |
| 1 行あたりの発話の数 | 1 |
| ファイルの最大サイズ | 200 MB |

さらに、次の制限を考慮します。

* 文字を 5 回以上繰り返さないようにします。 例: "aaaa" や "uuuu"。
* 特殊文字または U+00A1 より上の UTF-8 文字は使用できません。
* URI は拒否されます。

### <a name="guidelines-to-create-a-pronunciation-file"></a>発音ファイルを作成するためのガイドライン

ユーザー側で発生するまたは使用する可能性がある、標準の発音がない一般的でない用語がある場合は、カスタム発音ファイルを提供して認識を向上させることができます。

> [!IMPORTANT]
> この機能を使用して、一般的な単語の発音を変更することは推奨されません。

これには、音声発話の例と、それぞれのカスタム発音が含まれます。

| 認識される/表示されるフォーム | 音声フォーム |
|--------------|--------------------------|
| 3CPO | three c p o |  
| CNTK | c n t k |
| IEEE | i triple e |

音声フォームは、スペル アウトされた表示フォームの音声シーケンスです。これは文字、単語、音節、または 3 つすべての組み合わせで構成できます。

カスタマイズされた発音は、英語 (en-US) とドイツ語 (de-DE) で使用できます。 この表に、言語ごとにサポートされている文字を示します。

| 言語 | Locale | 文字 |
|----------|--------|------------|
| 英語 | en-US | a、b、c、d、e、f、g、h、i、j、k、l、m、n、o、p、q、r、s、t、u、v、w、x、y、z |
| ドイツ語 | de-DE | ä、ö、ü、a、b、c、d、e、f、g、h、i、j、k、l、m、n、o、p、q、r、s、t、u、v、w、x、y、z |

この表を使用して、発音の関連するデータ ファイルが確実に正しく書式設定されるようにします。 発音ファイルは小さく、数 KB を超えることはありません。

| プロパティ | 値 |
|----------|-------|
| テキストのエンコード | UTF-8 BOM (英語では ANSI もサポートされています) |
| 1 行のあたりの発音数 | 1 |
| ファイルの最大サイズ | 1 MB (Free レベルに 1 KB) |

## <a name="next-steps"></a>次の手順

* [データを調査する](how-to-custom-speech-inspect-data.md)
* [データを評価する](how-to-custom-speech-evaluate-data.md)
* [モデルをトレーニングする](how-to-custom-speech-train-model.md)
* [モデルをデプロイする](how-to-custom-speech-deploy-model.md)

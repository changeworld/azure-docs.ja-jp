---
title: サービスのクォータと制限
description: 既定の Azure Batch のクォータ、制限、および制約と、クォータの引き上げを要求する方法について説明します
ms.topic: conceptual
ms.date: 04/06/2021
ms.custom: seodec18
ms.openlocfilehash: 6e17a90cc573205bcb964a0428e0b7320323b8a6
ms.sourcegitcommit: b0557848d0ad9b74bf293217862525d08fe0fc1d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/07/2021
ms.locfileid: "106553551"
---
# <a name="batch-service-quotas-and-limits"></a>Batch サービスのクォータと制限

他の Azure サービスと同様に、Batch サービスに関連付けられている特定のリソースにも制限があります。 これらの制限の多くは、Azure によって、サブスクリプションまたはアカウント レベルで適用される既定のクォータです。

Batch ワークロードの設計やスケールアップを行う際は、これらのクォータに留意してください。 たとえば、プールのコンピューティング ノード数がターゲットとして指定した数に満たない場合は、Batch アカウントのコア クォータ制限に達している可能性があります。

1 つの Batch アカウントで複数の Batch ワークロードを実行することも、同じサブスクリプションで異なる Azure リージョンの複数の Batch アカウントにワークロードを分散することもできます。

Batch で実稼働ワークロードを実行する予定がある場合は、1 つまたは複数のクォータについて既定値から増やすことが必要になる場合があります。 クォータを引き上げるには、[クォータの増加を要求](#increase-a-quota)します (無料)。

## <a name="resource-quotas"></a>リソース クォータ

クォータは、容量の保証ではなく、制限です。 大規模な容量が必要な場合は、Azure サポートにお問い合わせください。

また、クォータは保証された値でないことに注意してください。 クォータは、Batch サービスからの変更や、クォータ値を変更するユーザー要求によって異なる場合があります。

[!INCLUDE [azure-batch-limits](../../includes/azure-batch-limits.md)]

## <a name="core-quotas"></a>コア クォータ

### <a name="cores-quotas-in-batch-service-mode"></a>Batch サービス モードでのコア クォータ

Batch によってサポートされる各 VM シリーズに対してコア クォータが存在します。 これらのコア クォータは、Azure portal の **[クォータ]** ページに表示されます。 次に説明するように、VM シリーズのクォータ制限はサポート要求で更新できます。 専用ノードの場合、Batch では、各 VM シリーズに対してコア クォータ制限が適用されます。また、Batch アカウント全体に対して合計のコア クォータ制限も適用されます。 優先順位の低いノードの場合、Batch では、異なる VM シリーズを区別せずに、Batch アカウントに対して合計のコア クォータのみ適用されます。

### <a name="cores-quotas-in-user-subscription-mode"></a>ユーザー サブスクリプション モードでのコア クォータ

プール割り当てモードを **ユーザー サブスクリプション** に設定して [Batch アカウント](accounts.md)を作成した場合、Batch VM とその他のリソースは、プールの作成時またはサイズ変更時に直接サブスクリプションに作成されます。 Azure Batch コア クォータは適用されず、リージョンのコンピューティング コア、シリーズごとのコンピューティング コア、およびその他のリソースに対するサブスクリプションのクォータが使用され、適用されます。

これらのクォータの詳細については、「[Azure サブスクリプションとサービスの制限、クォータ、制約](../azure-resource-manager/management/azure-subscription-service-limits.md)」をご覧ください。

## <a name="pool-size-limits"></a>プール サイズの制限

プール サイズの制限は、Batch サービスによって設定されます。 [リソース クォータ](#resource-quotas)と異なり、これらの値は変更できません。 ノード間通信とカスタム イメージを使用するプールのみが、標準クォータとは異なる制限を持ちます。

| **リソース** | **上限** |
| --- | --- |
| **[ノード間通信に対応するプール](batch-mpi.md)内の計算ノード**  ||
| バッチ サービス プール割り当てモード | 100 |
| バッチ サブスクリプション プール割り当てモード | 80 |
| **マネージド イメージ リソースで作成されたプール [内の計算ノード](batch-custom-images.md)** <sup>1</sup> ||
| 専用ノード | 2000 |
| 優先順位の低いノード | 1000 |

<sup>1</sup> ノード間通信が有効になっていないプール用。

## <a name="other-limits"></a>その他の制限

これらの追加制限は Batch サービスによって設定されます。 [リソース クォータ](#resource-quotas)と異なり、これらの値は変更できません。

| **リソース** | **上限** |
| --- | --- |
| [同時実行タスク数](batch-parallel-node-tasks.md) | ノードのコア数 x 4 |
| [アプリケーション](batch-application-packages.md) 数 | 20 |
| アプリケーションあたりのアプリケーション パッケージ数 | 40 |
| プールあたりのアプリケーション パッケージ数 | 10 |
| タスクの最長有効期間 | 180 日<sup>1</sup> |
| コンピューティング ノードあたりの[マウント](virtual-file-mount.md)数 | 10 |
| プールあたりの証明書数 | 12 |

<sup>1</sup> タスクの最長有効期間 (ジョブに追加されてから完了するまで) は、180 日間です。 完了したタスクは 7 日間保持されます。最長有効期間内に完了しなかったタスクのデータにはアクセスできません。

## <a name="view-batch-quotas"></a>Batch クォータの確認

Batch アカウントのクォータを [Azure portal](https://portal.azure.com) で確認するには、次のようにします。

1. **[Batch アカウント]** を選択し、目的の Batch アカウントを選択します。
1. Batch アカウントのメニューで **[クォータ]** を選びます。
1. Batch アカウントに現在適用されているクォータを確認します。

:::image type="content" source="./media/batch-quota-limit/account-quota-portal.png" alt-text="Azure portal の Batch アカウント クォータを示すスクリーンショット。":::

## <a name="increase-a-quota"></a>クォータを増やす

[Azure portal](https://portal.azure.com) を使用するか [Azure Quota REST API](#azure-quota-rest-api) を使用して、Batch アカウントまたはサブスクリプションに対するクォータの引き上げを要求できます。

クォータの引き上げの種類は、Batch アカウントのプール割り当てモードによって異なります。 クォータの増加を要求するには、クォータを増やしたい VM シリーズを含める必要があります。 クォータの増加が適用されると、すべてのシリーズの VM に適用されます。

サポート要求を送信した後は、Azure サポートからの連絡を待ちます。 クォータ要求の処理が完了するには、数分または最大で 2 営業日かかる場合があります。

### <a name="azure-portal"></a>Azure portal

1. **[クォータ]** ページで、 **[クォータの増加を要求]** を選択します。 または、ポータルのダッシュボードで **[ヘルプとサポート]** タイルを選択して (あるいはポータルの右上隅にある疑問符 ( **?** ) から)、 **[新しいサポート要求]** を選択します。

1. **[基本]** で次のようにします。

    1. **[問題の種類]** で、 **[サービスとサブスクリプションの制限 (クォータ)]** を選択します。
    1. サブスクリプションを選択します。
    1. **[クォータの種類]** で、 **[Batch]** を選択します。
    1. **[次へ]** を選択して続行します。

1. **[Details (詳細)]** には次の項目があります。

    1. **[詳細の指定]** セクションで、場所、クォータの種類、および Batch アカウント (該当する場合) を指定し、増やすクォータを選択します。

       :::image type="content" source="media/batch-quota-limit/quota-increase.png" alt-text="クォータ増加を要求したときのクォータ詳細画面のスクリーンショット。":::

       クォータの種類には次のものが含まれます。

       - **Batch アカウントあたり**  
         このオプションを使用すると、専用および優先順位の低いコア、ジョブとプールの数など、1 つの Batch アカウントに固有のクォータの増加を要求できます。

         このオプションを選択した場合は、この要求を適用する Batch アカウントを指定し、更新するクォータを選択します。 各リソースに対して要求する新しい制限を指定します。

         優先順位の低いクォータは、すべての VM シリーズ全体で 1 つの値です。 制約付き SKU が必要な場合は、 **[優先順位の低いコア]** を選択して、要求する VM ファミリを含める必要があります。

       - **このリージョンでのすべてのアカウント**  
         このオプションを使用すると、各サブスクリプションのリージョンごとの Batch アカウント数など、リージョン内のすべての Batch アカウントに適用されるクォータの増加を要求できます。

    1. **[サポート方法]** で、[ビジネスへの影響](https://aka.ms/supportseverity)に応じた **重大度** と、ご希望の連絡方法およびサポート言語を選択します。

    1. **[連絡先情報]** で、必要な連絡先の詳細を確認して入力します。

1. **[確認および作成]** 、 **[作成]** の順に選択し、サポート要求を送信します。

### <a name="azure-quota-rest-api"></a>Azure クォータ REST API

Azure クォータ REST API を使用して、サブスクリプション レベルまたは Batch アカウント レベルでクォータの増加を要求できます。

詳細と例については、「[Azure サポート REST API を使用してクォータの増加をリクエストする](/rest/api/support/quota-payload#azure-batch)」を参照してください。

## <a name="related-quotas-for-vm-pools"></a>VM プールの関連クォータ

[Azure 仮想ネットワークにデプロイされている仮想マシンの構成の Batch プール](batch-virtual-network.md)によって、追加の Azure ネットワーク リソースが自動的に割り当てられます。 これらのリソースは、Batch プールの作成時に提供される仮想ネットワークを含むサブスクリプションで作成されます。

仮想ネットワークでは、100 プール ノードごとに次のリソースが作成されます。

- 1 つの[ネットワーク セキュリティ グループ](../virtual-network/network-security-groups-overview.md#network-security-groups)
- 1 つの[パブリック IP アドレス](../virtual-network/public-ip-addresses.md)
- 1 つの[ロード バランサー](../load-balancer/load-balancer-overview.md)

これらのリソースは、サブスクリプションの[リソース クォータ](../azure-resource-manager/management/azure-subscription-service-limits.md)によって制限されます。 仮想ネットワークで大規模なプールのデプロイを計画している場合は、これらのリソースの 1 つ以上のクォータの増加を要求することが必要になる場合があります。

## <a name="next-steps"></a>次のステップ

- [Batch サービスのワークフローと主要なリソース](batch-service-workflow-features.md) (プール、ノード、ジョブ、タスクなど) について学習します。
- [Azure サブスクリプションとサービスの制限、クォータ、制約](../azure-resource-manager/management/azure-subscription-service-limits.md)について学習します。
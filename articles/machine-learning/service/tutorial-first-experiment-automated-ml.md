---
title: 初めての自動機械学習の実験を作成する
titleSuffix: Azure Machine Learning
description: Azure Machine Learning のワークスペース ランディング ページ (プレビュー) で自動機械学習を使用して分類モデルをトレーニングおよびデプロイする方法について説明します。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: tutorial
ms.author: tzvikei
author: tsikiksr
ms.reviewer: nibaccam
ms.date: 09/26/2019
ms.openlocfilehash: 38c319fb89e8c763f8231c18cbb59bef099193e2
ms.sourcegitcommit: 55f7fc8fe5f6d874d5e886cb014e2070f49f3b94
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/25/2019
ms.locfileid: "71259327"
---
# <a name="tutorial-create-your-first-classification-model-with-automated-machine-learning"></a>チュートリアル:自動化された機械学習を使用して最初の分類モデルを作成する

このチュートリアルでは、コードを 1 行も記述せずにワークスペース ランディング ページ (プレビュー) で初めての自動機械学習実験を作成する方法について説明します。 この例では、クライアントが金融機関に定期預金を申し込むかどうかを予測する分類モデルを作成します。

自動機械学習を使用することで、時間がかかるタスクを自動化することができます。 自動機械学習では、アルゴリズムとハイパーパラメーターのさまざまな組み合わせをすばやく反復し、選択された成功のメトリックに基づいて最適なモデルを効率的に発見します。

このチュートリアルでは、次のタスクを実施する方法について説明します。

> [!div class="checklist"]
> * Azure Machine Learning ワークスペースを作成します。
> * 自動機械学習の実験を実行します。
> * 実験の詳細を表示します。
> * モデルをデプロイします。

## <a name="prerequisites"></a>前提条件

* Azure サブスクリプション。 Azure サブスクリプションをお持ちでない場合は、[無料アカウント](https://aka.ms/AMLFree)を作成してください。

* [**bankmarketing_train.csv**](https://automlsamplenotebookdata.blob.core.windows.net/automl-sample-notebook-data/bankmarketing_train.csv) データ ファイルをダウンロードします。 **[y]** 列では、このチュートリアルの予測対象列として後で識別される定期預金に顧客が申し込んだかどうかが示されます。 

## <a name="create-a-workspace"></a>ワークスペースの作成

Azure Machine Learning ワークスペースは、機械学習モデルを実験、トレーニング、およびデプロイするために使用する、クラウドでの基本的なリソースです。 ワークスペースは、Azure サブスクリプションとリソース グループを、サービス内の簡単に使用できるオブジェクトに結び付けます。 

ワークスペースを作成するには、Azure リソースを管理するための Web ベースのコンソールである Azure portal を使用します。 

[!INCLUDE [aml-create-portal](../../../includes/aml-create-in-portal.md)]

>[!IMPORTANT] 
> お使いの**ワークスペース**と**サブスクリプション**をメモしておきます。 これらは、適切な場所に実験を作成するために必要になります。 

## <a name="create-and-run-the-experiment"></a>実験を作成して実行する

ワークスペース ランディング ページで、次の実験の設定を完了し、手順を実行します。ワークスペース ランディング ページは、あらゆるスキル レベルのデータ サイエンス実務者向けのデータ サイエンス シナリオを実行するための機械学習ツールを含む統合インターフェイスです。

1. [ワークスペース ランディング ページ](https://ml.azure.com/workspaceportal/)にサインインします。

1. お使いのサブスクリプションと、作成したワークスペースを選択します。

1. **[Get started]\(作業を開始する\)** を選択します。

1. 左側のウィンドウの **[作成]** セクションで **[Automated ML]\(自動 ML\)** を選択します。

   これは初めての自動 ML 実験であるため、[Getting started]\(作業の開始\) 画面が表示されます。

   ![Azure Machine Learning Studio](media/tutorial-1st-experiment-automated-ml/get-started.png)

1. **[Create experiment]\(実験の作成\)** を選択します。 

1. この実験の名前として「`my-1st-automl-experiment`」と入力します。

1. **[Create a new compute]\(新しいコンピューティングの作成\)** を選択し、コンピューティング先を構成します。 コンピューティング先とは、トレーニング スクリプトを実行したりサービスのデプロイをホストしたりするために使用されるローカルまたはクラウド ベースのリソース環境です。 この実験では、クラウド ベースのコンピューティングを使用します。 

   フィールド | 説明 | チュートリアルの値
   ----|---|---
   コンピューティング名 |コンピューティング コンテキストを識別する一意名。|automl-compute
   仮想マシンのサイズ&nbsp;&nbsp;| コンピューティングの仮想マシン サイズを選択します。|Standard_DS12_V2
   最小および最大ノード ([詳細設定] 内)| データをプロファイリングするには、1 つ以上のノードを指定する必要があります。|最小ノード: 1<br>最大ノード: 6

   >[!NOTE]
   >このチュートリアルでは、新しいコンピューティングで作成された既定のストレージ アカウントとコンテナーを使用します。 フォームに自動的に入力されます。
    
1. **[作成]** を選択して、コンピューティング先を取得します。 

   **完了するまでに数分かかります。** 

1. 作成後、ドロップダウン リストから新しいコンピューティング先を選択し、 **[次へ]** を選択します。

1. 新しいデータセットの作成を開始するには、 **[Upload from local file]\(ローカル ファイルからアップロードする\)** を選択します。 

    1. **[参照]** を選択します。
    
    1. ローカル コンピューター上の **bankmarketing_train.csv** ファイルを選択します。 これは、[前提条件](https://automlsamplenotebookdata.blob.core.windows.net/automl-sample-notebook-data/bankmarketing_train.csv)としてダウンロードしたファイルです。

    1. データセットに一意の名前を付け、必要に応じて説明を入力します。 

    1. 左下の **[次へ]** を選択して、ワークスペースの作成時に自動的に設定された既定のコンテナーにアップロードします。 パブリック プレビューでは、ローカル ファイルのアップロードのみがサポートされています。 
    
       アップロードが完了すると、ファイルの種類に基づいて [Settings and preview]\(設定とプレビュー\) フォームが事前設定されます。 
       
    1. **[Settings and preview]\(設定とプレビュー\)** フォームが次のように設定されていることを確認し、 **[次へ]** を選択します。
        
        フィールド|チュートリアルの値
        ---|---
        ファイル形式| 区切り記号
        区切り記号| コンマ
        エンコード| UTF-8
        列見出し| すべてのファイルのヘッダーを同じものにする
        行のスキップ | なし
    
    1. **[スキーマ]** フォームを使用すると、この実験用にデータをさらに構成できます。 この例では、**day_of_week** 特徴のトグル スイッチを選択して、この実験に含めないようにします。 **[完了]** を選択して、ファイルのアップロードと実験用のデータセットの作成を完了します。

        ![[プレビュー] タブの構成](media/tutorial-1st-experiment-automated-ml/schema-tab-config.gif)

1. 予測タスクとして **[分類]** を選択します。

1. 予測するターゲット列として、 **[y]** を選択します。 この列には、クライアントが定期預金を申し込むかどうかが示されます。

1. **[詳細設定]** を展開し、次のようにフィールドを設定します。

   >[!NOTE]
   > このチュートリアルでは、メトリック スコアまたはイテレーションあたりの最大コア数のしきい値は設定しません。 また、アルゴリズムのテストをブロックしません。
   
   詳細設定&nbsp;|説明|チュートリアル用の値&nbsp;&nbsp;
   ------|---------|---
   主要メトリック| 機械学習アルゴリズムを測定される評価メトリック。|AUC_weighted
   終了基準| 条件が満たされると、トレーニング ジョブが停止します。 |トレーニング&nbsp;ジョブ時間:&nbsp;5 <br> <br> イテレーションの最大&nbsp;#&#58;&nbsp;10&nbsp;
   前処理| 自動機械学習による前処理を有効にします。 これには、合成的特徴を生成するための自動データ クレンジング、準備、変換が含まれます。| 有効化
   検証タイプ | クロス検証タイプを選択します。|K フォールド クロス検証
   検証の数 | テストの回数。 | 2 クロス検証 
   コンカレンシー| コンカレント イテレーションの最大数。|5
   
1. **[開始]** を選択して、実験を実行します。 実験の準備が開始されると、ステータス メッセージの画面が表示されます。

>[!IMPORTANT]
> 実験の実行の準備に、**10 から 15 分**かかります。 実行の開始後、**各イテレーションのためにさらに 2、3 分**かかります。  
>
> 運用環境では、しばらく席を離れるかもしれません。 ただし、このチュートリアルでは、イテレーションの結果の調査を、他のイテレーションがまだ実行されている間に、完了しだい開始することをお勧めします。 

##  <a name="explore-iteration-results"></a>イテレーションの結果を調査する

実験が進むにつれて、画面では、作成されたさまざまなイテレーション (モデル) で**イテレーション グラフ**と**イテレーション リスト**が更新され、メトリック スコアによって並べ替えられます。 既定では、選択した **AUC_weighted** メトリックに基づいて最も高いスコアを獲得したモデルがリストの一番上に表示されます。

すべての実験イテレーションが終了するのを待っている間に、完了したイテレーションの **[名前]** を選択して、そのパフォーマンスの詳細を調査します。 
   
以下に示すのは、適合率 - 再現率曲線、混同行列、加重精度スコアなど、各イテレーションに対して生成されるグラフと実行メトリックです。 

![イテレーションの実行の詳細](media/tutorial-1st-experiment-automated-ml/run-detail.gif)

## <a name="deploy-the-model"></a>モデルをデプロイする

ワークスペース ランディング ページで自動機械学習を使用すると、わずかな手順で最良のモデルを Web サービスとしてデプロイすることができます。 デプロイとは、新しいデータを予測したり、潜在的な機会領域を特定したりできるようにモデルを統合することです。 この実験における Web サービスへのデプロイは、定期預金の潜在顧客を特定するためのスケーラブルな反復 Web ソリューションを金融機関が持つことを意味します。 

実行が完了したら、**イテレーション グラフ**と**イテレーション リスト**の詳細ページに戻ります。 

この実験では、**VotingEnsemble** は **AUC_weighted** メトリックに基づいて最適なモデルと見なされます。  このモデルをデプロイしますが、デプロイには完了まで約 20 分かかることにご留意ください。 デプロイ プロセスには、モデルを登録したり、リソースを生成したり、Web サービス用にそれらを構成したりすることを含む、いくつかの手順が伴います。

1. 右上隅の **[Deploy Best Model]\(最適なモデルのデプロイ\)** ボタンを選択します。

1. **[Deploy Best Model]\(最適なモデルのデプロイ\)** ウィンドウに次のように入力します。

    フィールド| 値
    ----|----
    デプロイ名| my-automl-deploy
    デプロイの説明| 初めての自動機械学習実験のデプロイ
    スコアリング スクリプト| 自動生成
    環境スクリプト| 自動生成
    
1. **[デプロイ]** を選択します。  

    デプロイが正常に完了すると、デプロイ完了メッセージが表示されます。
    
これで、予測を生成するための実稼働 Web サービスが作成されました。

## <a name="clean-up-resources"></a>リソースのクリーンアップ

デプロイ ファイルはデータ ファイルと実験ファイルよりも大きいため、格納コストは高くなります。 アカウントのコストを最小限に抑える場合、またはワークスペースと実験ファイルを保持する場合は、デプロイ ファイルだけを削除します。 それ以外の場合で、いずれのファイルも使用する予定がない場合は、リソース グループ全体を削除します。  

### <a name="delete-the-deployment-instance"></a>デプロイ インスタンスの削除

他のチュートリアルや探索用にリソース グループとワークスペースを維持する場合は、Azure portal からデプロイ インスタンスだけを削除します。 

1. [Azure ポータル](https://portal.azure.com//)にアクセスします。 お使いのワークスペースに移動し、左側の **[アセット]** ウィンドウの下の **[デプロイ]** を選択します。 

1. 削除するデプロイを選択し、 **[削除]** を選択します。 

1. **[続行]** を選択します。

### <a name="delete-the-resource-group"></a>リソース グループを削除します

[!INCLUDE [aml-delete-resource-group](../../../includes/aml-delete-resource-group.md)]

## <a name="next-steps"></a>次の手順

この自動機械学習チュートリアルでは、ワークスペース ランディング ページを使用して分類モデルの作成とデプロイを行いました。 詳細と次の手順については、次の記事を参照してください。

> [!div class="nextstepaction"]
> [Web サービスを使用する](how-to-consume-web-service.md)

+ [前処理](how-to-create-portal-experiments.md#preprocess)についてさらに理解を深める。
+ [データ プロファイル](how-to-create-portal-experiments.md#profile)についてさらに理解を深める。
+ [自動機械学習](concept-automated-ml.md)についてさらに理解を深める。

>[!NOTE]
> この Bank Marketing データセットは、[クリエイティブ コモンズ (CCO:パブリック ドメイン) ライセンス](https://creativecommons.org/publicdomain/zero/1.0/)により利用できます。 データベースの個々のコンテンツに含まれる権限は、[データベース コンテンツ ライセンス](https://creativecommons.org/publicdomain/zero/1.0/)によりライセンス供与され、[Kaggle](https://www.kaggle.com/janiobachmann/bank-marketing-dataset) で入手できます。 このデータセットのオリジナルは、[UCI Machine Learning データベース](https://archive.ics.uci.edu/ml/datasets/bank+marketing)から入手できます。<br><br>
> [Moro その他、2014 年] S. Moro、P. Cortez、Rita。 銀行のテレマーケティングの成功を予測するためのデータドリブン アプローチ。 意思決定支援システム、Elsevier、62:22-31、2014 年 6 月。

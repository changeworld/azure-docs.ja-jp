---
title: Azure File Sync エージェントのリリース ノート | Microsoft Docs
description: Azure File Sync エージェントのリリース ノートを読み、Azure Files で組織のファイル共有を集中管理できるようにします。
services: storage
author: wmgries
ms.service: storage
ms.topic: conceptual
ms.date: 2/2/2021
ms.author: wgries
ms.subservice: files
ms.openlocfilehash: 8dba607ae746c26dd80a8e036bcd75930a1e8b01
ms.sourcegitcommit: 44188608edfdff861cc7e8f611694dec79b9ac7d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/04/2021
ms.locfileid: "99538393"
---
# <a name="release-notes-for-the-azure-file-sync-agent"></a>Azure File Sync エージェントのリリース ノート
Azure ファイル同期を使用すると、オンプレミスのファイル サーバーの柔軟性、パフォーマンス、互換性を損なわずに Azure Files で組織のファイル共有を一元化できます。 お使いの Windows Server のインストール済み環境が、Azure ファイル共有の高速キャッシュに生まれ変わります。 SMB、NFS、FTPS など、Windows Server 上で利用できるあらゆるプロトコルを使用して、データにローカルにアクセスできます。 キャッシュは、世界中にいくつでも必要に応じて設置することができます。

この記事では、サポートされているバージョンの Azure File Sync エージェントのリリース ノートについて取り上げます。

## <a name="supported-versions"></a>サポートされているバージョン
サポートされる Azure File Sync エージェント バージョンは次のとおりです。

| マイルストーン | エージェントのバージョン番号 | リリース日 | Status |
|----|----------------------|--------------|------------------|
| V11.2 リリース - [KB4539952](https://support.microsoft.com/topic/azure-file-sync-agent-v11-2-release-february-2021-c956eaf0-cd8e-4511-98c0-e5a1f2c84048)| 11.2.0.0 | 2021 年 2 月 2 日 | サポート対象 - フライティング |
| V11.1 リリース - [KB4539951](https://support.microsoft.com/en-us/help/4539951)| 11.1.0.0 | 2020 年 11 月 4 日 | サポートされています |
| V10.1 リリース - [KB4522411](https://support.microsoft.com/en-us/help/4522411)| 10.1.0.0 | 2020 年 6 月 5 日 | サポートされています |
| 2020 年 5 月の更新プログラム ロールアップ - [KB4522412](https://support.microsoft.com/help/4522412)| 10.0.2.0 | 2020 年 5 月 19 日 | サポートされています |
| V10 リリース - [KB4522409](https://support.microsoft.com/en-us/help/4522409)| 10.0.0.0 | 2020 年 4 月 9 日 | サポートされています |
| 2019 年 12 月の更新プログラム ロールアップ - [KB4522360](https://support.microsoft.com/help/4522360)| 9.1.0.0 | 2019 年 12 月 12日 | サポートされています - エージェント バージョンは 2021 年 2 月 16 日に有効期限が切れます |
| V9 リリース - [KB4522359](https://support.microsoft.com/help/4522359)| 9.0.0.0 | 2019 年 12 月 2 日 | サポートされています - エージェント バージョンは 2021 年 2 月 16 日に有効期限が切れます |
| V8 リリース - [KB4511224](https://support.microsoft.com/help/4511224)| 8.0.0.0 | 2019 年 10 月 8 日 | サポートされています - エージェント バージョンは 2021 年 1 月 12 日に有効期限が切れます |

## <a name="unsupported-versions"></a>サポートされていないバージョン
次の Azure File Sync エージェント バージョンは、有効期限が切れており、サポートされなくなりました。

| マイルストーン | エージェントのバージョン番号 | リリース日 | Status |
|----|----------------------|--------------|------------------|
| V7 リリース | 7.0.0.0 ～ 7.2.0.0 | 該当なし | サポートされていません - エージェント バージョンは 2020 年 9 月 1 日に有効期限が切れました |
| V6 リリース | 6.0.0.0 ～ 6.3.0.0 | 該当なし | サポートされていません - エージェント バージョンは 2020 年 4 月 21 日に有効期限が切れました |
| V5 リリース | 5.0.2.0 - 5.2.0.0 | 該当なし | サポートされていません - エージェント バージョンは 2020 年 3 月 18 日に有効期限が切れました |
| V4 リリース | 4.0.1.0 ～ 4.3.0.0 | 該当なし | サポートされていません - エージェント バージョンは 2019 年 11 月 6 日に有効期限が切れました |
| V3 リリース | 3.1.0.0 - 3.4.0.0 | 該当なし | サポートされていません - エージェント バージョンは 2019 年 8 月 19 日に有効期限が切れました |
| GA 前のエージェント | 1.1.0.0 - 3.0.13.0 | 該当なし | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |

### <a name="azure-file-sync-agent-update-policy"></a>Azure ファイル同期エージェントの更新ポリシー
[!INCLUDE [storage-sync-files-agent-update-policy](../../../includes/storage-sync-files-agent-update-policy.md)]

## <a name="agent-version-11200"></a>エージェント バージョン 11.2.0.0
次のリリース ノートは、2021 年 2 月 2 日にリリースされた Azure File Sync エージェントのバージョン 11.2.0.0 を対象としています。 これらは、バージョン 11.1.0.0 に関して記載されているリリース ノートへの追記です。

### <a name="improvements-and-issues-that-are-fixed"></a>機能強化と修正された問題 
- 項目ごとのエラーの数が多いために同期セッションがキャンセルされると、項目ごとのエラーを修正するためにカスタム同期セッションが必要であると Azure File Sync サービスによって判断された場合、新しいセッションが開始されたときに同期が調整されることがあります。
- Register-AzStorageSyncServer コマンドレットを使用したサーバーの登録が、"ハンドルされない例外" エラーで失敗することがあります。
- サーバー上で許可されるサーバー エンドポイント パスを構成するするための新しい PowerShell コマンドレット (Add-StorageSyncAllowedServerEndpointPath)。 このコマンドレットは、Azure File Sync のデプロイがクラウド ソリューション プロバイダー (CSP) またはサービス プロバイダーによって管理され、顧客がサーバー上で許可されているサーバー エンドポイント パスを構成する必要があるシナリオに役立ちます。 サーバー エンドポイントを作成するとき、指定されたパスが許可リストに含まれていない場合、サーバー エンドポイントの作成は失敗します。 これはオプションの機能であり、サポートされているすべてのパスは、サーバー エンドポイントを作成するときに既定で許可されることに注意してください。  

    
    - 許可されるサーバー エンドポイント パスを追加するには、サーバーで次の PowerShell コマンドを実行します。

    ```powershell
    Import-Module 'C:\Program Files\Azure\StorageSyncAgent\StorageSync.Management.ServerCmdlets.dll' -verbose
    Add-StorageSyncAllowedServerEndpointPath -Path <path>
    ```  

    - サポートされているパスの一覧を取得するには、次の PowerShell コマンドを実行します。
    
    ```powershell
    Get-StorageSyncAllowedServerEndpointPath
    ```     
    - パスを削除するには、次の PowerShell コマンドを実行します。
    
    ```powershell
    Remove-StorageSyncAllowedServerEndpointPath -Path <path>
    ```  
## <a name="agent-version-11100"></a>エージェント バージョン 11.1.0.0
次のリリース ノートは、2020 年 11 月 4 日にリリースされた Azure File Sync エージェントのバージョン 11.1.0.0 を対象としています。

### <a name="improvements-and-issues-that-are-fixed"></a>機能強化と修正された問題
- 初回ダウンロードと事前呼び戻しを制御する新しいクラウドを使った階層化のモード
    - 初回ダウンロード モード: 新しいサーバー エンドポイントへの初回ファイル ダウンロードの方法を選択できるようになりました。 すべてのファイルを階層化したり、最後に変更されたタイムスタンプに応じてサーバーにできる限り多くのファイルをダウンロードすることなどが できるようになります。 クラウドの階層化が使用できない場合も問題ありません。 システム上で階層化されたファイルを使用しないように選択できるようになりました。 詳細については、Azure File Sync のデプロイに関するドキュメントの「[サーバー エンドポイントを作成する](./storage-sync-files-deployment-guide.md?tabs=azure-portal%252cproactive-portal#create-a-server-endpoint)」セクションを参照してください。
    - 事前呼び戻しモード: ファイルが作成または変更されるたびに、同じ同期グループ内で指定したサーバーにファイルを事前に呼び戻すことができます。 これにより、指定した各サーバーでファイルをすぐに使用できるようになります。 世界中のチームが同じデータを使用していますか? 事前呼び戻しを有効にすると、チームが翌朝到着したときに、異なるタイム ゾーンのチームが更新したすべてのファイルがダウンロードされ、すぐに使用できるようになります。 詳細については、Azure File Sync のデプロイのドキュメントにある「[新規および変更されたファイルを Azure ファイル共有から事前に呼び戻す](./storage-sync-files-deployment-guide.md?tabs=azure-portal%252cproactive-portal#proactively-recall-new-and-changed-files-from-an-azure-file-share)」セクションを参照してください。

- クラウドを使った階層化の最終アクセス時間の追跡からアプリケーションを除外する。最後のアクセス時間の追跡からアプリケーションを除外できるようになりました。 アプリケーションからファイルへアクセスが行われると、ファイルの最終アクセス時刻がクラウドを使った階層化データベースで更新されます。 ファイル システムをスキャンするウイルス対策アプリケーションなどを使用すると、すべてのファイルの最終アクセス時刻が同じになるため、ファイルが階層化された時間に影響を及ぼします。

    最後のアクセス時刻の追跡からアプリケーションを除外するには、プロセス名を HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Azure\StorageSync の下にある HeatTrackingProcessNameExclusionList レジストリ設定に追加します。

    例: reg ADD "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Azure\StorageSync" /v HeatTrackingProcessNameExclusionList /t REG_MULTI_SZ /d "SampleApp.exe\0AnotherApp.exe" /f

    > [!Note]  
    > データ重複除去と File Server Resource Manager (FSRM) のプロセスは既定で除外され (ハード コーディングされています)、プロセスの除外リストは 5 分ごとに更新されます。

- さまざまなパフォーマンスと信頼性の向上
    - Azure ファイル共有で変更されたファイルを検出するための変更検出のパフォーマンスが向上しました。
    - 同期アップロードのパフォーマンスが向上しました。
    - 初回アップロードが VSS スナップショットから実行されるようになりました。これにより、項目ごとのエラーと同期セッション エラーが減少します。
    - 特定の I/O パターンの同期信頼性が向上しました。
    - フェールオーバーが発生したときに、フェールオーバー クラスターで同期データベースが巻き戻るバグを修正しました。
    - 階層化されたファイルにアクセスするときの呼び戻しのパフォーマンスが向上しました。

### <a name="evaluation-tool"></a>評価ツール
Azure File Sync をデプロイする前に、Azure File Sync 評価ツールを使用して、お使いのシステムと互換性があるかどうかを評価する必要があります。 このツールは Azure PowerShell コマンドレットであり、サポートされていない文字やサポートされていない OS バージョンなど、ファイル システムとデータセットに関する潜在的な問題をチェックします。 インストールおよび使用手順については、計画ガイドの「[評価ツール](./storage-sync-files-planning.md#evaluation-cmdlet)」セクションを参照してください。 

### <a name="agent-installation-and-server-configuration"></a>エージェントのインストールとサーバー構成
Windows Server で Azure File Sync エージェントをインストールして構成する方法の詳細については、「[Planning for an Azure File Sync deployment (Azure File Sync のデプロイの計画)](storage-sync-files-planning.md)」および [Azure File Sync をデプロイする方法](storage-sync-files-deployment-guide.md)に関するページを参照してください。

- エージェント インストール パッケージは、引き上げられた (管理者) 特権でインストールする必要があります。
- Nano Server のデプロイ オプションでは、このエージェントはサポートされません。
- このエージェントがサポートされるのは、Windows Server 2019、Windows Server 2016 および Windows Server 2012 R2 のみです。
- エージェントには、少なくとも 2 GiB のメモリが必要です。 動的メモリを有効にした仮想マシンでサーバーが実行されている場合は、2048 MiB 以上のメモリで VM を構成する必要があります。 詳細については、「[推奨されるシステム リソース](./storage-sync-files-planning.md#recommended-system-resources)」を参照してください。
- Storage Sync Agent (FileSyncSvc) サービスは、システム ボリューム情報 (SVI) ディレクトリが圧縮されているボリュームに配置されたサーバーのエンドポイントをサポートしません。 この構成は、予期しない結果になります。

### <a name="interoperability"></a>相互運用性
- 階層化されたファイルにアクセスするウイルス対策やバックアップなどのアプリケーションは、オフライン属性を考慮してそれらのファイルのコンテンツの読み取りをスキップする場合を除き、望ましくない再呼び出しを行う可能性があります。 詳細については、「[Troubleshoot Azure File Sync (Azure File Sync のトラブルシューティング)](storage-sync-files-troubleshoot.md)」を参照してください。
- ファイル スクリーンによってファイルがブロックされた場合、File Server Resource Manager (FSRM) ファイル スクリーンが頻繁に同期エラーを引き起こす可能性があります。
- Azure File Sync エージェントがインストールされているサーバー上での sysprep の実行はサポートされていません。予期しない結果になる可能性があります。 Azure File Sync エージェントは、サーバー イメージの展開と sysprep ミニ セットアップの完了後にインストールされます。

### <a name="sync-limitations"></a>同期の制限事項
次の項目は同期されませんが、システムの残りの部分は引き続き正常に動作します。
- サポートされていない文字を含むファイル。 サポートされていない文字の一覧については、[トラブルシューティング ガイド](storage-sync-files-troubleshoot.md#handling-unsupported-characters)のページを参照してください。
- 末尾がピリオドのファイルまたはディレクトリ。
- 2,048 文字を超えるパス。
- 監査に使用されるセキュリティ記述子のシステム アクセス制御リスト (SACL) 部分。
- 拡張属性。
- 代替データ ストリーム。
- 再解析ポイント。
- ハード リンク。
- 圧縮がサーバー ファイルに設定されている場合、変更が他のエンドポイントからそのファイルに同期されるときに、圧縮は保持されません。
- サービスがデータを読み取ることを妨げる、EFS (またはその他のユーザー モードの暗号化) で暗号化されたファイル。

    > [!Note]  
    > 転送中のデータは、Azure File Sync によって常に暗号化されます。 データは常に暗号化されて Azure に保存されます。
 
### <a name="server-endpoint"></a>サーバー エンドポイント
- サーバー エンドポイントは、NTFS ボリューム上にのみ作成できます。 ReFS、FAT、FAT32 などのファイル システムは、現在 Azure File Sync でサポートされていません。
- システム ボリュームでは、クラウドの階層化はサポートされていません。 システム ボリュームにサーバー エンドポイントを作成するには、サーバー エンドポイントを作成するときにクラウドの階層化を無効にします。
- フェールオーバー クラスタリングは、クラスター化ディスクでのみサポートされ、クラスターの共有ボリューム (CSV) ではサポートされません。
- サーバー エンドポイントを入れ子にすることはできません。 同じボリューム上に、別のエンドポイントと並列に共存させることはできます。
- サーバー エンドポイントの場所内に OS またはアプリケーションのページング ファイルを格納しないでください。
- サーバーの名前を変更した場合、ポータル内のサーバー名は更新されません。

### <a name="cloud-endpoint"></a>クラウド エンドポイント
- Azure File Sync は、Azure ファイル共有に対する直接的な変更をサポートします。 ただし、Azure ファイル共有に対して行われた変更は、まず Azure File Sync の変更検出ジョブによって認識される必要があります。 クラウド エンドポイントに対する変更検出ジョブは、24 時間に 1 回起動されます。 Azure ファイル共有で変更されたファイルを直ちに同期したければ、[Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) PowerShell コマンドレットを使用すると、Azure ファイル共有における変更の検出を手動で開始できます。 さらに、REST プロトコルで Azure ファイル共有に対して行われた変更は、SMB の最終更新時刻を更新するものではなく、同期による変更とは見なされません。
- ストレージ同期サービスやストレージ アカウントは、別のリソース グループ、サブスクリプション、または Azure AD テナントに移動できます。 ストレージ同期サービスまたはストレージ アカウントを移動した後、Microsoft.StorageSync アプリケーションにストレージ アカウントへのアクセス権を付与する必要があります (「[Azure File Sync がストレージ アカウントへのアクセス権を持っていることを確認します](./storage-sync-files-troubleshoot.md?tabs=portal1%252cportal#troubleshoot-rbac)」を参照してください)。

    > [!Note]  
    > クラウド エンドポイントを作成するときは、ストレージ同期サービスとストレージ アカウントが同じ Azure AD テナントに存在する必要があります。 クラウド エンドポイントが作成された後、ストレージ同期サービスとストレージ アカウントを別の Azure AD テナントに移動できます。

### <a name="cloud-tiering"></a>クラウドの階層化
- 階層化されたファイルが Robocopy を使用して別の場所にコピーされた場合、その結果のファイルは階層化されません。 誤ってオフライン属性が Robocopy によるコピー操作の対象となり、オフライン属性が設定される場合があります。
- robocopy を使用してファイルをコピーする場合は、/MIR オプションを使用してファイルのタイムスタンプを保存します。 これにより、必ず最近アクセスされたファイルより先に、古いファイルが階層化されます。

## <a name="agent-version-10100"></a>エージェント バージョン 10.1.0.0
次のリリース ノートは、2020 年 6 月 5 日にリリースされた Azure File Sync エージェントのバージョン 10.1.0.0 を対象としています。 これらはバージョン 10.0.0.0 と 10.0.2.0 に関して記載されているリリース ノートへの追記となります。

### <a name="improvements-and-issues-that-are-fixed"></a>機能強化と修正された問題

- Azure プライベート エンドポイントのサポート
    - ストレージ同期サービスへの同期トラフィックをプライベート エンドポイントに送信できるようになりました。 これにより、ExpressRoute または VPN 接続を経由したトンネリングが可能になります。 詳細については、「[Azure File Sync ネットワーク エンドポイントの構成](./storage-sync-files-networking-endpoints.md)」を参照してください。
- [同期されたファイル数] メトリックでは、進行状況が最後ではなく、大規模な同期の実行中に表示されるようになりました。
- エージェントのインストール、クラウドを使った階層化、同期とテレメトリに関するその他の信頼性の向上

## <a name="agent-version-10020"></a>エージェント バージョン 10.0.2.0
次のリリース ノートは、2020 年 5 月 19 日にリリースされた Azure File Sync エージェントのバージョン 10.0.2.0 を対象としています。 これらは、バージョン 10.0.0.0 に関して記載されているリリース ノートへの追記です。

このリリースで修正された問題:  
- ストレージ同期エージェント (FileSyncSvc) は、Azure File Sync v10 エージェントをインストールした後に頻繁にクラッシュします。

> [!Note]  
>このリリースは、新しいバージョンが利用可能になったときに自動的に更新されるように構成されたサーバーにフライト化されていませんでした。 この更新プログラムをインストールするには、Microsoft Update または Microsoft Update カタログを使用します (インストール手順については、[KB4522412](https://support.microsoft.com/help/4522412) を参照してください)。

## <a name="agent-version-10000"></a>エージェント バージョン 10.0.0.0
次のリリース ノートは、(2020 年 4 月 9 日にリリースされた) Azure File Sync エージェントのバージョン 10.0.0.0 を対象としています。

### <a name="improvements-and-issues-that-are-fixed"></a>機能強化と修正された問題

- ポータルでの同期進行の機能強化
    - V10 エージェント リリースでは、実行中の同期セッションの種類が Azure portal にすぐに表示されます。 例: 初回のダウンロード、定期的なダウンロード、バックグラウンドでの再呼び出し (高速ディザスター リカバリーの場合) など。 

- クラウドの階層化のポータル エクスペリエンスの改善
    - 階層化または再呼び出しに失敗したファイルがある場合、サーバー エンドポイントのプロパティで階層化エラーを確認できるようになりました。
    - サーバー エンドポイントで、追加のクラウド階層化情報を入手できます。
        - ローカル キャッシュ サイズ
        - キャッシュ使用効率
        - クラウド階層化ポリシーの詳細: ボリューム サイズ、現在の空き領域、またはローカル キャッシュ内の最も古いファイルが最後にアクセスされた時刻。
    - これらの変更は、最初の V10 エージェントのリリース直後に、Azure portal に送信されます。

- ストレージ同期サービスまたはストレージ アカウント、あるいはその両方を別の Azure Active Directory テナントに移動することのサポート
    - Azure File Sync で、ストレージ同期サービスまたはストレージ アカウント、あるいはその両方の、別のリソース グループ、サブスクリプション、または Azure AD テナントへの移動がサポートされるようになりました。
    
- さまざまなパフォーマンスと信頼性の向上
    - ストレージ アカウントで仮想ネットワーク (VNET) とファイアウォール ルールが構成されていると、Azure ファイル共有の変更検出が失敗する場合があります。
    - 再呼び出しに関連するメモリ使用量の削減。 
    - [Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) コマンドレット使用時のパフォーマンスの向上。
    - その他の信頼性の向上。 
    
### <a name="evaluation-tool"></a>評価ツール
Azure File Sync をデプロイする前に、Azure File Sync 評価ツールを使用して、お使いのシステムと互換性があるかどうかを評価する必要があります。 このツールは Azure PowerShell コマンドレットであり、サポートされていない文字やサポートされていない OS バージョンなど、ファイル システムとデータセットに関する潜在的な問題をチェックします。 インストールおよび使用手順については、計画ガイドの「[評価ツール](./storage-sync-files-planning.md#evaluation-cmdlet)」セクションを参照してください。 

### <a name="agent-installation-and-server-configuration"></a>エージェントのインストールとサーバー構成
Windows Server で Azure File Sync エージェントをインストールして構成する方法の詳細については、「[Planning for an Azure File Sync deployment (Azure File Sync のデプロイの計画)](storage-sync-files-planning.md)」および [Azure File Sync をデプロイする方法](storage-sync-files-deployment-guide.md)に関するページを参照してください。

- エージェント インストール パッケージは、引き上げられた (管理者) 特権でインストールする必要があります。
- Nano Server のデプロイ オプションでは、このエージェントはサポートされません。
- このエージェントがサポートされるのは、Windows Server 2019、Windows Server 2016 および Windows Server 2012 R2 のみです。
- エージェントには、少なくとも 2 GiB のメモリが必要です。 動的メモリを有効にした仮想マシンでサーバーが実行されている場合は、2048 MiB 以上のメモリで VM を構成する必要があります。
- Storage Sync Agent (FileSyncSvc) サービスは、システム ボリューム情報 (SVI) ディレクトリが圧縮されているボリュームに配置されたサーバーのエンドポイントをサポートしません。 この構成は、予期しない結果になります。

### <a name="interoperability"></a>相互運用性
- 階層化されたファイルにアクセスするウイルス対策やバックアップなどのアプリケーションは、オフライン属性を考慮してそれらのファイルのコンテンツの読み取りをスキップする場合を除き、望ましくない再呼び出しを行う可能性があります。 詳細については、「[Troubleshoot Azure File Sync (Azure File Sync のトラブルシューティング)](storage-sync-files-troubleshoot.md)」を参照してください。
- ファイル スクリーンによってファイルがブロックされた場合、File Server Resource Manager (FSRM) ファイル スクリーンが頻繁に同期エラーを引き起こす可能性があります。
- Azure File Sync エージェントがインストールされているサーバー上での sysprep の実行はサポートされていません。予期しない結果になる可能性があります。 Azure File Sync エージェントは、サーバー イメージの展開と sysprep ミニ セットアップの完了後にインストールされます。

### <a name="sync-limitations"></a>同期の制限事項
次の項目は同期されませんが、システムの残りの部分は引き続き正常に動作します。
- サポートされていない文字を含むファイル。 サポートされていない文字の一覧については、[トラブルシューティング ガイド](storage-sync-files-troubleshoot.md#handling-unsupported-characters)のページを参照してください。
- 末尾がピリオドのファイルまたはディレクトリ。
- 2,048 文字を超えるパス。
- 監査に使用されるセキュリティ記述子のシステム アクセス制御リスト (SACL) 部分。
- 拡張属性。
- 代替データ ストリーム。
- 再解析ポイント。
- ハード リンク。
- 圧縮がサーバー ファイルに設定されている場合、変更が他のエンドポイントからそのファイルに同期されるときに、圧縮は保持されません。
- サービスがデータを読み取ることを妨げる、EFS (またはその他のユーザー モードの暗号化) で暗号化されたファイル。

    > [!Note]  
    > 転送中のデータは、Azure File Sync によって常に暗号化されます。 データは常に暗号化されて Azure に保存されます。
 
### <a name="server-endpoint"></a>サーバー エンドポイント
- サーバー エンドポイントは、NTFS ボリューム上にのみ作成できます。 ReFS、FAT、FAT32 などのファイル システムは、現在 Azure File Sync でサポートされていません。
- システム ボリュームでは、クラウドの階層化はサポートされていません。 システム ボリュームにサーバー エンドポイントを作成するには、サーバー エンドポイントを作成するときにクラウドの階層化を無効にします。
- フェールオーバー クラスタリングは、クラスター化ディスクでのみサポートされ、クラスターの共有ボリューム (CSV) ではサポートされません。
- サーバー エンドポイントを入れ子にすることはできません。 同じボリューム上に、別のエンドポイントと並列に共存させることはできます。
- サーバー エンドポイントの場所内に OS またはアプリケーションのページング ファイルを格納しないでください。
- サーバーの名前を変更した場合、ポータル内のサーバー名は更新されません。

### <a name="cloud-endpoint"></a>クラウド エンドポイント
- Azure File Sync は、Azure ファイル共有に対する直接的な変更をサポートします。 ただし、Azure ファイル共有に対して行われた変更は、まず Azure File Sync の変更検出ジョブによって認識される必要があります。 クラウド エンドポイントに対する変更検出ジョブは、24 時間に 1 回起動されます。 Azure ファイル共有で変更されたファイルを直ちに同期したければ、[Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) PowerShell コマンドレットを使用すると、Azure ファイル共有における変更の検出を手動で開始できます。 さらに、REST プロトコルで Azure ファイル共有に対して行われた変更は、SMB の最終更新時刻を更新するものではなく、同期による変更とは見なされません。
- ストレージ同期サービスやストレージ アカウントは、別のリソース グループ、サブスクリプション、または Azure AD テナントに移動できます。 ストレージ同期サービスまたはストレージ アカウントを移動した後、Microsoft.StorageSync アプリケーションにストレージ アカウントへのアクセス権を付与する必要があります (「[Azure File Sync がストレージ アカウントへのアクセス権を持っていることを確認します](./storage-sync-files-troubleshoot.md?tabs=portal1%252cportal#troubleshoot-rbac)」を参照してください)。

    > [!Note]  
    > クラウド エンドポイントを作成するときは、ストレージ同期サービスとストレージ アカウントが同じ Azure AD テナントに存在する必要があります。 クラウド エンドポイントが作成された後、ストレージ同期サービスとストレージ アカウントを別の Azure AD テナントに移動できます。

### <a name="cloud-tiering"></a>クラウドの階層化
- 階層化されたファイルが Robocopy を使用して別の場所にコピーされた場合、その結果のファイルは階層化されません。 誤ってオフライン属性が Robocopy によるコピー操作の対象となり、オフライン属性が設定される場合があります。
- robocopy を使用してファイルをコピーする場合は、/MIR オプションを使用してファイルのタイムスタンプを保存します。 これにより、必ず最近アクセスされたファイルより先に、古いファイルが階層化されます。

## <a name="agent-version-9100"></a>エージェント バージョン 9.1.0.0
次のリリース ノートは、2019 年 12 月 12 日にリリースされた Azure File Sync エージェントのバージョン 9.1.0.0 を対象としています。 これらは、バージョン 9.0.0.0 に関して記載されているリリース ノートへの追記です。

このリリースで修正された問題:  
- Azure File Sync エージェント バージョン 9.0 にアップグレードした後、次のいずれかのエラーで同期が失敗します。
    - 0x8e5e044e (JET_errWriteConflict)
    - 0x8e5e0450 (JET_errInvalidSesid)
    - 0x8e5e0442 (JET_errInstanceUnavailable)

## <a name="agent-version-9000"></a>エージェント バージョン 9.0.0.0
次のリリース ノートは、2019 年 12 月 2 日にリリースされた Azure File Sync エージェントのバージョン 9.0.0.0 を対象としています。

### <a name="improvements-and-issues-that-are-fixed"></a>機能強化と修正された問題

- セルフサービス復元のサポート
    - ユーザーは、セルフサービス復元機能をボリューム上で有効にした後に作成された VSS スナップショットから、以前のバージョンの機能を使用することで、階層化されたファイル (とディスク上のファイル) を復元できるようにもなりました。 v9 リリースより前では、以前のバージョンの機能は階層化されたファイルでサポートされていませんでした。 この機能は、クラウドの階層化が有効になっているエンドポイントが存在する各ボリュームに対して個別に有効にする必要があります。 詳細については、次を参照してください。  
[以前のバージョンおよび VSS (ボリューム シャドウ コピー サービス) を使用するセルフサービス復元](./storage-sync-files-deployment-guide.md#self-service-restore-through-previous-versions-and-vss-volume-shadow-copy-service)。 
 
- ファイル共有のより大きなサイズのサポート 
    - Azure File Sync では、1 つの同期名前空間で最大 64 TiB、1 億ファイルがサポートされるようになりました。  
 
- Server 2019 におけるデータ重複除去のサポート 
    - Windows Server 2016 と Windows Server 2019 で (ボリューム上の 1 つまたは複数のサーバー エンドポイントでクラウドを使った階層化が有効になっているか、無効になっているかに関係なく) データの重複を除去できるようになりました。 Server 2019 で、クラウドを使った階層化を使用するボリュームでデータ重複除去をサポートするには、Windows update [KB4520062](https://support.microsoft.com/help/4520062) をインストールする必要があります。 
 
- 階層化するファイルの最小ファイル サイズの改善 
    - 階層化するファイルの最小ファイル サイズは、ファイル システムのクラスター サイズ (ファイル システムのクラスター サイズの 2 倍) に基づいています。 たとえば、既定では、NTFS ファイル システムのクラスター サイズは 4 KB です。その結果、ファイルの最小ファイル サイズは 8 KB になります。 
 
- ネットワーク接続テスト コマンドレット 
    - Azure File Sync 構成の一部として、複数のサービ スエンドポイントに接続する必要があります。 各ユーザーには、サーバーからアクセスできる必要がある独自の DNS 名があります。 これらの URL は、サーバーが登録されているリージョンにも固有です。 サーバーが登録されると、接続テスト コマンドレット (PowerShell およびサーバー登録ユーティリティ) を使用して、このサーバーに固有のすべての URL との通信をテストできます。 このコマンドレットは、不完全な通信によってサーバーが Azure File Sync で完全に動作しない場合のトラブルシューティングに役立ちます。また、プロキシとファイアウォールの構成を微調整するために使用できます。  
 
        ネットワーク接続テストを実行するには、次の PowerShell コマンドを実行します。 
 
        Import-Module "C:\Program Files\Azure\StorageSyncAgent\StorageSync.Management.ServerCmdlets.dll"  
        テスト - StorageSyncNetworkConnectivity
 
- クラウドの階層化が有効になっている場合にサーバー エンドポイントの改善を削除する 
    - 以前と同様に、サーバー エンドポイントを削除しても、Azure ファイル共有内のファイルは削除されません。 ただし、ローカル サーバー上の再解析ポイントの動作は変更されています。 再解析ポイント (サーバー上のローカルではないファイルへのポインター) は、サーバー エンドポイントを削除するときに削除されるようになりました。 完全にキャッシュ化されたファイルはサーバーに残ります。 この改善により、サーバー エンドポイントを削除するときに、[階層化されたファイルが孤立しなく](./storage-sync-files-troubleshoot.md?tabs=portal1%252cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint)なりました。 サーバー エンドポイントが再作成されると、階層化されたファイルの再解析ポイントがサーバー上で再作成されます。  
 
- パフォーマンスと信頼性の向上 
    - リコールの失敗が軽減されました。 ネットワーク帯域幅に基づいて、再呼び出しサイズが自動的に調整されるようになりました。 
    - 新しいサーバーを同期グループに追加するときのダウンロード パフォーマンスが向上しました。 
    - 制約の競合により、同期されないファイルが削減されました。 
    - サーバー エンドポイント パスがボリューム マウント ポイントの場合、特定のシナリオでは、ファイルの階層化が失敗するか、予期せずに取り消されます。
    
### <a name="evaluation-tool"></a>評価ツール
Azure File Sync をデプロイする前に、Azure File Sync 評価ツールを使用して、お使いのシステムと互換性があるかどうかを評価する必要があります。 このツールは Azure PowerShell コマンドレットであり、サポートされていない文字やサポートされていない OS バージョンなど、ファイル システムとデータセットに関する潜在的な問題をチェックします。 インストールおよび使用手順については、計画ガイドの「[評価ツール](./storage-sync-files-planning.md#evaluation-cmdlet)」セクションを参照してください。 

### <a name="agent-installation-and-server-configuration"></a>エージェントのインストールとサーバー構成
Windows Server で Azure File Sync エージェントをインストールして構成する方法の詳細については、「[Planning for an Azure File Sync deployment (Azure File Sync のデプロイの計画)](storage-sync-files-planning.md)」および [Azure File Sync をデプロイする方法](storage-sync-files-deployment-guide.md)に関するページを参照してください。

- エージェント インストール パッケージは、引き上げられた (管理者) 特権でインストールする必要があります。
- Nano Server のデプロイ オプションでは、このエージェントはサポートされません。
- このエージェントがサポートされるのは、Windows Server 2019、Windows Server 2016 および Windows Server 2012 R2 のみです。
- エージェントには、少なくとも 2 GiB のメモリが必要です。 動的メモリを有効にした仮想マシンでサーバーが実行されている場合は、2048 MiB 以上のメモリで VM を構成する必要があります。
- Storage Sync Agent (FileSyncSvc) サービスは、システム ボリューム情報 (SVI) ディレクトリが圧縮されているボリュームに配置されたサーバーのエンドポイントをサポートしません。 この構成は、予期しない結果になります。

### <a name="interoperability"></a>相互運用性
- 階層化されたファイルにアクセスするウイルス対策やバックアップなどのアプリケーションは、オフライン属性を考慮してそれらのファイルのコンテンツの読み取りをスキップする場合を除き、望ましくない再呼び出しを行う可能性があります。 詳細については、「[Troubleshoot Azure File Sync (Azure File Sync のトラブルシューティング)](storage-sync-files-troubleshoot.md)」を参照してください。
- ファイル スクリーンによってファイルがブロックされた場合、File Server Resource Manager (FSRM) ファイル スクリーンが頻繁に同期エラーを引き起こす可能性があります。
- Azure File Sync エージェントがインストールされているサーバー上での sysprep の実行はサポートされていません。予期しない結果になる可能性があります。 Azure File Sync エージェントは、サーバー イメージの展開と sysprep ミニ セットアップの完了後にインストールされます。

### <a name="sync-limitations"></a>同期の制限事項
次の項目は同期されませんが、システムの残りの部分は引き続き正常に動作します。
- サポートされていない文字を含むファイル。 サポートされていない文字の一覧については、[トラブルシューティング ガイド](storage-sync-files-troubleshoot.md#handling-unsupported-characters)のページを参照してください。
- 末尾がピリオドのファイルまたはディレクトリ。
- 2,048 文字を超えるパス。
- 2 KB を超えるセキュリティ記述子の随意アクセス制御リスト (DACL) 部分 (この問題が該当するのは、1 つの項目に対するアクセス制御エントリ (ACE) が約 40 個を超える場合のみです)。
- 監査に使用されるセキュリティ記述子のシステム アクセス制御リスト (SACL) 部分。
- 拡張属性。
- 代替データ ストリーム。
- 再解析ポイント。
- ハード リンク。
- 圧縮がサーバー ファイルに設定されている場合、変更が他のエンドポイントからそのファイルに同期されるときに、圧縮は保持されません。
- サービスがデータを読み取ることを妨げる、EFS (またはその他のユーザー モードの暗号化) で暗号化されたファイル。

    > [!Note]  
    > 転送中のデータは、Azure File Sync によって常に暗号化されます。 データは常に暗号化されて Azure に保存されます。
 
### <a name="server-endpoint"></a>サーバー エンドポイント
- サーバー エンドポイントは、NTFS ボリューム上にのみ作成できます。 ReFS、FAT、FAT32 などのファイル システムは、現在 Azure File Sync でサポートされていません。
- サーバーのエンドポイントを削除する前にファイルが再呼び出しされない場合、階層化ファイルはアクセスできなくなります。 ファイルへのアクセスを復元するには、サーバー エンドポイントを再作成します。 サーバー エンドポイントが削除されてから 30 日間が経過した場合、またはクラウド エンドポイントが削除された場合は、再呼び出しされなかった階層化ファイルは使用できなくなります。 詳細については、「[サーバー エンドポイントを削除した後、サーバー上で階層化されたファイルにアクセスできない](./storage-sync-files-troubleshoot.md?tabs=portal1%252cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint)」を参照してください。
- システム ボリュームでは、クラウドの階層化はサポートされていません。 システム ボリュームにサーバー エンドポイントを作成するには、サーバー エンドポイントを作成するときにクラウドの階層化を無効にします。
- フェールオーバー クラスタリングは、クラスター化ディスクでのみサポートされ、クラスターの共有ボリューム (CSV) ではサポートされません。
- サーバー エンドポイントを入れ子にすることはできません。 同じボリューム上に、別のエンドポイントと並列に共存させることはできます。
- サーバー エンドポイントの場所内に OS またはアプリケーションのページング ファイルを格納しないでください。
- サーバーの名前を変更した場合、ポータル内のサーバー名は更新されません。

### <a name="cloud-endpoint"></a>クラウド エンドポイント
- Azure File Sync は、Azure ファイル共有に対する直接的な変更をサポートします。 ただし、Azure ファイル共有に対して行われた変更は、まず Azure File Sync の変更検出ジョブによって認識される必要があります。 クラウド エンドポイントに対する変更検出ジョブは、24 時間に 1 回起動されます。 Azure ファイル共有で変更されたファイルを直ちに同期したければ、[Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) PowerShell コマンドレットを使用すると、Azure ファイル共有における変更の検出を手動で開始できます。 さらに、REST プロトコルで Azure ファイル共有に対して行われた変更は、SMB の最終更新時刻を更新するものではなく、同期による変更とは見なされません。
- ストレージ同期サービスやストレージ アカウントは、既存の Azure AD テナント内の別のリソース グループまたはサブスクリプションに移動できます。 ストレージ アカウントを移動する場合は、そのストレージ アカウントにハイブリッド ファイル同期サービス アクセス権を付与する必要があります (「[Azure File Sync がストレージ アカウントへのアクセス権を持っていることを確認します](./storage-sync-files-troubleshoot.md?tabs=portal1%252cportal#troubleshoot-rbac)」を参照してください)。

    > [!Note]  
    > Azure File Sync では、別の Azure AD テナントへのサブスクリプションの移動がサポートされません。

### <a name="cloud-tiering"></a>クラウドの階層化
- 階層化されたファイルが Robocopy を使用して別の場所にコピーされた場合、その結果のファイルは階層化されません。 誤ってオフライン属性が Robocopy によるコピー操作の対象となり、オフライン属性が設定される場合があります。
- robocopy を使用してファイルをコピーする場合は、/MIR オプションを使用してファイルのタイムスタンプを保存します。 これにより、必ず最近アクセスされたファイルより先に、古いファイルが階層化されます。
- クラウドの階層化が有効になっているボリュームに pagefile.sys が配置されていると、ファイルの階層化に失敗することがあります。 pagefile.sys は、クラウドの階層化が無効になっているボリューム上に配置する必要があります。

## <a name="agent-version-8000"></a>エージェント バージョン 8.0.0.0
次のリリース ノートは、Azure File Sync エージェントのバージョン 8.0.0.0 (2019 年 10 月 8 日にリリース) を対象としています。

### <a name="improvements-and-issues-that-are-fixed"></a>機能強化と修正された問題

- 復元パフォーマンスの向上
    - Azure Backup によって実行される回復の回復時間が短縮されました。 復元されたファイルは、Azure File Sync サーバーにより高速に同期されます。 
- クラウドの階層化のポータル エクスペリエンスの改善  
    - 階層化されたファイルの呼び戻しに失敗した場合、サーバー エンドポイントのプロパティで呼び戻しエラーを確認できるようになりました。 また、クラウドの階層化フィルター ドライバーがサーバーに読み込まれていない場合、サーバー エンドポイントの正常性に、エラーと軽減ステップが表示されるようになりました。
- エージェント インストールの簡素化
    - Az/AzureRM PowerShell モジュールでサーバーの登録が不要になったため、インストールがより簡単かつ迅速になりました。
- さまざまなパフォーマンスと信頼性の向上

### <a name="evaluation-tool"></a>評価ツール
Azure File Sync をデプロイする前に、Azure File Sync 評価ツールを使用して、お使いのシステムと互換性があるかどうかを評価する必要があります。 このツールは Azure PowerShell コマンドレットであり、サポートされていない文字やサポートされていない OS バージョンなど、ファイル システムとデータセットに関する潜在的な問題をチェックします。 インストールおよび使用手順については、計画ガイドの「[評価ツール](./storage-sync-files-planning.md#evaluation-cmdlet)」セクションを参照してください。 

### <a name="agent-installation-and-server-configuration"></a>エージェントのインストールとサーバー構成
Windows Server で Azure File Sync エージェントをインストールして構成する方法の詳細については、「[Planning for an Azure File Sync deployment (Azure File Sync のデプロイの計画)](storage-sync-files-planning.md)」および [Azure File Sync をデプロイする方法](storage-sync-files-deployment-guide.md)に関するページを参照してください。

- エージェント インストール パッケージは、引き上げられた (管理者) 特権でインストールする必要があります。
- Nano Server のデプロイ オプションでは、このエージェントはサポートされません。
- このエージェントがサポートされるのは、Windows Server 2019、Windows Server 2016 および Windows Server 2012 R2 のみです。
- エージェントには、少なくとも 2 GiB のメモリが必要です。 動的メモリを有効にした仮想マシンでサーバーが実行されている場合は、2048 MiB 以上のメモリで VM を構成する必要があります。
- Storage Sync Agent (FileSyncSvc) サービスは、システム ボリューム情報 (SVI) ディレクトリが圧縮されているボリュームに配置されたサーバーのエンドポイントをサポートしません。 この構成は、予期しない結果になります。

### <a name="interoperability"></a>相互運用性
- 階層化されたファイルにアクセスするウイルス対策やバックアップなどのアプリケーションは、オフライン属性を考慮してそれらのファイルのコンテンツの読み取りをスキップする場合を除き、望ましくない再呼び出しを行う可能性があります。 詳細については、「[Troubleshoot Azure File Sync (Azure File Sync のトラブルシューティング)](storage-sync-files-troubleshoot.md)」を参照してください。
- ファイル スクリーンによってファイルがブロックされた場合、File Server Resource Manager (FSRM) ファイル スクリーンが頻繁に同期エラーを引き起こす可能性があります。
- Azure File Sync エージェントがインストールされているサーバー上での sysprep の実行はサポートされていません。予期しない結果になる可能性があります。 Azure File Sync エージェントは、サーバー イメージの展開と sysprep ミニ セットアップの完了後にインストールされます。

### <a name="sync-limitations"></a>同期の制限事項
次の項目は同期されませんが、システムの残りの部分は引き続き正常に動作します。
- サポートされていない文字を含むファイル。 サポートされていない文字の一覧については、[トラブルシューティング ガイド](storage-sync-files-troubleshoot.md#handling-unsupported-characters)のページを参照してください。
- 末尾がピリオドのファイルまたはディレクトリ。
- 2,048 文字を超えるパス。
- 2 KB を超えるセキュリティ記述子の随意アクセス制御リスト (DACL) 部分 (この問題が該当するのは、1 つの項目に対するアクセス制御エントリ (ACE) が約 40 個を超える場合のみです)。
- 監査に使用されるセキュリティ記述子のシステム アクセス制御リスト (SACL) 部分。
- 拡張属性。
- 代替データ ストリーム。
- 再解析ポイント。
- ハード リンク。
- 圧縮がサーバー ファイルに設定されている場合、変更が他のエンドポイントからそのファイルに同期されるときに、圧縮は保持されません。
- サービスがデータを読み取ることを妨げる、EFS (またはその他のユーザー モードの暗号化) で暗号化されたファイル。

    > [!Note]  
    > 転送中のデータは、Azure File Sync によって常に暗号化されます。 データは常に暗号化されて Azure に保存されます。
 
### <a name="server-endpoint"></a>サーバー エンドポイント
- サーバー エンドポイントは、NTFS ボリューム上にのみ作成できます。 ReFS、FAT、FAT32 などのファイル システムは、現在 Azure File Sync でサポートされていません。
- サーバーのエンドポイントを削除する前にファイルが再呼び出しされない場合、階層化ファイルはアクセスできなくなります。 ファイルへのアクセスを復元するには、サーバー エンドポイントを再作成します。 サーバー エンドポイントが削除されてから 30 日間が経過した場合、またはクラウド エンドポイントが削除された場合は、再呼び出しされなかった階層化ファイルは使用できなくなります。 詳細については、「[サーバー エンドポイントを削除した後、サーバー上で階層化されたファイルにアクセスできない](./storage-sync-files-troubleshoot.md?tabs=portal1%252cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint)」を参照してください。
- システム ボリュームでは、クラウドの階層化はサポートされていません。 システム ボリュームにサーバー エンドポイントを作成するには、サーバー エンドポイントを作成するときにクラウドの階層化を無効にします。
- フェールオーバー クラスタリングは、クラスター化ディスクでのみサポートされ、クラスターの共有ボリューム (CSV) ではサポートされません。
- サーバー エンドポイントを入れ子にすることはできません。 同じボリューム上に、別のエンドポイントと並列に共存させることはできます。
- サーバー エンドポイントの場所内に OS またはアプリケーションのページング ファイルを格納しないでください。
- サーバーの名前を変更した場合、ポータル内のサーバー名は更新されません。

### <a name="cloud-endpoint"></a>クラウド エンドポイント
- Azure File Sync は、Azure ファイル共有に対する直接的な変更をサポートします。 ただし、Azure ファイル共有に対して行われた変更は、まず Azure File Sync の変更検出ジョブによって認識される必要があります。 クラウド エンドポイントに対する変更検出ジョブは、24 時間に 1 回起動されます。 Azure ファイル共有で変更されたファイルを直ちに同期したければ、[Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) PowerShell コマンドレットを使用すると、Azure ファイル共有における変更の検出を手動で開始できます。 さらに、REST プロトコルで Azure ファイル共有に対して行われた変更は、SMB の最終更新時刻を更新するものではなく、同期による変更とは見なされません。
- ストレージ同期サービスやストレージ アカウントは、既存の Azure AD テナント内の別のリソース グループまたはサブスクリプションに移動できます。 ストレージ アカウントを移動する場合は、そのストレージ アカウントにハイブリッド ファイル同期サービス アクセス権を付与する必要があります (「[Azure File Sync がストレージ アカウントへのアクセス権を持っていることを確認します](./storage-sync-files-troubleshoot.md?tabs=portal1%252cportal#troubleshoot-rbac)」を参照してください)。

    > [!Note]  
    > Azure File Sync では、別の Azure AD テナントへのサブスクリプションの移動がサポートされません。

### <a name="cloud-tiering"></a>クラウドの階層化
- 階層化されたファイルが Robocopy を使用して別の場所にコピーされた場合、その結果のファイルは階層化されません。 誤ってオフライン属性が Robocopy によるコピー操作の対象となり、オフライン属性が設定される場合があります。
- robocopy を使用してファイルをコピーする場合は、/MIR オプションを使用してファイルのタイムスタンプを保存します。 これにより、必ず最近アクセスされたファイルより先に、古いファイルが階層化されます。

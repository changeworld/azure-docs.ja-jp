---
title: Azure Kubernetes Service (AKS) のサポート ポリシー
description: Azure Kubernetes Service (AKS) のサポート ポリシー、共同責任、およびプレビュー (アルファまたはベータ) 段階の機能について学習します。
services: container-service
ms.topic: article
ms.date: 09/18/2020
ms.openlocfilehash: 86b1c0bba30b41a2ee17cfbdf05286c4d2b3fb8a
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/29/2021
ms.locfileid: "91892712"
---
# <a name="support-policies-for-azure-kubernetes-service"></a>Azure Kubernetes Service のサポート ポリシー

この記事では、Azure Kubernetes Service (AKS) のテクニカル サポート ポリシーおよび制限事項の詳細を示します。 また、エージェント ノードの管理、マネージド コントロール プレーン コンポーネント、サード パーティ製オープン ソース コンポーネント、セキュリティと修正プログラムの管理についても説明します。

## <a name="service-updates-and-releases"></a>サービスの更新とリリース

* リリース情報については、[AKS のリリース ノート](https://github.com/Azure/AKS/releases)を参照してください。
* プレビュー段階の機能については、「[AKS Preview Features and Related Projects](https://awesomeopensource.com/projects/aks?categoryPage=11)」(AKS のプレビュー機能と関連プロジェクト) を参照してください。

## <a name="managed-features-in-aks"></a>AKS のマネージド機能

コンピューティング コンポーネントやネットワーク コンポーネントなどの基本的な IaaS (サービスとしてのインフラストラクチャ) クラウド コンポーネントは、低レベルの制御とカスタマイズのオプションにユーザーがアクセスできるようにします。 これに対し、AKS では、クラスターに必要な構成と機能の共通のセットをユーザーに提供するターンキー Kubernetes のデプロイが提供されます。 AKS ユーザーの場合、カスタマイズとデプロイのオプションが制限されています。 その代わり、Kubernetes クラスターを心配したり、直接管理したりする必要はありません。

AKS があれば、ユーザーはフル マネージドの "*コントロール プレーン*" を入手できます。 このコントロール プレーンには、ユーザーが Kubernetes クラスターを操作してエンド ユーザーに提供するために必要なすべてのコンポーネントとサービスが含まれています。 Kubernetes のすべてのコンポーネントは Microsoft によって維持管理および運営されます。

Microsoft では、コントロール ウィンドウで次のコンポーネントを管理および監視します。

* Kubelet または Kubernetes API サーバー
* サービスの品質 (QoS)、スケーラビリティ、およびランタイムを提供する、etcd またはそれと互換性のあるキーと値ストア
* DNS サービス (kube-dns や CoreDNS など)
* Kubernetes プロキシまたはネットワーク
* kube-system 名前空間で実行されている追加のアドオンまたはシステム コンポーネント

AKS はサービスとしてのプラットフォーム (PaaS) ソリューションではありません。 エージェント ノードなどの一部のコンポーネントには "*共同責任*" があり、ユーザーが AKS クラスターの管理をサポートする必要があります。 たとえば、エージェント ノードのオペレーティング システム (OS) のセキュリティ修正プログラムを適用するには、ユーザー入力が必要です。

*マネージド* サービスとは、Microsoft と AKS チームがデプロイと運用を行い、可用性と機能に対して責任を負うことを意味します。 これらのマネージド コンポーネントをお客様が変更することはできません。 Microsoft では、一貫したスケーラブルなユーザー エクスペリエンスを確保するためにカスタマイズを制限しています。 完全にカスタマイズ可能なソリューションについては、「[AKS-Engine](https://github.com/Azure/aks-engine)」(AKS エンジン) を参照してください。

## <a name="shared-responsibility"></a>Shared responsibility

クラスターが作成されると、ユーザーは AKS で作成する Kubernetes エージェント ノードを定義します。 ユーザーのワークロードは、これらのノードで実行されます。

ユーザーのエージェント ノードではプライベート コードが実行され、機密データが格納されるため、Microsoft サポートはこれらのノードへのアクセスを制限されています。 Microsoft サポートは、ユーザーによる明確な許可または支援なしに、これらのノードにサインインしたり、これらのノードでコマンドを実行したり、これらのノードのログを表示することができません。

いずれかの IaaS API を使用してエージェント ノードに直接変更を加えると、クラスターがサポートできない状態になります。 エージェント ノードに対するすべて変更は、`Daemon Sets` などの kubernetes ネイティブのメカニズムを使用して行う必要があります。

同様に、クラスターやノードにあらゆるメタデータ (タグやラベルなど) を追加できますが、システムによって作成されたメタデータを変更すると、クラスターがサポートされていない状態になります。

## <a name="aks-support-coverage"></a>AKS のサポート範囲

Microsoft は、以下の例に関するテクニカル サポートを提供します。

* API サーバーなど、Kubernetes Service によって提供およびサポートされるすべての Kubernetes コンポーネントへの接続。
* Kubernetes コントロール プレーン サービスの管理、アップタイム、QoS、操作 (Kubernetes コントロール プレーン、API サーバー、etcd、coreDNS など)。
* etcd データ ストア。 サポートには、障害計画とクラスターの状態復元のために 30 分ごとに行われる etcd のすべてのデータの自動的で透過的なバックアップが含まれます。 これらのバックアップは、ユーザーが直接使用することはできません。 これらにより、データの信頼性と一貫性が確保されます。 etcd。 オン デマンドのロールバックや復元は、機能としてサポートされていません。
* Kubernetes 用の Azure クラウド プロバイダー ドライバー内のすべての統合ポイント。 これらには、ロード バランサー、永続ボリューム、ネットワーク (Kubernetes や Azure CNI) などの他の Azure サービスへの統合が含まれます。
* Kubernetes API サーバー、etcd、coreDNS などのコントロール プレーン コンポーネントのカスタマイズに関する質問または問題。
* Azure CNI、Kubenet、他のネットワーク アクセスなどのネットワークに関する問題、および機能の問題。 問題には、DNS 解決、パケット損失、ルーティングなどが含まれる可能性があります。 Microsoft では、次のさまざまなネットワーク シナリオをサポートしています。
  * マネージド VNET を使用した、またはカスタムの (独自のものを使用した) サブネットによる Kubenet および Azure CNI。
  * その他の Azure サービスおよびアプリケーションへの接続
  * イングレス コントローラーとイングレスまたはロード バランサーの構成
  * ネットワーク パフォーマンスと待機時間


> [!NOTE]
> Microsoft/AKS によって実行されるクラスター アクションはすべて、ユーザーの同意を得たうえで、組み込みの Kubernetes ロール `aks-service` と組み込みのロール バインド `aks-service-rolebinding` に基づいて行われます。 このロールにより、AKS はクラスターの問題のトラブルシューティングや診断を行うことができますが、アクセス許可の変更や、ロールやロール バインドの作成など、高い特権を必要とする操作を行うことはできません。 ロールによるアクセスは、アクティブなサポート チケットで Just-In-Time (JIT) アクセスを使用する場合にのみ有効になります。

Microsoft では、以下に挙げる例に関するテクニカル サポートは提供していません。

* Kubernetes の使用方法に関する質問。 たとえば、Microsoft サポートでは、カスタムのイングレス コント ローラーの作成方法、アプリケーションのワークロードの使用方法、サード パーティまたはオープン ソースのソフトウェア パッケージやツールの適用方法に対するアドバイスは提供していません。
  > [!NOTE]
  > Microsoft サポートでは、AKS クラスターの機能、カスタマイズ、およびチューニング (Kubernetes 操作の問題や手順など) に対するアドバイスは提供できます。
* Kubernetes コントロール プレーンの一部として提供されない、または AKS クラスターと共にデプロイされない、サード パーティのオープン ソース プロジェクト。 これらのプロジェクトには、Istio、Helm、Envoy などが含まれる場合があります。
  > [!NOTE]
  > Microsoft では、Helm などのサード パーティのオープン ソース プロジェクトに対してベスト エフォートのサポートを提供できます。 サード パーティのオープン ソース ツールが Kubernetes の Azure クラウド プロバイダーまたは他の AKS 固有のバグと統合される場合、Microsoft では、Microsoft ドキュメントからの例やアプリケーションをサポートします。
* サード パーティのクローズド ソース ソフトウェア。 このソフトウェアには、セキュリティ スキャン ツール、およびネットワーク デバイスまたはソフトウェアが含まれる場合があります。
* [AKS ドキュメント](./index.yml)に記載されている以外のネットワークのカスタマイズ。


## <a name="aks-support-coverage-for-agent-nodes"></a>エージェント ノードに対する AKS のサポート範囲

### <a name="microsoft-responsibilities-for-aks-agent-nodes"></a>AKS エージェント ノードに対する Microsoft の責任

Microsoft とユーザーは、次の場合に、Kubernetes エージェント ノードに対する責任を共有します。

* 基本 OS イメージに、必要な追加機能 (監視エージェントやネットワーク エージェントなど) がある。
* エージェント ノードが OS 修正プログラムを自動的に受信する。
* エージェント ノード上で実行される Kubernetes コントロール プレーン コンポーネントに関する問題が自動修復される。 コンポーネントには、以下のものが含まれます。
  * `Kube-proxy`
  * Kubernetes マスター コンポーネントへの通信パスを提供するネットワーク トンネル
  * `Kubelet`
  * `Moby` または `ContainerD`

> [!NOTE]
> エージェント ノードが動作していない場合、AKS は個々のコンポーネントまたはエージェント ノード全体を再起動する可能性があります。 こうした再起動操作は自動化されており、これにより一般的な問題の自動修復機能が提供されます。 自動修復メカニズムの詳細については、「[ノードの自動修復](node-auto-repair.md)」を参照してください

### <a name="customer-responsibilities-for-aks-agent-nodes"></a>AKS エージェント ノードに対するお客様の責任

Microsoft では、イメージ ノードの更新プログラムと新しいイメージを毎週提供していますが、既定ではパッチは自動的には適用されません。 エージェント ノード OS とランタイム コンポーネントにパッチを適用し続けるには、定期的な[ノード イメージのアップグレード](node-image-upgrade.md)のスケジュールを維持するか、これを自動化する必要があります。

同様に、AKS は kubernetes の新しいパッチとマイナー バージョンを定期的にリリースしています。 これらの更新プログラムには、Kubernetes に対するセキュリティまたは機能の強化が含まれていることがあります。 クラスターの kubernetes バージョンを最新の状態に保ち、[AKS Kubernetes のサポート バージョン ポリシー](supported-kubernetes-versions.md)に従う責任はユーザーが担います。

#### <a name="user-customization-of-agent-nodes"></a>エージェント ノードのユーザー カスタマイズ
> [!NOTE]
> AKS エージェント ノードは、Azure portal で通常の Azure IaaS リソースとして表示されます。 しかし、これらの仮想マシンは、カスタムの Azure リソース グループ (通常は先頭に MC_\* が付加されている) にデプロイされます。 IaaS の API またはリソースを使用して、ベース OS イメージを変更したり、これらのノードを直接カスタマイズしたりすることはできません。 AKS API 経由で行われたのではないすべてのカスタム変更は、アップグレード、スケーリング、更新、および再起動後には保持されない可能性があります。 Microsoft サポートが変更を指示しない限り、エージェント ノードへの変更を実行しないでください。

AKS は、ユーザーに代わってエージェント ノードのライフサイクルと操作を管理します。エージェント ノードに関連付けられている IaaS リソースを変更することは **サポートされていません**。 サポートされていない操作の例としては、ノード プールの仮想マシン スケール セットのカスタマイズを、仮想マシン スケール セット ポータルまたは API を使用して構成を手動で変更して行うことが挙げられます。
 
ワークロード固有の構成またはパッケージの場合、AKS では [Kubernetes `daemon sets`](https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/) を使用することをお勧めします。

Kubernetes の特権 `daemon sets` と init コンテナーを使用すると、ユーザーは、クラスターのエージェント ノードでサード パーティ製ソフトウェアを調整/変更またはインストールできます。 このようなカスタマイズの例としては、カスタム セキュリティ スキャン ソフトウェアの追加や、sysctl 設定の更新などがあります。

この方法は上記の要件が適用される場合に推奨されますが、カスタムでデプロイした `daemon set` が原因でノードが使用できなくなった場合、AKS のエンジニアリングとサポートは変更のトラブルシューティングや診断にはお役に立てません。

### <a name="security-issues-and-patching"></a>セキュリティの問題と修正プログラムの適用

AKS の 1 つまたは複数のマネージド コンポーネントでセキュリティ上の欠陥が見つかった場合、AKS チームは、問題を軽減するために影響を受けるすべてのクラスターに修正プログラムを適用します。 または、チームがユーザーにアップグレード ガイダンスを示します。

セキュリティ上の欠陥によって影響を受けるエージェント ノードについて、Microsoft は影響に関する詳細と、セキュリティの問題を修正または軽減するための手順 (通常はノード イメージのアップグレードまたはクラスター パッチのアップグレード) をユーザーに通知します。

### <a name="node-maintenance-and-access"></a>ノードのメンテナンスとアクセス

ユーザーはエージェント ノードにサインインして変更を加えることができますが、変更によってクラスターがサポートできない状態になる可能性があるため、この操作はお勧めできません。

## <a name="network-ports-access-and-nsgs"></a>ネットワーク ポート、アクセス、NSG

NSG のカスタマイズは、カスタム サブネット上でのみ行うことができます。 マネージド サブネット上またはエージェント ノードの NIC レベルで NSG をカスタマイズすることはできません。 AKS では、エグレスを制御し必要な接続を確保するために、特定のエンドポイントへのエグレス要件があります。[エグレス トラフィックの制限](limit-egress-traffic.md)に関する記事を参照してください。

## <a name="stopped-or-de-allocated-clusters"></a>停止または割り当て解除されたクラスター

前述のように、IaaS API、CLI、ポータルを使用してすべてのクラスター ノードを手動で割り当て解除すると、クラスターはサポートされなくなります。 すべてのノードを停止または割り当て解除するためのサポートされる唯一の方法は、[AKS クラスターを停止する](start-stop-cluster.md#stop-an-aks-cluster)ことです。この場合、クラスターの状態が最大 12 か月間保持されます。

12 か月以上停止したクラスターは、状態を保持しなくなります。 

AKS API の外部で割り当て解除されたクラスターについては、状態の保存が保証されません。 この状態のクラスターのコントロール プレーンは 30 日後にアーカイブされ、12 か月後に削除されます。

AKS は、30 日以上の延長期間について、サポート ガイドラインを超えて構成されているコントロール プレーンをアーカイブする権利を留保します。 AKS では、クラスターの etcd メタデータのバックアップが保持され、クラスターを簡単に再割り当てすることができます。 この再割り当ては、クラスターをサポートに戻す任意の PUT 操作 (アクティブなエージェント ノードへのアップグレードやスケーリングなど) によって開始できます。

サブスクリプションが中断または削除された場合、クラスターのコントロール プレーンと状態は 90 日後に削除されます。

## <a name="unsupported-alpha-and-beta-kubernetes-features"></a>非サポートのアルファとベータの Kubernetes 機能

AKS では、アップストリームの Kubernetes プロジェクト内の安定したベータの機能のみがサポートされます。 文書化されていない限り、AKS では、アップストリームの Kubernetes プロジェクトで使用できるアルファの機能がサポートされていません。

## <a name="preview-features-or-feature-flags"></a>プレビュー機能または機能フラグ

拡張テストとユーザー フィードバックを必要とする機能の場合、Microsoft では、新しいプレビュー機能または機能フラグの背後にある機能をリリースします。 これらの機能は、プレリリースまたはベータ機能としてお考えください。

プレビュー機能または機能フラグは、運用環境向けではありません。 API と動作の継続的な変更、バグの修正、その他の変更により、クラスターが不安定になったり、ダウンタイムが生じたりする可能性があります。

パブリック プレビュー機能は、プレビュー段階にあり、運用環境向けではなく、AKS のテクニカル サポート チームによるサポートが営業時間内に限られるため、"ベスト エフォート" サポートに該当します。 詳細については、次を参照してください。

* [Azure サポートに関する FAQ](https://azure.microsoft.com/support/faq/)

## <a name="upstream-bugs-and-issues"></a>アップストリームのバグと問題

アップストリームの Kubernetes プロジェクトにおける開発速度では、バグが必ず発生します。 これらのバグの一部には、修正プログラムを適用できず、AKS システム内で回避できないものがあります。 代わりに、バグの修正では、アップストリームのプロジェクト (Kubernetes、ノードまたはエージェントのオペレーティング システム、カーネルなど) に対する大規模な修正プログラムが必要になります。 Microsoft が所有するコンポーネント (Azure クラウド プロバイダーなど) については、AKS と Azure の担当者がコミュニティのアップストリームで問題の修正に努めます。

テクニカル サポートの問題の根本原因が 1 つ以上のアップストリームのバグである場合、AKS のサポートおよびエンジニアリング チームは次のことを行います。

* アップストリームのバグを特定し、その問題がお客様のクラスターやワークロードに影響する理由を説明するのに役立つサポートの詳細にリンクします。 お客様は、問題を監視し、新しいリリースで修正プログラムがいつ提供されるかを確認できるよう、必要なリポジトリへのリンクを受け取ります。
* 潜在的な回避策または軽減策を提供します。 問題を軽減できる場合は、[既知の問題](https://github.com/Azure/AKS/issues?q=is%3Aissue+is%3Aopen+label%3Aknown-issue)が AKS リポジトリに記録されます。 既知の問題の記録には、次の内容が示されます。
  * アップストリームのバグへのリンクを含む問題
  * 回避策、および解決策のアップグレードやその他の永続化に関する詳細情報
  * アップストリームのリリース周期に基づく、問題の組み込みの大まかなタイムライン

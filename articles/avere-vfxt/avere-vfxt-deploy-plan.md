---
title: Avere vFXT システムの計画 - Azure
description: Avere vFXT for Azure をデプロイする前に行う計画について説明します
author: ekpgh
ms.service: avere-vfxt
ms.topic: conceptual
ms.date: 02/20/2019
ms.author: v-erkell
ms.openlocfilehash: 46978d19a0789bb43e861ca89661aa5b78eb4ec7
ms.sourcegitcommit: 62d3a040280e83946d1a9548f352da83ef852085
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/08/2019
ms.locfileid: "59271069"
---
# <a name="plan-your-avere-vfxt-system"></a>Avere vFXT システムの計画

この記事では、ニーズに合わせて配置されてサイズが設定される新しい Avere vFXT for Azure クラスターを計画する方法について説明します。 

Azure Marketplace への移動、または任意の VM の作成を行う前に、クラスターでどのように Azure 内の他の要素を操作するかを検討してください。 クラスター リソースがご利用のプライベート ネットワークとサブネットに配置される場所を計画し、ご利用のバックエンド ストレージを配置する場所を決定します。 作成したクラスター ノードが、自分のワークフローをサポートするために、十分に強力であることを確認します。 

詳細については、後の説明を参照してください。

## <a name="resource-group-and-network-infrastructure"></a>リソース グループとネットワーク インフラストラクチャ

ご利用の Avere vFXT for Azure のデプロイの要素を配置する場所を検討してください。 以下の図は、Avere vFXT for Azure コンポーネントに対して可能な配置を示しています。

![1 つのサブネット内のクラスター コントローラーとクラスター VM を示す図。 サブネット境界の周囲は、VNet の境界です。 VNet の内側にはストレージ サービス エンドポイントを表す六角形があり、VNet の外側の BLOB ストレージに破線の矢印で接続されています。](media/avere-vfxt-components-option.png)

Avere vFXT システムのネットワーク インフラストラクチャを計画する場合、次のガイドラインに従います。

* 要素はすべて、Avere vFXT のデプロイ向けに作成された新しいサブスクリプションで管理される必要があります。 利点は次のとおりです。 
  * コストの追跡がより簡単 - 1 つのサブスクリプションに含まれるリソース、インフラストラクチャ、およびコンピューティング サイクルから発生するすべてのコストを表示および監査します。
  * クリーンアップがより容易 - プロジェクトが終了したらサブスクリプション全体を削除できます。
  * リソース クォータのパーティション分割が便利 - Avere vFXT クライアントとクラスターを 1 つのサブスクリプション内に分離することで、起きる可能性があるリソース調整から、その他の重要なワークロードを保護します。 これにより、高パフォーマンス コンピューティング ワークフロー用に多数のクライアントを稼働する際の競合を回避することができます。

* ご利用のクライアント コンピューティング システムを vFXT クラスターの近くに配置します。 バックエンド ストレージは、さらにリモートである可能性があります。  

* vFXT クラスターとクラスター コントローラー VM は、同じ仮想ネットワーク (vnet) 内の同じリソース グループ内に配置され、同じストレージ アカウントを使用する必要があります。 ほとんどの場合、これは自動化されたクラスター作成テンプレートによって処理されます。

* このクラスターは、IP アドレスがクライアントやコンピューティング リソースと競合することを避けるために、独自のサブネットに配置する必要があります。 

* クラスター作成テンプレートは、リソース グループ、仮想ネットワーク、サブネット、およびストレージ アカウントなど、クラスターの必要なインフラストラクチャーのほとんどを作成できます。 既に存在するリソースを使用する場合は、それらのリソースが以下の表の要件を満たしていることを確認してください。 

  | Resource | 既存のリソースを使用するか | 必要条件 |
  |----------|-----------|----------|
  | リソース グループ | 空の場合、はい | 空でなければならない| 
  | ストレージ アカウント | クラスターの作成後、既存の Blob コンテナーを接続する場合は、はい <br/>  クラスター作成中に新しい Blob コンテナーを作成する場合は、いいえ | 既存の Blob コンテナーは空でなければならない <br/> &nbsp; |
  | 仮想ネットワーク | はい | 新しい Azure Blob コンテナーを作成する場合は、ストレージ サービス エンドポイントを含める必要がある | 
  | Subnet | はい |   |

## <a name="ip-address-requirements"></a>IP アドレスの要件 

ご利用のクラスターのサブネットに、クラスターをサポートするために十分な IP アドレスの範囲があることを確認してください。 

Avere vFXT クラスターでは、次の IP アドレスを使用します。

* 1 つのクラスターの管理 IP アドレス。 このアドレスはクラスター内のノードからノードへ移動できますが、Avere Control Panel の構成ツールに接続できるように、常に利用可能です。
* クラスター ノードごと
  * 少なくとも 1 つのクライアント側の IP アドレス。 (クライアント側のアドレスはすべて、クラスターの *vserver* によって管理されます。これは、必要に応じて、ノード間を移動できます。)
  * クラスター通信用に 1 つの IP アドレス
  * (VM に割り当てられている) 1 つのインスタンスの IP アドレス

Azure BLOB ストレージを使用する場合、ご利用のクラスターの VNet からの IP アドレスを必要とする可能性もあります。  

* Azure BLOB ストレージ アカウントには、少なくとも 5 つの IP アドレスが必要です。 BLOB ストレージをご利用のクラスターと同じ VNet に配置する場合、この要件に留意してください。
* ご利用のクラスターの仮想ネットワークの外側にある Azure BLOB ストレージを使用する場合、VNet の内側にストレージ サービス エンドポイントを作成する必要があります。 このエンドポイントでは、IP アドレスを使用しません。

クラスターとは別のリソース グループにネットワーク リソースと BLOB ストレージ (使用する場合) を配置するオプションがあります。

## <a name="vfxt-node-size"></a>vFXT ノードのサイズ

クラスター ノートとして機能する VM によって、要求のスループットと自分のキャッシュのストレージ容量が決定されます。 <!-- The instance type offered has been chosen for its memory, processor, and local storage characteristics. You can choose from two instance types, with different memory, processor, and local storage characteristics. -->

それぞれの vFXT ノードは同一になります。 つまり、3 ノード クラスターを作成する場合、同じ種類とサイズの VM が 3 つ用意されます。 

| インスタンスの種類 | vCPU 数 | メモリ  | ローカル SSD ストレージ  | 最大データ ディスク数 | キャッシュされていないディスク スループット | NIC (数) |
| --- | --- | --- | --- | --- | --- | --- |
| Standard_E32s_v3 | 32  | 256 GiB | 512 GiB  | 32 | 51,200 IOPS <br/> 768 Mbps | 16,000 Mbps (8)  |

ノードごとのディスク キャッシュを構成することができ、1,000 GB から 8,000 GB の範囲にすることができます。 Standard_E32s_v3 ノードの推奨キャッシュ サイズは、ノードあたり 4 TB です。

これらの VM の追加情報については、次の Microsoft Azure ドキュメントを参照してください。

* [メモリ最適化済み仮想マシンのサイズ](https://docs.microsoft.com/azure/virtual-machines/windows/sizes-memory)

## <a name="account-quota"></a>アカウント クォータ

ご利用のサブスクリプションに、Avere vFXT クラスターおよび使用されている任意のコンピューティング システムまたはクライアント システムを実行する容量があることを確認してください。 詳細については、「[vFXT クラスターのクォータ](avere-vfxt-prereqs.md#quota-for-the-vfxt-cluster)」を参照してください。

## <a name="back-end-data-storage"></a>バックエンドのデータ ストレージ

データがキャッシュ内にない場合、Avere vFXT クラスターはデータをどこに格納する必要があるでしょうか。 ワーキング セットを、新しい BLOB コンテナーに長期的に保存するか、既存のクラウドやハードウェア ストレージ システムに保存するかを決定します。 

バック エンドで Azure BLOB ストレージを使用する必要がある場合、vFXT クラスターを作成する一環として、新しいコンテナーを作成する必要があります。 このオプションでは、クラスターが準備できたらすぐに使用できるように、新しいコンテナーを作成および構成します。 

詳細については、[Azure 用の Avere vFXT を作成する](avere-vfxt-deploy.md#create-the-avere-vfxt-for-azure)ことに関するページを参照してください。

> [!NOTE]
> 空の BLOB ストレージ コンテナーのみを、Avere vFXT システムのコア フィルターとして使用できます。 vFXT は、既存のデータを保持する必要なく、そのオブジェクト ストアを管理できる必要があります。 
>
> クライアント マシンと Avere vFXT のキャッシュを使用することで、データをクラスターの新しいコンテナーに効率的にコピーする方法については、「[vFXT クラスターへのデータの移動](avere-vfxt-data-ingest.md)」を参照してください。

既存のオンプレミスのストレージ システムを使用する場合は、作成された後に、vFXT クラスターに追加する必要があります。 既存のストレージ システムを Avere vFXT クラスターに追加する方法の詳細な手順については、「[ストレージの構成](avere-vfxt-add-storage.md)」を参照してください。

## <a name="cluster-access"></a>クラスターへのアクセス 

Azure クラスターの Avere vFXT は、プライベート サブネット内に置かれ、クラスターにパブリック IP アドレスはありません。 クラスター管理とクライアント接続のために、プライベート サブネットにアクセスする方法をいくつか用意する必要があります。 

以下のようなアクセス オプションがあります。

* ジャンプ ホスト - プライベート ネットワーク内の独立した VM にパブリック IP アドレスを割り当てて、それを使用してクラスター ノードへの SSL トンネルを作成します。 

  > [!TIP]
  > クラスター コントローラーにパブリック IP アドレスを設定した場合は、それをジャンプ ホストとして使用できます。 詳細については、「[ジャンプ ホストとしてのクラスター コントローラー](#cluster-controller-as-jump-host)」を参照してください。

* 仮想プライベート ネットワーク (VPN) - プライベート ネットワークへのポイント対サイト VPN またはサイト間 VPN を構成します。

* Azure ExpressRoute - ExpressRoute パートナーを通じてプライベート接続を構成します。 

これらのオプションの詳細については、[インターネット通信に関する Azure Virtual Network](../virtual-network/virtual-networks-overview.md#communicate-with-the-internet) のドキュメントを参照してください。

### <a name="cluster-controller-as-jump-host"></a>ジャンプ ホストとしてのクラスター コントローラー

クラスター コントローラーにパブリック IP アドレスを設定した場合は、それを、プライベート サブネット外から Avere vFXT クラスターにアクセスするジャンプ ホストとして使用できます。 ただし、コントローラーはクラスター ノードを変更するアクセス特権を持っているため、これによって小さなセキュリティ リスクが生じます。  

パブリック IP アドレスを使用するコントローラーのセキュリティーを向上させるために、デプロイ スクリプトは、インハウンド アクセスをポート 22 のみに制限するネットワーク セキュリティー グループを自動的に作成します。 さらに、IP ソース アドレスの範囲にアクセスをロック ダウン (つまり、クラスター アクセスに使用するつもりのマシンからの接続のみを許可) することで、システムを保護できます。

クラスターの作成時には、クラスター コントローラーにパブリック IP アドレスを作成するかどうかを選択できます。 

* 新しい vnet またはサブネットを作成する場合は、クラスター コントローラーにパブリック IP アドレスが割り当てられます。
* 既存の vnet とサブネットを選択すると、クラスター コントローラーはプライベート IP アドレスのみを持つことになります。 

## <a name="vm-access-roles"></a>VM アクセス ロール 

Azure では、[ロールベースのアクセス制御](../role-based-access-control/index.yml) (RBAC) を使用し、クラスターの VM を承認して特定のタスクを実行します。 たとえば、クラスター コントローラーは、クラスター ノード VM を作成して構成するための承認を必要とします。 クラスター ノードは、IP アドレスを他のクラスター ノードに割り当てたり、再割り当てしたりできる必要があります。

Avere vFXT 仮想マシンでは、次の 2 つの組み込み Azure ロールが使用されます。 

* クラスター コントローラーには、組み込みロール [Avere Contributor](../role-based-access-control/built-in-roles.md#avere-contributor) が使用されます。 
* クラスター ノードには、組み込みロール [Avere Operator](../role-based-access-control/built-in-roles.md#avere-operator) が使用されます。

Avere vFXT コンポーネントのアクセス ロールをカスタマイズする必要がある場合は、独自のロールを定義して、VM に対しその作成時に割り当てる必要があります。 Azure Marketplace ではデプロイ テンプレートを使用できません。 「[お使いのシステムでサポートを受ける](avere-vfxt-open-ticket.md)」の説明に従って Azure portal からサポート チケットを開き、マイクロソフト カスタマー サービスおよびサポートに相談してください。 

## <a name="next-step-understand-the-deployment-process"></a>次のステップ: デプロイ プロセスを理解する

[デプロイの概要](avere-vfxt-deploy-overview.md)に関するページでは、Avere vFXT for Azure システムを作成し、データを使用する準備をするために必要なすべての手順の全体像を示します。  
---
title: Azure Managed HSM セキュリティ ドメインについて
description: Managed HSM セキュリティ ドメインの概要 (Managed HSM の復旧に必要な一連のコア資格情報)
ms.service: key-vault
ms.subservice: managed-hsm
ms.topic: conceptual
author: amitbapat
ms.author: ambapat
ms.date: 09/15/2020
ms.openlocfilehash: 37e2541d0b53c96fd3f85da31b2c0ce5b68b551a
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/29/2021
ms.locfileid: "90993294"
---
# <a name="about-the-managed-hsm-security-domain"></a>Managed HSM セキュリティ ドメインについて

Managed HSM セキュリティ ドメイン (SD) は、障害が発生した場合に Managed HSM の復旧に必要な一連のコア資格情報です。 セキュリティ ドメインは、Managed HSM ハードウェアとサービス ソフトウェア エンクレーブに生成され、HSM の "所有権" を表します。

すべての Managed HSM に、運用するためのセキュリティ ドメインが必要です。 新しい Managed HSM を要求すると、その Managed HSM はプロビジョニングされますが、セキュリティ ドメインをダウンロードするまでアクティブ化されません。 Managed HSM がプロビジョニングされていてもアクティブ化はされていない状態である場合、アクティブ化するには次の 2 つの方法があります。
- セキュリティ ドメインのダウンロードは既定の方法です。他の Managed HSM と共に使用するか、大規模な障害から復旧するために、セキュリティ ドメインを安全に格納することができます。
- 既に所有している既存のセキュリティ ドメインをアップロードします。これにより、同じセキュリティ ドメインを共有する複数の Managed HSM インスタンスを作成できます。

## <a name="download-your-security-domain"></a>セキュリティ ドメインのダウンロード

Managed HSM がプロビジョニングされていてもアクティブ化はされていない場合、セキュリティ ドメインをダウンロードすると、すべてのハードウェアの完全な損失から復旧するために必要なコア資格情報がキャプチャされます。 セキュリティ ドメインをダウンロードするには、少なくとも 3 つ (最大 10) の RSA キー ペアを作成し、セキュリティ ドメインのダウンロードを要求するときに、これらの公開キーをサービスに送信する必要があります。 また、後でセキュリティ ドメインの暗号化を解除するために必要なキーの最小数 (クォーラム) を指定する必要があります。 Managed HSM は、セキュリティ ドメインを初期化し、[Shamir のシークレット共有アルゴリズム](https://dl.acm.org/doi/10.1145/359168.359176)を使用して、指定した公開キーで暗号化します。 ダウンロードするセキュリティ ドメイン BLOB は、少なくとも秘密キーのクォーラムが使用可能な場合にのみ暗号化を解除できます。セキュリティ ドメインのセキュリティを確保するために、秘密キーを安全な状態に保つ必要があります。 ダウンロードが完了すると、Managed HSM はアクティブ状態になり、使用できるようになります。  

> [!IMPORTANT]
> 完全なディザスター リカバリーを行うには、セキュリティ ドメインと、それを保護するために使用された秘密キーのクォーラム、および完全な HSM バックアップが必要です。 セキュリティ ドメインが失われたか RSA キー (秘密キー) が不足してクォーラムが失われ、Managed HSM の実行中のインスタンスが存在しない場合、ディザスター リカバリーはできません。

## <a name="upload-a-security-domain"></a>セキュリティ ドメインをアップロードする

Managed HSM がプロビジョニングされていてもアクティブ化はされていない場合、セキュリティ ドメインの回復プロセスを開始できます。 Managed HSM は RSA キー ペアを生成し、公開キーを返します。 その後、セキュリティ ドメインを Managed HSM にアップロードできます。 アップロードする前に、クライアント (Azure CLI または PowerShell) に、セキュリティ ドメインのダウンロード時に使用した秘密キーの最小クォーラム数を指定する必要があります。 クライアントはこのクォーラムを使用してセキュリティ ドメインの暗号化を解除し、回復を要求したときにダウンロードした公開キーを使用して再暗号化します。 アップロードが完了すると、Managed HSM はアクティブ状態になります。

## <a name="backup-and-restore-behavior"></a>バックアップと復元動作

バックアップ (完全バックアップまたは単一キー バックアップ) を正常に復元するには、ソース Managed HSM (バックアップが作成された場所) とターゲット Managed HSM (バックアップが復元される場所) が同じセキュリティ ドメインを共有している必要があります。 この方法では、セキュリティ ドメインは、各 Managed HSM の暗号化境界も定義します。

## <a name="next-steps"></a>次のステップ

- [Managed HSM の概要](overview.md)に関するページを読む
- [Azure CLI を使用したマネージド HSM の管理](key-management.md)について学習する
- [Managed HSM のベスト プラクティス](best-practices.md)を確認する

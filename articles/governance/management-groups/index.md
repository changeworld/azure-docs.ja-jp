---
title: Azure 管理グループでリソースを整理する - Azure Governance
description: 管理グループ、そのアクセス許可のしくみ、その使用方法について説明します。
author: rthorn17
ms.assetid: 482191ac-147e-4eb6-9655-c40c13846672
ms.service: governance
ms.date: 04/22/2019
ms.author: rithorn
ms.topic: overview
ms.openlocfilehash: 6ca8351e7294c5a9cdd9f594eb4524d04a27b5c1
ms.sourcegitcommit: f5cc71cbb9969c681a991aa4a39f1120571a6c2e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/26/2019
ms.locfileid: "68516988"
---
# <a name="organize-your-resources-with-azure-management-groups"></a>Azure 管理グループでリソースを整理する

組織に多数のサブスクリプションがある場合は、これらのサブスクリプションのアクセス、ポリシー、およびコンプライアンスを効率的に管理する方法が必要になることがあります。 Azure 管理グループの範囲は、サブスクリプションを上回ります。 "管理グループ" と呼ばれるコンテナーにサブスクリプションを整理して、管理グループに管理条件を適用できます。 管理グループ内のすべてのサブスクリプションは、管理グループに適用された条件を自動的に継承します。 管理グループを使うと、サブスクリプションの種類に関係なく、大きな規模でエンタープライズ レベルの管理を行うことができます。

たとえば、仮想マシン (VM) の作成に使えるリージョンを制限するポリシーを管理グループに適用できます。 そのリージョンでの VM の作成を許可するだけで、その管理グループの下にあるすべての管理グループ、サブスクリプション、リソースに、このポリシーが適用されます。

## <a name="hierarchy-of-management-groups-and-subscriptions"></a>管理グループとサブスクリプションの階層

管理グループとサブスクリプションの柔軟な構造を作成し、リソースを階層に整理して、統一されたポリシーとアクセス管理を適用できます。 次の図は、管理グループを使用した管理のための階層を作成する例を示します。

![管理グループ階層ツリーの例](./media/tree.png)

階層を作成するとポリシーを適用できます。たとえば、"運用" というグループの VM の場所を米国西部リージョンに制限できます。 このポリシーは、その管理グループ下の両方の EA サブスクリプションに継承され、それらのサブスクリプションの下にあるすべての VM に適用されます。 このセキュリティ ポリシーは、ガバナンスを改善するためにリソースまたはサブスクリプションの所有者が変更することができません。

管理グループを使用する別のシナリオでは、ユーザーに複数のサブスクリプションへのアクセスを提供します。 その管理グループの下に複数のサブスクリプションを移動することで、管理グループに対する[ロールベースのアクセス制御](../../role-based-access-control/overview.md) (RBAC) 割り当てを 1 つ作成できます。これにより、すべてのサブスクリプションにそのアクセスが継承されます。
さまざまなサブスクリプションに RBAC を割り当てるスクリプトを作成しなくても、管理グループへ 1 つ割り当てることで、ユーザーは必要なものすべてにアクセスできます。

### <a name="important-facts-about-management-groups"></a>管理グループに関する重要な事実

- 1 つのディレクトリでは、10,000 個の管理グループをサポートできます。
- 管理グループのツリーは、最大 6 レベルの深さをサポートできます。
  - この制限には、ルート レベルまたはサブスクリプション レベルは含まれません。
- 各管理グループとサブスクリプションは、1 つの親のみをサポートできます。
- 各管理グループには、多数の子を含めることができます。
- すべてのサブスクリプションと管理グループは、各ディレクトリの 1 つの階層内に存在します。 「[ルート管理グループに関する重要な事実](#important-facts-about-the-root-management-group)」を参照してください。

## <a name="root-management-group-for-each-directory"></a>各ディレクトリのルート管理グループ

各ディレクトリには、"ルート" 管理グループと呼ばれる 1 つの最上位管理グループがあります。
このルート管理グループは階層に組み込まれており、すべての管理グループとサブスクリプションはルート管理グループにまとめられます。 ルート管理グループにより、グローバル ポリシーと RBAC の割り当てをディレクトリ レベルで適用できます。 [Azure AD 全体管理者は自分自身を昇格させて](../../role-based-access-control/elevate-access-global-admin.md)、最初にこのルート グループのユーザー アクセス管理者ロールにする必要があります。 アクセス権の昇格後、管理者は、任意の RBAC ロールを他のディレクトリ ユーザーまたはグループに割り当てて階層を管理することができます。 管理者の場合は、自分のアカウントをルート管理グループの所有者として割り当てることができます。

### <a name="important-facts-about-the-root-management-group"></a>ルート管理グループに関する重要な事実

- 既定では、ルート管理グループの表示名は **Tenant root group** です。 ID は Azure Active Directory ID です。
- 表示名を変更するには、ルート管理グループの所有者または共同作成者ロールを自分のアカウントに割り当てる必要があります。 名前を変更する手順については、「[管理グループの名前を変更する](manage.md#change-the-name-of-a-management-group)」を参照してください。
- 他の管理グループと異なり、ルート管理グループを移動または削除することはできません。  
- すべてのサブスクリプションと管理グループは、ディレクトリ内の 1 つのルート管理グループにまとめられます。
  - ディレクトリ内のすべてのリソースは、グローバル管理用のルート管理グループにまとめられます。
  - 既定では、新しいサブスクリプションは作成時に自動的にルート管理グループに設定されます。
- すべての Azure ユーザーはルート管理グループを表示できますが、すべてのユーザーがルート管理グループを管理するアクセス権を持つわけではありません。
  - サブスクリプションへのアクセス権を持つすべてのユーザーは、階層内にそのサブスクリプションが存在するコンテキストを参照できます。  
  - 既定では、ルート管理グループには誰もアクセスできません。 Azure AD 全体管理者は、自分自身を昇格させてアクセス権を取得できる唯一のユーザーです。  アクセス権を取得した全体管理者は、他のユーザーが管理できるように任意の RBAC ロールを割り当てることができます。  

> [!IMPORTANT]
> ルート管理グループでのユーザーのアクセス権またはポリシーの割り当ては、**ディレクトリ内のすべてのリソースに適用されます**。
> そのため、すべてのユーザーは、このスコープで定義されている項目を所有する必要性を評価する必要があります。
> ユーザーアクセスやポリシーの割り当ては、このスコープでのみ「必須」である必要があります。  

## <a name="initial-setup-of-management-groups"></a>管理グループの初期セットアップ

ユーザーが管理グループの使用を開始する際には、初期セットアップ プロセスが発生します。 最初の手順として、ディレクトリでルート管理グループが作成されます。 このグループが作成されると、ディレクトリ内に存在するすべての既存のサブスクリプションがルート管理グループの子になります。 このプロセスが実行される理由は、ディレクトリ内に管理グループ階層が 1 つだけ存在するようにするためです。 ディレクトリ内に 1 つの階層が存在することにより、ディレクトリ内の他のユーザーがバイパスできないグローバル アクセス権とポリシーを管理ユーザーが適用できるようになります。 ルートに割り当てられている内容はすべて、階層全体に適用されます。これには、この Azure AD テナント内におけるすべての管理グループ、サブスクリプション、リソース グループ、リソースが含まれます。

## <a name="trouble-seeing-all-subscriptions"></a>サブスクリプションの表示の問題

2018 年 6 月 25 日より前のプレビューで初期に管理グループの使用を開始した数個のディレクトリでは、一部のサブスクリプションが階層内にないという問題が発生していました。 すべてのサブスクリプションを階層に含めるプロセスは、ディレクトリ内のルート管理グループに対してロールまたはポリシーの割り当てが行われた後に導入されました。 

### <a name="how-to-resolve-the-issue"></a>この問題を解決する方法

この問題を解決するためのオプションは 2 つあります。

1. ルート管理グループからすべてのロールとポリシーの割り当てを削除します
   1. ルート管理グループからすべてのポリシーとロールの割り当てを削除することによって、一夜開けたときすべてのサブスクリプションが階層にバックフィルされています。  このプロセスの目的は、テナントのサブスクリプションに誤ってアクセスやポリシーの割り当てが行われないようにすることです。
   1. サービスに影響を与えずにこのプロセスを実行する最善の方法として、ルート管理グループの 1 つ下のレベルのロールまたはポリシー割り当てを適用します。 次に、ルート スコープからすべての割り当てを削除します。
1. API を直接呼び出して、バックフィル プロセスを開始します
   1. ディレクトリ内の任意のユーザーは、*TenantBackfillStatusRequest* API または *StartTenantBackfillRequest* API を呼び出すことができます。 StartTenantBackfillRequest API が呼び出されると、すべてのサブスクリプションを階層に移動する初期セットアップ プロセスが開始されます。 このプロセスでは、すべての新しいサブスクリプションが強制的にルート管理グループの子になります。 このプロセスを実行するには、ルート レベルで割り当てを変更する必要があります。 この API を呼び出すことで、ルートに対するポリシーまたはアクセスの割り当てをすべてのサブスクリプションに適用できることを示します。

このバックフィル プロセスについて質問がある場合は、managementgroups@microsoft.com までお問い合わせください。  
  
## <a name="management-group-access"></a>管理グループ アクセス

Azure 管理グループは、すべてのリソース アクセスとロール定義について、[Azure のロールベースのアクセス制御 (RBAC)](../../role-based-access-control/overview.md) をサポートします。
これらのアクセス許可は、階層内に存在する子リソースに継承されます。 管理グループには任意の組み込み RBAC ロールを割り当てることができます。ロールは階層を継承し、各リソースに割り当てられます。
たとえば、VM 共同作成者の RBAC ロールは、管理グループに割り当てることができます。 このロールには、管理グループに対するアクションはありませんが、その管理グループに属するすべての VM に継承されます。

次の図に、管理グループのロールとサポートされているアクションの一覧を示します。

| RBAC ロール名             | Create | 名前の変更 | 移動** | 削除 | アクセス権の割り当て | ポリシーの割り当て | 読み取り  |
|:-------------------------- |:------:|:------:|:------:|:------:|:-------------:| :------------:|:-----:|
|Owner                       | X      | X      | X      | X      | X             | X             | X     |
|Contributor                 | X      | X      | X      | X      |               |               | X     |
|MG Contributor*             | X      | X      | X      | X      |               |               | X     |
|Reader                      |        |        |        |        |               |               | X     |
|MG Reader*                  |        |        |        |        |               |               | X     |
|リソース ポリシー共同作成者 |        |        |        |        |               | X             |       |
|User Access Administrator   |        |        |        |        | X             | X             |       |

*: MG Contributor と MG Reader は、管理グループのスコープのみでのこれらのアクションの実行をユーザーに許可します。  
**: ルート管理グループに対するロールの割り当ては、それとの間でのサブスクリプションまたは管理グループの移動に必要ありません。  階層内の項目の移動について詳しくは、「[Manage your resources with management groups (管理グループを使用してリソースを管理する)](manage.md)」を参照してください。

### <a name="custom-rbac-role-definition-and-assignment"></a>カスタム RBAC ロールの定義と割り当て

現時点では、管理グループのカスタム RBAC ロールはサポートされていません。 この項目の状態については、[管理グループ フィードバック フォーラム](https://aka.ms/mgfeedback)を参照してください。

## <a name="audit-management-groups-using-activity-logs"></a>アクティビティ ログを使用した監査管理グループ

管理グループは、[Azure アクティビティ ログ](../../azure-monitor/platform/activity-logs-overview.md)内でサポートされます。 他の Azure リソースと同じ一元的な場所で、管理グループに発生するすべてのイベントを検索できます。  たとえば、特定の管理グループに対して行われた、ロールの割り当てまたはポリシーの割り当ての変更を、すべて確認できます。

![管理グループが含まれているアクティビティ ログ](media/al-mg.png)

Azure portal の外部で管理グループに対するクエリを使用する場合、管理グループのターゲット スコープは、 **"/providers/Microsoft.Management/managementGroups/{yourMgID}"** のようになります。

## <a name="next-steps"></a>次の手順

管理グループについて詳しくは、以下をご覧ください。

- [管理グループを作成して Azure リソースを整理する](create.md)
- [管理グループを変更、削除、または管理する方法](manage.md)
- [Azure PowerShell Resources モジュールで管理グループを確認する](/powershell/module/az.resources#resources)
- [REST API で管理グループを確認する](/rest/api/resources/managementgroups)
- [Azure CLI で管理グループを確認する](/cli/azure/account/management-group)
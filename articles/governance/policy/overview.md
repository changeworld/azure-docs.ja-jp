---
title: Azure Policy の概要
description: Azure Policy は Azure のサービスであり、Azure 環境でのポリシー定義の作成、割り当て、管理に使うことができます。
services: azure-policy
author: DCtheGeek
ms.author: dacoulte
ms.date: 12/06/2018
ms.topic: overview
ms.service: azure-policy
manager: carmonm
ms.openlocfilehash: 11384d1bbffb675bd322469d129464f58a48bb6b
ms.sourcegitcommit: eb9dd01614b8e95ebc06139c72fa563b25dc6d13
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/12/2018
ms.locfileid: "53311833"
---
# <a name="what-is-azure-policy"></a>Azure Policy とは

ガバナンスは、組織が IT の効率的かつ効果的な使用によって、その組織のゴールを達成できることを検証します。 それは、ビジネスのゴールと IT プロジェクトの間の関係を明確にすることによってこのニーズを満たします。

解決できそうもないほど多くの IT の問題を企業が抱えている場合は、
優れた IT ガバナンスには、イニシアチブの計画と、問題の管理と防止に役立つ戦略的レベルの優先順位の設定が含まれます。 この戦略的なニーズには、Azure Policy を利用できます。

Azure Policy は、ポリシーの作成、割り当て、管理に使用する Azure のサービスです。 これらのポリシーは、リソースにさまざまなルールと効果を適用して、それらのリソースが会社の標準とサービス レベル アグリーメントに準拠した状態に保たれるようにします。 Azure Policy では、割り当て済みのポリシーでリソースの非準拠を評価することによって、このニーズが満たされます。 たとえば、環境内で特定の SKU サイズの仮想マシンのみを許可するポリシーを作成できます。 このポリシーが実装された後は、新規および既存のリソースのコンプライアンス評価されます。 適切な種類のポリシーにより、既存リソースのコンプライアンスを実現できます。 Azure Policy でポリシーを作成して実装する方法については、このドキュメントの後のほうで詳しく説明します。

> [!IMPORTANT]
> Azure Policy のコンプライアンス評価が、価格レベルに関係なくすべての割り当てに対して提供されるようになりました。 割り当てにコンプライアンス データが表示されない場合は、サブスクリプションが Microsoft.PolicyInsights リソース プロバイダーに登録されていることを確認してください。

## <a name="how-is-it-different-from-rbac"></a>RBAC との違いは何か。

Policy とロールベースのアクセス制御 (RBAC) には、いくつかの主要な違いがあります。 RBAC は、さまざまなスコープでのユーザーの操作に焦点を当てています。 リソース グループの共同作成者ロールに追加されると、そのリソース グループを変更できるようになります。 ポリシーは、既存のリソースについて、デプロイ中のプロパティに焦点を当てます。 ポリシーでは、リソースの種類や場所などのプロパティが制御されます。 RBAC とは異なり、ポリシーは既定で許可し、明示的に否認するシステムです。

### <a name="rbac-permissions-in-azure-policy"></a>Azure Policy における RBAC アクセス許可

Azure Policy は、次の 2 つのリソース プロバイダーにおいて、いくつかのアクセス許可 (操作) を有しています。

- [Microsoft.Authorization](../../role-based-access-control/resource-provider-operations.md#microsoftauthorization)
- [Microsoft.PolicyInsights](../../role-based-access-control/resource-provider-operations.md#microsoftpolicyinsights)

Azure Policy のリソースに対するアクセス許可は、さまざまな組み込みロールによって与えられます。 **リソース ポリシーの共同作成者 (プレビュー)** ロールには Policy のほとんどの操作が含まれます。 **所有者**は完全な権限を持っています。 **共同作成者**と**閲覧者** はどちらも、すべての読み取り Policy 操作を使用できますが、**共同作成者**は修復処理をトリガーすることもできます。

いずれの組み込みロールにも必要なアクセス許可がない場合は、[カスタム ロール](../../role-based-access-control/custom-roles.md)を作成してください。

## <a name="policy-definition"></a>ポリシー定義

Azure Policy でポリシーを作成して実装する手順は、ポリシー定義の作成から始まります。 すべてのポリシー定義に、ポリシーが適用される条件があります。 また、条件が満たされた場合に実現される効果も定義されています。

Azure Policy には、既定で使うことができる組み込みポリシーがいくつかあります。 例: 

- **SQL Server バージョン 12.0 を必須とする**:すべての SQL Server でバージョン 12.0 が使われていることを検証します。 その効果として、これらの条件を満たしていないすべてのサーバーが拒否されます。
- **許可されているストレージ アカウントの SKU**:展開されているストレージ アカウントが SKU サイズの設定内であるかどうかを判断します。 その効果として、定義されている SKU サイズの設定に準拠していないすべてのストレージ アカウントが拒否されます。
- **使用できるリソースの種類**:展開できるリソースの種類を定義します。 その効果として、この定義済みリストの一部ではないすべてのリソースが拒否されます。
- **許可されている場所**:新しいリソースに使用できる場所を制限します。 その効果は、geo コンプライアンス要件を強制するために使用されます。
- **許可されている仮想マシン SKU**:展開できる仮想マシンの SKU の設定を指定します。
- **タグとその既定値の適用**:展開要求によって指定されていない場合に、必要なタグとその既定値を適用します。
- **タグとその値の適用**:必要なタグとその値をリソースに適用します。
- **許可されていないリソースの種類**:リストのリソースの種類が展開されないようにします。

これらのポリシー定義 (組み込み定義とカスタム定義の両方) を実装するには、割り当てを行う必要があります。 こうしたポリシーを割り当てるには、Azure Portal、PowerShell、または Azure CLI を使用します。

ポリシーの割り当てやポリシーの更新など、いくつかの異なるアクションでポリシーの評価が行われます。 完全な一覧については、「[Policy evaluation triggers](./how-to/get-compliance-data.md#evaluation-triggers)」(ポリシー評価のトリガー) をご覧ください。

ポリシー定義の構造の詳細については、[ポリシー定義の構造](./concepts/definition-structure.md)に関するページを参照してください。

## <a name="policy-assignment"></a>ポリシー割り当て

ポリシー割り当ては、特定のスコープ内で実行するように割り当てられたポリシー定義です。 このスコープの範囲は、[管理グループ](../management-groups/overview.md)からリソース グループまでです。 "*スコープ*" という用語は、ポリシー定義が割り当てられる、すべてのリソース グループ、サブスクリプション、または管理グループのことを指します。 ポリシー割り当ては、すべての子リソースによって継承されます。 この設計は、リソース グループに適用されたポリシーは、そのリソース グループ内のリソースにも適用されることを意味します。 ただし、サブスコープを、ポリシーの割り当てから除外できます。

たとえば、サブスクリプション スコープで、ネットワーク リソースの作成を禁止するポリシーを割り当てることができます。 ネットワーク インフラストラクチャを対象としたリソース グループを、そのサブスクリプション内で除外できます。 その後、このネットワーク リソース グループへのアクセスは、信頼できるユーザーに許可し、そのユーザーがネットワーク リソースを作成できるようにします。

別の例として、リソースの種類のホワイトリスト ポリシーを管理グループ レベルで割り当てたいとしましょう。 そのうえで、より制限の緩やかな (より多くのリソースの種類を許可する) ポリシーを子の管理グループまたはサブスクリプションに直接割り当てます。 しかし、この例はうまくいきません。ポリシーは、明示的拒否のシステムであるためです。 代わりに、管理グループ レベルのポリシーの割り当てから、子の管理グループまたはサブスクリプションを除外する必要があります。 そのうえで、より制限の緩やかなポリシーを子の管理グループまたはサブスクリプション レベルで割り当てます。 いずれかのポリシーでリソースが拒否される場合、拒否ポリシーに変更を加えることが、そのリソースを許可する唯一の方法となります。

ポータルを使用したポリシー定義と割り当ての設定の詳細については、「[ポリシーの割り当てを作成し、Azure 環境内の非対応リソースを特定する](assign-policy-portal.md)」を参照してください。 [PowerShell](assign-policy-powershell.md)と[Azure CLI](assign-policy-azurecli.md) の場合の手順も利用することができます。

## <a name="policy-parameters"></a>ポリシー パラメーター

ポリシー パラメーターは、作成する必要があるポリシー定義の数を減らしてポリシーの管理を簡素化するのに役立ちます。 ポリシー定義を作成するときにパラメーターを定義して、ポリシー定義を汎用化できます。 その後、そのポリシー定義を、さまざまなシナリオで再利用できます。 これを行うには、ポリシー定義を割り当てるときに、さまざまな値を渡します。 たとえば、サブスクリプションに対して一連の場所を指定します。

パラメーターは、ポリシー定義を作成するときに定義します。 パラメーターを定義するときは、名前と、必要に応じて値を指定します。 たとえば、"*場所*" というポリシーのパラメーターを定義できます。 その後、ポリシーを割り当てるときに、*EastUS*、*WestUS* など、さまざまな値を指定できます。

ポリシー パラメーターについて詳しくは、[定義の構造でのパラメーター](./concepts/definition-structure.md#parameters)に関する項目をご覧ください。

## <a name="initiative-definition"></a>イニシアチブ定義

イニシアチブ定義は、単一の包括的なゴールを達成することを目的として調整されたポリシー定義のコレクションです。 イニシアチブ定義により、ポリシー定義の管理と割り当てが簡素化されます。 簡素化するには、一連のポリシーを 1 つのアイテムとしてグループ化します。 たとえば、Azure Security Center で利用可能なすべてのセキュリティ推奨事項を監視することを目的とする、"**Azure Security Center での監視を有効にする**" というタイトルのイニシアチブを作成できます。

このイニシアチブでは、次のようなポリシー定義を作成します。

- **暗号化されていない SQL Database を Security Center で監視する** – 暗号化されていない SQL データベースとサーバーを監視します。
- **OS の脆弱性を Security Center で監視する** – 構成されているベースラインを満たしていないサーバーを監視します。
- **不足している Endpoint Protection を Security Center で監視する** – Endpoint Protection エージェントがインストールされていないサーバーを監視します。

## <a name="initiative-assignment"></a>イニシアチブ割り当て

ポリシー割り当てと同様に、イニシアチブ割り当ては特定のスコープに割り当てられたイニシアチブの定義です。 イニシアチブを割り当てると、スコープごとに複数のイニシアチブを割り当てる必要性が低下します。 このスコープは、管理グループからリソース グループの範囲になる可能性があります。

各イニシアチブは、異なるスコープに割り当てることができます。 1 つのイニシアチブを、**subscriptionA** と **subscriptionB** の両方に割り当てることができます。

## <a name="initiative-parameters"></a>イニシアチブ パラメーター

ポリシー パラメーターと同様に、イニシアチブ パラメーターは冗長性を減らすことでイニシアチブの管理を簡素化できます。 イニシアチブ パラメーターは、イニシアチブ内のポリシー定義によって使われるパラメーターです。

たとえば、イニシアチブ定義 **initiativeC** にポリシー定義 **policyA** と **policyB** が含まれており、それぞれのポリシー定義が異なる種類のパラメーターを予期しているというシナリオについて考えてみましょう。

| ポリシー | パラメーターの名前 |パラメーターの型  |Note |
|---|---|---|---|
| policyA | allowedLocations | array  |このパラメーターは、パラメーターの型が配列として定義されているため、文字列のリストが値として必要です。 |
| policyB | allowedSingleLocation |string |このパラメーターは、パラメーターの型が文字列として定義されているため、1 つの単語が値として必要です。 |

このシナリオで **initiativeC** のイニシアチブ パラメーターを定義する場合、3 つのオプションがあります。

- このイニシアチブ内でポリシー定義のパラメーターを使用します。この例では、*allowedLocations* と *allowedSingleLocation* が **initiativeC** のイニシアチブ パラメーターになります。
- このイニシアチブ定義内でポリシー定義のパラメーターに値を指定します。 この例では、**policyA のパラメーター – allowedLocations** および **policyB のパラメーター – allowedSingleLocation** に場所のリストを提供できます。 このイニシアチブを割り当てるときに値を指定することもできます。
- このイニシアチブを割り当てるときに使うことができる "*値*" オプションのリストを指定します。 このイニシアチブを割り当てるときは、イニシアチブ内のポリシー定義から継承したパラメーターは、この指定されたリストの値だけを持つことができます。

イニシアチブ定義で値のオプションを作成すると、イニシアチブの割り当てで別の値を入力することは、リストの一部ではないためできません。

## <a name="maximum-count-of-policy-objects"></a>ポリシー オブジェクトの最大数

[!INCLUDE [policy-limits](../../../includes/azure-policy-limits.md)]

## <a name="recommendations-for-managing-policies"></a>ポリシー管理に関する推奨事項

留意すべきいくつかの指摘とヒントを次に示します。

- 最初は拒否効果ではなく監査効果を使用して、環境内のリソースに対するポリシー定義の影響を追跡します。 アプリケーションを自動スケーリングするスクリプトが既にある場合、拒否効果を設定すると、このような自動化タスクが妨げられる場合があります。

- 定義と割り当てを作成するときは、組織階層を考慮します。 管理グループやサブスクリプション レベルのような高いレベルで定義を作成することをお勧めします。 それから、次の子レベルで割り当てを作成します。 管理グループで定義を作成した場合、その管理グループ内にあるサブスクリプションまたはリソース グループまで割り当ての対象にできます。

- 1 つのポリシー定義の場合でも、イニシアチブ定義を作成して割り当てることをお勧めします。
たとえば、ポリシー定義 *policyDefA* をイニシアチブ定義 *initiativeDefC* の下に作成します。 後で *policyDefA* に似た目標の別のポリシー定義 *policyDefB* を作成する場合、それを *initiativeDefC* の下に追加して、まとめて追跡できます。

- イニシアチブ割り当てを作成してあると、そのイニシアチブに追加されたポリシー定義もそのイニシアチブ割り当ての一部になります。

- イニシアチブ割り当てが評価されたときは、イニシアチブ内のすべてのポリシーも評価されます。 ポリシーを個別に評価する必要がある場合は、ポリシーをイニシアティブに含めないことをお勧めします。

## <a name="video-overview"></a>ビデオの概要

次の Azure Policy の概要は、ビルド 2018 に基づいています。 スライドまたはビデオのダウンロードについては、チャンネル 9 の「[Govern your Azure environment through Azure Policy](https://channel9.msdn.com/events/Build/2018/THR2030)」(Azure Policy による Azure 環境の管理) を参照してください。

> [!VIDEO https://www.youtube.com/embed/dxMaYF2GB7o]

## <a name="next-steps"></a>次の手順

これで、Azure Policy の概要といくつかの主要な概念に関する説明は終了です。推奨される次の手順は以下のとおりです。

- [ポータルを使用してポリシー定義を割り当てる](assign-policy-portal.md)
- [Azure CLI を使用してポリシー定義を割り当てる](assign-policy-azurecli.md)
- [PowerShell を使用してポリシー定義を割り当てる](assign-policy-powershell.md)
- 「[Azure 管理グループのリソースを整理する](..//management-groups/overview.md)」で、管理グループとは何かを確認します。
- チャンネル 9 の「[Govern your Azure environment through Azure Policy](https://channel9.msdn.com/events/Build/2018/THR2030)」(Azure Policy による Azure 環境の管理) を視聴する
---
title: SQL の脆弱性評価 - Azure SQL Database| Microsoft Docs
description: SQL データベースで SQL の脆弱性評価を構成する方法と、評価レポートの内容について説明します。
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: ronitr
ms.author: ronitr
ms.reviewer: vanto, carlrab
ms.date: 03/12/2019
ms.openlocfilehash: a65539f1ec6f4a5cab13d35b75f98c428558f884
ms.sourcegitcommit: 7c4de3e22b8e9d71c579f31cbfcea9f22d43721a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/26/2019
ms.locfileid: "68566136"
---
# <a name="sql-vulnerability-assessment-service-helps-you-identify-database-vulnerabilities"></a>SQL の脆弱性評価サービスは、データベースの脆弱性を特定するのに役に立ちます

SQL の脆弱性評価では、データベースの潜在的な脆弱性を検出、追跡、修復できるサービスを簡単に構成できます。 このツールを使って、データベースのセキュリティを事前に強化できます。

脆弱性評価は、高度な SQL セキュリティ機能の統合パッケージである、[Advanced Data Security](sql-database-advanced-data-security.md) (ADS) オファリングの一部です。 脆弱性評価は、SQL ADS ポータルを使って一元的にアクセスおよび管理できます。

> [!NOTE]
> 脆弱性評価は、Azure SQL Database、Azure SQL Managed Instance、Azure SQL Data Warehouse でサポートされています。 わかりやすくするため、この記事では、マネージド データベース サービスを SQL Database と呼んでいます。

## <a name="the-vulnerability-assessment-service"></a>脆弱性評価サービス

SQL 脆弱性評価 (VA) は、セキュリティの状態を表示するサービスであり、セキュリティの問題を解決して、データベースのセキュリティを強化するために実行可能な手順が含まれます。 以下のことに役立ちます。  

- データベース スキャン レポートが必要なコンプライアンス要件を満たします。  
- データのプライバシー基準を満たします。  
- 変更の追跡が困難な動的データベース環境を監視します。  

脆弱性評価は、Azure SQL Database サービスに組み込まれているスキャン サービスです。 このサービスでは、構成の不備、過剰な権限、保護されていない機密データなどセキュリティの脆弱性にフラグを設定し、ベスト プラクティスからの逸脱を明示する、ルールのナレッジ ベースが利用されます。 ルールは Microsoft のベスト プラクティスに基づき、データベースとその貴重なデータに最も大きなリスクとなるセキュリティの問題に注目します。 これらのルールは、データベース レベルの問題だけでなく、サーバーのファイアウォール設定やサーバー レベルの権限など、サーバー レベルのセキュリティ問題もカバーしたものとなっています。 また、これらの規則は、さまざまな規制機関によるコンプライアンス基準を満たすための多くの要件も表しています。  

スキャンの結果では、各問題を解決するために実行可能な手順が示され、該当する場合はカスタマイズされた修復スクリプトが提供されます。 アクセス許可の構成、機能の構成、データベースの設定の許容されるベースラインを設定することで、環境に合わせて評価レポートをカスタマイズできます。

## <a name="implementing-vulnerability-assessment"></a>脆弱性評価の実装

次の手順では、SQL Database に VA を実装します。  

### <a name="1-run-a-scan"></a>1.スキャンを実行する  

まずは、[Azure SQL Database] ウィンドウの [セキュリティ] で、 **[Advanced Data Security]** に移動します。 クリックして Advanced Data Security を有効にし、 **[Select Storage]\(記憶域の選択\)** をクリックするか、 **[脆弱性評価]** カードをクリックします (これにより、SQL サーバー全体の脆弱性評価設定カードが自動的に開きます)。

最初にストレージ アカウントを構成します。この場所に、サーバー上のすべてのデータベースに対するスキャン結果が格納されます。 ストレージ アカウントについて詳しくは、「[Azure ストレージ アカウントについて](../storage/common/storage-create-storage-account.md)」をご覧ください。 ストレージを構成した後、 **[スキャン]** をクリックしてデータベースの脆弱性をスキャンします。
  
![データベースのスキャン](./media/sql-vulnerability-assessment/pp_va_initialize.png)  

  > [!NOTE]
  > スキャンは軽量であり安全です。 実行に要する時間は数秒で、完全に読み取りだけです。 データベースを変更することはありません。  

### <a name="2-view-the-report"></a>2.レポートを表示する

スキャンが完了すると、スキャン レポートが Azure Portal に自動的に表示されます。 レポートでは、セキュリティの状態の概要、発見された問題の数、それぞれの重大度が示されます。 結果には、ベスト プラクティスからの逸脱に関する警告や、セキュリティ関連設定のスナップショット (データベース プリンシパルとロール、およびそれらに関連付けられている権限など) が含まれます。スキャン レポートにはまた、データベース内で検出された機密データのマップや、[Data Discovery & Classification](sql-database-data-discovery-and-classification.md) を使ったデータ分類に関する推奨事項も示されます。

![レポートを表示する](./media/sql-vulnerability-assessment/pp_main_getstarted.png)  

### <a name="3-analyze-the-results-and-resolve-issues"></a>手順 3.結果を分析して問題を解決する

結果を確認し、レポートで示されている結果のうち環境で実際にセキュリティの問題となるものを判断します。 問題となった各結果をドリルダウンして、問題の影響と、各セキュリティ チェックが不合格になった理由を理解します。 レポートで提供される実行可能な修復の情報を使って、問題を解決します。  

![レポートを出力する](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4.ベースラインを設定する

評価の結果を確認しながら、環境において許容される*ベースライン*として特定の結果をマークできます。 ベースラインは、本質的には、結果を報告する方法のカスタマイズです。 以降のスキャンで、ベースラインと一致する結果は合格と見なされます。 ベースラインとなるセキュリティ状態を確立した後、VA ではベースラインからの逸脱のみが報告され、ユーザーは関連する問題に集中することができます。  

![ベースラインを設定する](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)  

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5.新しいスキャンを実行してカスタマイズした追跡レポートを確認する

**規則のベースライン**の設定が済んだら、新しいスキャンを実行して、カスタマイズしたレポートを表示します。 VA は、ユーザーが承認したベースライン状態から逸脱したセキュリティの問題のみを報告するようになります。

![カスタマイズしたレポートを表示する](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)  

脆弱性評価を使って、データベースが常に高レベルのセキュリティを維持し、組織のポリシーが満たされていることを、監視できるようになりました。 コンプライアンス レポートが必要な場合、VA レポートはコンプライアンス プロセスを容易にするのに役立ちます。  

### <a name="6-set-up-periodic-recurring-scans"></a>6.定期的な反復スキャンの設定

脆弱性評価設定に移動して、 **[定期的な反復スキャン]** を有効にします。 これにより、データベースの脆弱性評価スキャンが毎週 1 回自動的に実行されるようになります。 スキャン結果の概要は、指定した電子メール アドレスに送信されます。

![カスタマイズしたレポートを表示する](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7.評価レポートのエクスポート

**[スキャン結果のエクスポート]** をクリックして、スキャン結果の Excel レポート (ダウンロード可能なファイル) を作成します。 このレポートの概要タブには、評価の概要が表示されます (失敗したすべてのチェックなど)。 また、 **[結果]** タブには、詳細なスキャン結果がすべて表示されます (実行されたすべてのチェックや、各チェックの結果の詳細など)。

### <a name="8-view-scan-history"></a>8.スキャン履歴の表示

VA ウィンドウの **[スキャンの履歴]** をクリックして、このデータベースで以前に実行されたすべてのスキャンの履歴を表示します。 一覧から特定のスキャンを選択すると、そのスキャンの詳しい結果が表示されます。

脆弱性評価を使って、データベースが常に高レベルのセキュリティを維持し、組織のポリシーが満たされていることを、監視できるようになりました。 コンプライアンス レポートが必要な場合、VA レポートはコンプライアンス プロセスを容易にするのに役立ちます。

## <a name="manage-vulnerability-assessments-using-azure-powershell"></a>Azure PowerShell を使用して脆弱性評価を管理する

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> PowerShell Azure Resource Manager モジュールは Azure SQL Database で引き続きサポートされますが、今後の開発はすべて Az.Sql モジュールを対象に行われます。 これらのコマンドレットについては、「[AzureRM.Sql](https://docs.microsoft.com/powershell/module/AzureRM.Sql/)」を参照してください。 Az モジュールと AzureRm モジュールのコマンドの引数は実質的に同じです。

Azure PowerShell コマンドレットを使用して、脆弱性評価をプログラムで管理できます。 サポートされているコマンドレットは次のとおりです。

- [Update-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting)

  データベースの脆弱性評価の設定を更新します
- [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting)

  データベースの脆弱性評価の設定を返します
- [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting)

  データベースの脆弱性評価の設定をクリアします
- [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  脆弱性評価規則のベースラインを設定します。
- [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  特定の規則の脆弱性評価規則のベースラインを取得します。
- [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  脆弱性評価規則のベースラインをクリアします。 ベースラインを設定した後、このコマンドレットを使用してそれをクリアします。
- [Start-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan)

  脆弱性評価スキャンの開始をトリガーします
- [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord)

   特定のデータベースに関連付けられているすべての脆弱性評価スキャン レコードを取得します。
- [Convert-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan)

  脆弱性評価のスキャン結果を Excel ファイルに変換します

スクリプトの例については、[Azure SQL の脆弱性評価の PowerShell のサポート](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/)に関する記事を参照してください。

## <a name="next-steps"></a>次の手順  

- [Advanced Data Security](sql-database-advanced-data-security.md) についてさらに詳しく学習する
- [データの検出と分類](sql-database-data-discovery-and-classification.md)についてさらに詳しく学習する

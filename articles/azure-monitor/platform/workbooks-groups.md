---
title: Azure Monitor ブック グループ
description: Azure Monitor ブックでグループを使用する方法。
services: azure-monitor
author: lgayhardt
manager: carmonm
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.topic: conceptual
ms.date: 05/06/2020
ms.author: lagayhar
ms.openlocfilehash: b6377cdcdb5816426eba62fdbef79eeb42659dcc
ms.sourcegitcommit: b396c674aa8f66597fa2dd6d6ed200dd7f409915
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2020
ms.locfileid: "82891788"
---
# <a name="how-to-use-groups-in-workbooks"></a>ブックでグループを使用する方法

ブック内のグループ項目を使用すると、一連のステップを 1 つのブックに論理的にグループ化できます。

ブック内のグループは、次のようなことに役立ちます。

- [レイアウト]
  - 項目を垂直方向に整理する必要があるシナリオでは、個々の項目すべてにパーセンテージで幅を設定するのではなく、項目をすべて積み重ねるグループを作成して、グループのスタイルがパーセンテージの幅になるように設定することができます。
- 表示
  - 複数の項目をまとめて表示または非表示にする必要があるシナリオでは、個々の項目に表示設定を設定するのではなく、項目のグループ全体の表示を設定できます。 これは、タブの内容としてグループを使用でき、選択したタブで設定されたパラメーターに基づいてグループ全体を非表示または表示できるため、タブを使用するテンプレートで役に立ちます。
- パフォーマンス
  - 多数のセクションやタブを含む非常に大きなテンプレートがある場合は、各セクションを独自のサブテンプレートに変換し、グループを使用して最上位のテンプレート内にすべてのサブテンプレートを読み込むことができます。 サブテンプレートの内容は、ユーザーがこれらのグループを表示するまで読み込まれたり実行されたりすることはありません。 詳細については、「[大規模なテンプレートを多数のテンプレートに分割する方法](#how-to-split-a-large-template-into-many-templates)」を参照してください。

## <a name="using-groups"></a>グループの使用

グループをブックに追加するには、 *[追加]* 、 *[グループの追加]*  の順に選択します。

![[追加]、[グループ] の順に選択。](./media/workbooks-groups/add-group.png)

次に示すのは、読み取りモードのグループのスクリーンショットです。中にはテキスト項目とクエリ項目の 2 つの項目があります。  

![読み取りモードのグループ。](./media/workbooks-groups/groups-view.png)

ブックを編集するときに、これらの 2 つの項目が実際にはグループ項目内にあることを確認できます。

![編集モードのグループ。 ](./media/workbooks-groups/groups-edit.png)

上のスクリーンショットでは、グループは編集モードになっており、(破線の領域内に) 2 つの項目が含まれていることを示しています。 各ステップは、互いに独立していて、編集モードまたは読み取りモードにすることができます。 たとえば、テキスト ステップは編集モードで、クエリ ステップは読み取りモードにすることができます。

## <a name="scoping"></a>Scoping

現在、グループは、ブック内の新しいスコープとして扱われます。 グループ内に作成されたすべてのパラメーターは、そのグループ内でのみ表示されます。 これは、マージにも当てはまります。グループ内または親レベルでのみデータを表示できます。

## <a name="group-types"></a>グループの種類

ブック グループ項目を使用すると、項目のグループをブックに追加できます。 ブックの作成者が、グループの種類を指定します。 次の 2 種類のグループがあります。

- 編集可能
  - ブックでグループを使用すると、グループ内の項目の内容を追加、削除、または編集できます。 これは、レイアウトと可視性の目的で最も一般的に使用されます。
- テンプレートから
  - ブック内のグループは、その ID によって別のテンプレートの内容から読み込まれます。 実行時に、そのテンプレートの内容が読み込まれ、ブックにマージされます。 編集モードでは、グループの内容を変更することはできません。これは、次回項目が読み込まれるときにテンプレートから再度読み込まれるためです。  

## <a name="load-types"></a>読み込みの種類

グループの内容を読み込むには、いくつかの方法があります。 ブックの作成者は、グループの内容を読み込むタイミングと方法を指定します。

### <a name="lazy-the-default"></a>遅延 (既定値)

グループは項目が表示されている場合にのみ読み込まれます。 これにより、グループをタブ項目で使用できるようになります。 タブが選択されていない場合、グループは表示されないため、内容は読み込まれません。

テンプレートから作成されたグループの場合、テンプレートの内容は取得されず、グループが表示されるまでグループ内の項目は作成されません。 コンテンツの取得中、グループ全体の進行状況スピナーがユーザーに表示されます。

### <a name="explicit"></a>明示

このモードでは、グループが表示される場所にボタンが表示され、ユーザーが内容を読み込むためにボタンを明示的にクリックするまで内容は取得または作成されません。 これは、内容の計算に費用がかかる場合や使用頻度が低いシナリオに便利です。 作成者は、ボタンに表示するテキストを指定できます。

次に示すのは、[さらに読み込む] ボタンが構成されている明示的な読み込み設定のスクリーンショットです。

![明示的な読み込みの設定](./media/workbooks-groups/groups-explicitly-loaded.png)

ブックに読み込まれる前のグループ:

![ブックに読み込まれる前の明示的なグループ](./media/workbooks-groups/groups-explicitly-loaded-before.png)

ブックに読み込まれた後のグループ:

![ブックに読み込まれた後の明示的なグループ](./media/workbooks-groups/groups-explicitly-loaded-after.png)

### <a name="always"></a>Always (常に)

このモードでは、ブックが読み込まれるとすぐにグループの内容が読み込まれ、作成されます。 これは、レイアウト目的でのみグループを使用し、コンテンツを常に表示する場合に最もよく使用されます。

## <a name="using-templates-inside-a-group"></a>グループ内でのテンプレートの使用

グループがテンプレートから読み込まれるように構成されている場合、その内容は既定で遅延読み込みされ、グループが表示されるときにのみ読み込まれます。

テンプレートがグループに読み込まれると、ブックは、読み込まれるテンプレートで宣言されているすべてのパラメーターを、グループ内に既に存在するパラメーターとマージしようとします。 同じ名前のワークブックに既に存在するパラメーターは、読み込まれるテンプレートからマージされます。 パラメーター ステップのすべてのパラメーターがマージされると、パラメーター ステップ全体が消えます。

### <a name="example-1-all-parameters-have-identical-names"></a>例 1: すべてのパラメーターの名前が同一

最上位に 2 つのパラメーターを持つテンプレートがあるとします。

- `TimeRange` - 時間の範囲パラメーター。
- `Filter` - テキスト パラメーター。

![パラメーター項目の編集: "最上位レベルのパラメーター"](./media/workbooks-groups/groups-top-level-params.png)

次に、グループ項目により独自の 2 つのパラメーターと 1 つのテキスト ステップを持つ 2 つ目のテンプレートが読み込まれます。パラメーターには同じ名前が付けられています。

![2 番目のテンプレートのパラメーター項目の編集](./media/workbooks-groups/groups-merged-away.png)

2 番目のテンプレートがグループに読み込まれると、重複するパラメーターはマージされます。すべてのパラメーターがマージされるため、内部パラメーターのステップもマージされ、その結果、テキスト ステップのみが含まれるグループになります。

### <a name="example-2-one-parameter-has-an-identical-name"></a>例 2: 同一の名前を持つ 1 つのパラメーター

最上位に 2 つのパラメーターを持つグループのテンプレートがあるとします。

- `TimeRange` - 時間の範囲パラメーター。
- `FilterB` - テキスト パラメーター。最上位のテンプレートのように `Filter` ではないことにご注意ください。

![マージされたパラメーターの結果を使用したグループ項目の編集](./media/workbooks-groups/groups-wont-merge-away.png)

グループの項目のテンプレートが読み込まれると、`TimeRange` パラメーターはグループからマージされます。 その後、ブックに `TimeRange` と `Filter` の初期パラメーター ステップが含まれ、グループのパラメーター ステップには `FilterB` のみが含まれます。

![マージされないパラメーターの結果](./media/workbooks-groups/groups-wont-merge-away-result.png)

読み込まれたテンプレートに `TimeRange` および `Filter` (`FilterB`ではなく) が含まれていた場合、結果として得られるブックには、パラメーター ステップと、テキスト ステップだけが残ったグループが含まれます。

## <a name="how-to-split-a-large-template-into-many-templates"></a>大規模なテンプレートを多数のテンプレートに分割する方法

大規模なテンプレートを複数の小さなテンプレートに分割して、一部の内容を遅延読み込みするかユーザーによる要求時に読み込むことで、パフォーマンスを向上させることができます。 これにより、最上位のテンプレートがはるかに小さくなるため、初期読み込みが高速になります。

テンプレートを複数のパーツに分割する場合は、テンプレートをすべてが個別に機能する多数のテンプレート (サブテンプレート) に効果的に分割する必要があります。 そのため、最上位のテンプレートに他のステップで使用する `TimeRange` パラメーターがある場合、サブテンプレートにも正確な名前を持つパラメーターを定義するパラメーター ステップが必要になります。 これにより、サブテンプレートは独立して機能するようになり、より大きいテンプレート内にグループで読み込むことができます。

より大きいテンプレートを複数のサブテンプレートに変換するには:

1.  共有パラメーターの後に、ブックの先頭付近に新しい空のグループを作成します。 この新しいグループは最終的にサブテンプレートになります。
2. 共有パラメーター ステップのコピーを作成し、"*グループに移動*" を使用して、手順 1 で作成したグループにコピーを移動します。 このパラメーター ステップにより、サブテンプレートが外部テンプレートから独立して機能できるようになり、外部テンプレート内に読み込まれるとマージされます。
    > [!NOTE]
    > サブテンプレートを単独で表示する予定がない場合は、厳密にいえば、サブテンプレートにはマージされるこれらのパラメーターは必要ありません。 しかし、後で必要になった場合には、編集やデバッグが非常に困難になります。

3. サブテンプレートに含めるブック内の各アイテムを、手順 1 で作成したグループに移動します。
4. 手順 3 で移動した個々のステップに条件付きの可視性があった場合は、(タブで使用されているような) 外部グループの可視性になります。 グループ内の項目からそれらを削除し、その可視性の設定をグループ自体に追加します。 ここで保存して、変更が失われるのを防ぐか、json コンテンツのコピーをエクスポートして保存します。
5. そのグループをテンプレートから読み込む場合は、グループの *[編集]* ツールバー ボタンを使用できます。 これにより、そのグループのコンテンツだけが新しいウィンドウにブックとして表示されます。 その後、必要に応じて保存して、このブック ビューを閉じることができます (ブラウザーを閉じないでください。そのビューだけが編集していた前のブックに戻ります)。
6. 次に、グループ ステップをテンプレートから読み込むように変更し、手順 5 で作成したブックまたはテンプレートに [テンプレート ID] フィールドを設定します。 ブック ID を使用するには、ソースが共有ブックのリソース ID である必要があります。 *[読み込み]* を押すと、そのグループの内容が、この外部ブック内に保存されるのではなく、そのサブテンプレートから読み込まれるようになります。

## <a name="next-steps"></a>次のステップ
- [ブックの概要](workbooks-overview.md)
- [ブックでの JSONPath の使用](workbooks-jsonpath.md)
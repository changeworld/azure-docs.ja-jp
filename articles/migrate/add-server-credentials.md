---
title: サーバーの資格情報を提供して、ソフトウェア インベントリ、依存関係、SQL Server インスタンスとデータベースを検出する
description: アプリケーション構成マネージャーでサーバーの資格情報を提供する方法について説明します
author: vineetvikram
ms.author: vivikram
ms.manager: abhemraj
ms.topic: how-to
ms.date: 03/18/2021
ms.openlocfilehash: e72d509f71704bbf8608543df5e819a9b8783935
ms.sourcegitcommit: 32e0fedb80b5a5ed0d2336cea18c3ec3b5015ca1
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/30/2021
ms.locfileid: "105562071"
---
# <a name="provide-server-credentials-to-discover-software-inventory-dependencies-and-sql-server-instances-and-databases"></a>サーバーの資格情報を提供して、ソフトウェア インベントリ、依存関係、SQL Server インスタンスとデータベースを検出する

この記事に従って、アプライアンス構成マネージャーで複数のサーバーの資格情報を追加して、ソフトウェア インベントリ (インストールされているアプリケーションの検出)、およびエージェントレスの依存関係分析を実行し、SQL Server インスタンスとデータベースを検出する方法を学習します。

> [!Note]
> VMware 環境で実行されている SQL Server インスタンスおよびデータベースの検出と評価は、現在プレビュー段階にあります。 この機能を試すには、[**このリンク**](https://aka.ms/AzureMigrate/SQL)を使用して、**オーストラリア東部** リージョンにプロジェクトを作成します。 オーストラリア東部に既にプロジェクトがあり、この機能を試したい場合は、ポータルでこれらの [**前提条件**](how-to-discover-sql-existing-project.md)が完了していることを確認してください。

[Azure Migrate アプライアンス](migrate-appliance.md)は、VMware 環境で実行されているオンプレミスのサーバーを検出して、サーバー構成とパフォーマンス メタデータを Azure に送信するために Azure Migrate: Discovery and assessment によって使用される軽量のアプライアンスです。 また、このアプライアンスは、ソフトウェア インベントリ、エージェントレスの依存関係分析、SQL Server インスタンスとデータベースの検出にも使用されます。

これらの機能を使用する場合、次の手順を実行して、サーバーの資格情報を提供することができます。 アプライアンスは自動的に資格情報をサーバーにマップして、検出機能の実行を試みます。

## <a name="add-credentials-for-servers-running-in-vmware-environment"></a>VMware 環境で実行されているサーバーの資格情報を追加する

### <a name="types-of-server-credentials-supported"></a>サポートされるサーバー資格情報の種類

アプライアンス構成マネージャーでは、複数のサーバー資格情報 (ドメイン、非ドメイン (Windows または Linux)、または SQL Server 認証資格情報) を追加できます。

サポートされるサーバー資格情報の種類の一覧を次の表に示します。

資格情報の種類 | 説明
--- | ---
**ドメイン資格情報** | **ドメイン資格情報** を追加するには、 **[資格情報の追加]** モーダルでドロップダウンからそのオプションを選択します。 <br/><br/> ドメイン資格情報を提供するには、**ドメイン名** を FQDN 形式 (例: prod.corp.contoso.com) で指定する必要があります。 <br/><br/> また、資格情報のフレンドリ名、ユーザー名、パスワードも指定する必要があります。 <br/><br/> 追加されたドメイン資格情報は自動的に、Active Directory に対してドメインの信頼性が検証されます。 これは、検出されたサーバーに対してアプライアンスがドメイン資格情報をマップしようとしたときにアカウントのロックアウトを防止するためです。 <br/><br/> アプライアンスは、検証に失敗したドメイン資格情報についてマップを試行しません。 ソフトウェア インベントリに進むには、検証に成功した少なくとも 1 つのドメイン資格情報、または少なくとも 1 つの非ドメイン資格情報が必要です。<br/><br/>Windows サーバーに対して自動的にマップされたドメイン資格情報は、ソフトウェア インベントリを実行するために使用されます。また、SQL Server インスタンスとデータベースの検出にも使用されます " _(SQL Server で Windows 認証モードを設定している場合)_ "。<br/> SQL Server でサポートされている認証モードの種類の詳細については、[こちら](/dotnet/framework/data/adonet/sql/authentication-in-sql-server)を参照してください。
**非ドメイン (Windows または Linux) 資格情報** | **Windows (非ドメイン)** または **Linux (非ドメイン)** 資格情報を追加するには、 **[資格情報の追加]** モーダルでドロップダウンから必要なオプションを選択します。 <br/><br/> 資格情報のフレンドリ名、ユーザー名、パスワードを指定する必要があります。
**SQL Server 認証資格情報** | **SQL Server 認証** 資格情報を追加するには、 **[資格情報の追加]** モーダルでドロップダウンからそのオプションを選択します。 <br/><br/> 資格情報のフレンドリ名、ユーザー名、パスワードを指定する必要があります。 <br/><br/> この種類の資格情報を追加すると、SQL Server で SQL Server 認証モードを設定している場合、VMware で実行されている SQL Server インスタンスとデータベースを検出できます。<br/> SQL Server でサポートされている認証モードの種類の詳細については、[こちら](/dotnet/framework/data/adonet/sql/authentication-in-sql-server)を参照してください。<br/><br/> アプライアンスが SQL Server 認証資格情報を使用して SQL Server インスタンスおよびデータベースを検出する前に、サーバーにインストールされている SQL を検出するためのソフトウェア インベントリを完了できるようにするためには、検証に成功した少なくとも 1 つのドメイン資格情報、または少なくとも 1 つの Windows (非ドメイン) 資格情報を提供する必要があります。

Windows または Linux の資格情報で、ソフトウェア インベントリ、エージェントレスの依存関係分析、SQL Server インスタンスとデータベースの検出を実行するために必要なアクセス許可を確認します。

### <a name="required-permissions"></a>必要なアクセス許可

次の表は、アプライアンスで提供されるサーバー資格情報で、それぞれの機能を実行するために必要なアクセス許可を示します。

機能 | Windows 資格情報 | Linux の資格情報
---| ---| ---
**ソフトウェア インベントリ** | ゲスト ユーザー アカウント | 標準または通常のユーザー アカウント (非 sudo アクセス許可)
**SQL Server インスタンスおよびデータベースの検出** | sysadmin サーバー ロールのメンバーであるユーザー アカウント。 | "_現在サポートされていない_"
**エージェントレスの依存関係の分析** | 管理アクセス許可を持つドメインまたは非ドメイン (ローカル) アカウント | ルート ユーザー アカウント、または <br/> /bin/netstat および /bin/ls の各ファイルに対してアクセス許可 CAP_DAC_READ_SEARCH および CAP_SYS_PTRACE を持つアカウント。<br/><br/> これらの機能は次のコマンドで設定します。 <br/><br/> sudo setcap CAP_DAC_READ_SEARCH,CAP_SYS_PTRACE=ep /bin/ls<br/><br/> sudo setcap CAP_DAC_READ_SEARCH,CAP_SYS_PTRACE=ep /bin/netstat

### <a name="recommended-practices-to-provide-credentials"></a>資格情報を提供するための推奨プラクティス

- [必要なアクセス許可](add-server-credentials.md#required-permissions)を持つ専用のドメイン ユーザー アカウントを作成することをお勧めします。これにより、ソフトウェア インベントリ、エージェントレスの依存関係分析、目的のサーバー上の SQL Server インスタンスとデータベースの検出を実行するスコープが設定されます。
- ソフトウェア インベントリを開始するには、検証に成功した少なくとも 1 つのドメイン資格情報、または少なくとも 1 つの非ドメイン資格情報を提供することをお勧めします。
- SQL Server で Windows 認証モードを設定している場合に SQL インスタンスとデータベースを検出するために、ドメイン資格情報を提供することができます。
- また、SQL Server で SQL Server 認証モードを構成している場合、SQL Server 認証資格情報を提供することもできます。ただし、アプライアンスが最初にソフトウェア インベントリを実行できるように、認証に成功した少なくとも 1 つのドメイン資格情報、または少なくとも 1 つの Windows (非ドメイン) 資格情報を提供することをお勧めします。

## <a name="credentials-handling-on-appliance"></a>アプライアンスでの資格情報の処理

- アプライアンス構成マネージャーで提供された資格情報はすべて、アプライアンス サーバー上にローカルに保存され、Azure には送信されません。
- アプライアンス サーバーに保存された資格情報は、データ保護 API (DPAPI) を使用して暗号化されます。
- 資格情報を追加すると、アプライアンスは、資格情報を自動的にマップして、それぞれのサーバーで検出を実行します。
- アプライアンスは、資格情報が必要な探索データをフェッチできるまで、後続のすべての検出サイクルで、サーバーに自動的にマップされた資格情報を使用します。 資格情報が機能しなくなった場合、アプライアンスは、追加された資格情報の一覧から再度マップを試み、サーバー上で進行中の検出を続行します。
- 追加されたドメイン資格情報は自動的に、Active Directory に対してドメインの信頼性が検証されます。 これは、検出されたサーバーに対してアプライアンスがドメイン資格情報をマップしようとしたときにアカウントのロックアウトを防止するためです。 アプライアンスは、検証に失敗したドメイン資格情報についてマップを試行しません。
- アプライアンスがサーバーに対してドメインまたは非ドメインの資格情報をマップできない場合、プロジェクト内のサーバーに対して "資格情報を利用できません" 状態が表示されます。

## <a name="next-steps"></a>次のステップ

[VMware 環境で実行されているサーバーの検出](tutorial-discover-vmware.md)に関するチュートリアルを確認する
<properties 
   pageTitle="StorSimple デバイスへの Update 1.2 のインストール | Microsoft Azure"
   description="StorSimple 8000 シリーズのデバイスに StorSimple 8000 シリーズの Update 1.2 をインストールする方法について説明します。"
   services="storsimple"
   documentationCenter="NA"
   authors="alkohli"
   manager="carolz"
   editor="" />
<tags 
   ms.service="storsimple"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="TBD"
   ms.date="11/16/2015"
   ms.author="alkohli" />

# StorSimple デバイスへの Update 1.2 のインストール

## 概要

このチュートリアルでは、Update 1 より前のソフトウェア バージョンを実行している StorSimple デバイスに Update 1.2 をインストールする方法について説明します。このチュートリアルではまた、ゲートウェイが StorSimple デバイスの DATA 0 以外のネットワーク インターフェイスで構成されている場合にこの更新プログラムに必要な追加の手順についても説明します。

Update 1.2 には、デバイス ソフトウェアの更新プログラム、LSI ドライバーの更新プログラム、ディスク ファームウェアの更新プログラムが含まれます。デバイス ソフトウェアと LSI ドライバーの更新プログラムは中断を伴わない更新プログラムであるため、Azure ポータルを使用して適用できます。ディスク ファームウェアの更新プログラムは中断を伴う更新プログラムであるため、デバイスの Windows PowerShell インターフェイスでのみ適用できます。

デバイスが実行しているバージョンに応じて、Update 1.2 を適用するかどうかを判断します。デバイスのソフトウェア バージョンは、デバイスの**ダッシュボード**の **[概要]** セクションに移動することで確認できます。

</br>

| 実行しているソフトウェア バージョン | ポータルの動作 |
|---------------------------------|--------------------------------------------------------------|
| リリース - GA | リリース バージョン (GA) を実行している場合は、この更新プログラムを適用しないでください。デバイスを更新するには、[Microsoft サポートにお問い合わせください](storsimple-contact-microsoft-support.md)。|
| Update 0.1 | ポータルによって Update 1.2 が適用されます。 |
| Update 0.2 | ポータルによって Update 1.2 が適用されます。 |
| Update 0.3 | ポータルによって Update 1.2 が適用されます。 |
| Update 1 | この更新プログラムは使用できません。 |
| Update 1.1 | この更新プログラムは使用できません。 |

</br>

> [AZURE.IMPORTANT]
 
> -  更新プログラムは段階的に公開されるため、Update 1.2 が即座に表示されない場合があります。これらの更新プログラムは間もなく利用可能になるため、数日後にもう一度更新プログラムの有無を確認してください。
> - この更新プログラムには、ハードウェアの状態とネットワーク接続の点からデバイスの正常性を判断するための、手動と自動の一連の事前チェックが含まれます。これらの事前チェックは、Azure ポータルから更新プログラムを適用する場合にのみ実行されます。 
> - ソフトウェアとドライバーの更新プログラムのインストールには Azure ポータルを使用することをお勧めします。ポータルで更新前のゲートウェイのチェックに失敗した場合のみ、(更新プログラムをインストールする) デバイスの Windows PowerShell インターフェイスに移動してください。更新プログラムのインストールには、(Windows の更新プログラムを含めて) 5 ～ 10 時間がかかる場合があります。メンテナンス モードの更新プログラムは、デバイスの Windows PowerShell インターフェイスからインストールする必要があります。メンテナンス モードの更新プログラムは中断を伴う更新プログラムであるため、デバイスにダウンタイムが発生します。

## 更新プログラムの準備
更新プログラムをスキャンして適用する前に、次の手順を実行する必要があります。


1. デバイス データのクラウド スナップショットを取得します。

2. コントローラーの固定 IP アドレスがルーティング可能でインターネットに接続できることを確認します。これらの固定 IP は、デバイスに更新プログラムを提供するために使用されます。デバイスの Windows PowerShell インターフェイスから、各コントローラーで次のコマンドレットを実行してこれをテストできます。

 	`Test-Connection -Source <Fixed IP of your device controller> -Destination <Any IP or computer name outside of datacenter network> `
 
	**固定 IP でインターネットに接続できるときの Test-Connection のサンプル出力**

	    
		Controller0>Test-Connection -Source 10.126.173.91 -Destination bing.com
	    
	    Source	  Destination 	IPV4Address      IPV6Address
	    ----------------- -----------  -----------
	    HCSNODE0  bing.com		204.79.197.200
	    HCSNODE0  bing.com		204.79.197.200
	    HCSNODE0  bing.com		204.79.197.200
	    HCSNODE0  bing.com		204.79.197.200
	
		Controller0>Test-Connection -Source 10.126.173.91 -Destination  204.79.197.200

	    Source	  Destination 	  IPV4Address    IPV6Address
	    ----------------- -----------  -----------
	    HCSNODE0  204.79.197.200  204.79.197.200
	    HCSNODE0  204.79.197.200  204.79.197.200
	    HCSNODE0  204.79.197.200  204.79.197.200
	    HCSNODE0  204.79.197.200  204.79.197.200

これらの手動の事前チェックが正常に完了した後で、更新プログラムのスキャンとインストールを開始できます。

## Azure ポータルを使用して Update 1.2 をインストールする 

この手順は、ゲートウェイがデバイスの DATA 0 のネットワーク インターフェイスで構成されている場合にのみ使用します。デバイスを更新するには、次の手順を実行します。

[AZURE.INCLUDE [storsimple-install-update-via-portal](../../includes/storsimple-install-update-via-portal.md)]

## ゲートウェイが DATA 0 以外のネットワーク インターフェイスで構成されているデバイスに Update 1.2 をインストールする 

Azure ポータルから更新プログラムをインストールしようとしたときにゲートウェイのチェックに失敗した場合にのみ、この手順を使用してください。このチェックは、DATA 0 以外のネットワーク インターフェイスに割り当てられているゲートウェイがある場合に、デバイスが Update 1 より前のソフトウェア バージョンを実行していると、失敗します。デバイスのゲートウェイが DATA 0 以外のネットワーク インターフェイスで設定されていない場合、Azure ポータルから直接デバイスを更新できます。「[Azure ポータルを使用して Update 1.2 をインストールする](#install-update-12-via-the-azure-portal)」を参照してください。

この方法でアップグレードできるソフトウェアのバージョンは、Update 0.1、Update 0.2、Update 0.3 です。


> [AZURE.IMPORTANT]
> 
> - デバイスがリリース (GA) バージョンを実行している場合、この更新プログラムの使用については、[Microsoft サポート](storsimple-contact-microsoft-support.md)にお問い合わせください。
> - この手順は、Update 1.2 を適用するために 1 回だけ実行する必要があります。以降の更新プログラムは、Azure ポータルを使用して適用できます。

デバイスが Update 1 よりも前のソフトウェアを実行していて、ゲートウェイが DATA 0 以外のネットワーク インターフェイスで設定されている場合、次の 2 つの方法で Update 1.2 を適用できます。

- **方法 1**: デバイスの Windows PowerShell インターフェイスから、`Start-HcsHotfix` コマンドレットを使用して更新プログラムをダウンロードして適用します。これが推奨される方法です。**デバイスが Update 1.0 または Update 1.1 を実行している場合は、この方法で Update 1.2 を適用しないでください。** 

- **方法 2**: ゲートウェイ構成を削除し、Azure ポータルから直接更新プログラムをインストールします。


個々の詳細な手順は、次のセクションに記載されています。

## 方法 1: StorSimple 用 Windows PowerShell を使用して Update 1.2 を修正プログラムとして適用する

Update 0.1、0.2、0.3 を実行している場合、および Azure ポータルから更新プログラムをインストールしようとしたときにゲートウェイのチェックが失敗した場合のみ、この手順を使用してください。リリース (GA) ソフトウェアを実行している場合、デバイスの更新については、[Microsoft サポート](storsimple-contact-microsoft-support.md)にお問い合わせください。

この手順を使用して更新プログラムを適用する前に、次のことを確認します。

- 両方のデバイス コントローラーがオンラインである。

Update 1.2 を適用するには、次の手順を実行します。**この更新プログラムは、完了するまでに約 2 時間かかる場合があります (ソフトウェアに約 30 分、ドライバーに約 30 分、ディスク ファームウェアに約 45 分)。**

[AZURE.INCLUDE [storsimple-install-update-option1](../../includes/storsimple-install-update-option1.md)]


## 方法 2: ゲートウェイの構成を削除した後で、Azure ポータルを使用して Update 1.2 を適用する

この手順は、Update 1 よりも前のソフトウェア バージョンを実行していて、ゲートウェイが DATA 0 以外のネットワーク インターフェイスで設定されている StorSimple デバイスのみに当てはまります。更新プログラムを適用する前に、ゲートウェイの設定をクリアする必要があります。
 
更新の完了に数時間かかる場合があります。ホストが別のサブネットにある場合、iSCSI インターフェイスでゲートウェイの構成を削除すると、ダウンタイムが発生する場合があります。ダウンタイムを抑えるために、DATA 0 を iSCSI トラフィック用に構成することをお勧めします。
 
ゲートウェイとのネットワーク インターフェイスを無効にして更新プログラムを適用するには、次の手順を実行します。
 
[AZURE.INCLUDE [storsimple-install-update-option2](../../includes/storsimple-install-update-option2.md)]

## 更新プログラムのエラーに関するトラブルシューティング

**アップグレード前のチェックが失敗したことを示す通知が表示されるとどうなりますか。**

事前チェックに失敗した場合は、ページの下部に詳細な通知バーが表示されていることを確認します。ここには、どの事前チェックが失敗したかに関するガイダンスが表示されます。次の図に、このような通知が表示される場合の例を示します。この場合は、コントローラーの正常性チェックとハードウェア コンポーネントの正常性チェックに失敗しています。**[ハードウェアの状態]** セクションで、**コントローラー 0** と**コントローラー 1** の両方のコンポーネントに注意する必要があることがわかります。
 
  ![事前チェックのエラー](./media/storsimple-install-update-1/HCS_PreUpdateCheckFailed-include.png)

両方のコントローラーが正常な状態でオンラインであるかどうかを確認する必要があります。[メンテナンス] ページで、StorSimple デバイス内のすべてのハードウェア コンポーネントが正常であると表示されているかどうかも確認する必要があります。確認したら更新プログラムをインストールできます。ハードウェア コンポーネントの問題を解決できない場合は、Microsoft サポートに対処法をお問い合わせいただく必要があります。

**更新プログラムをインストールできないことを示すエラー メッセージが表示され、更新プログラムに関するトラブルシューティング ガイドを参照してエラーの原因を特定するよう推奨されている場合はどうすればよいですか。**

この問題で考えられる原因の 1 つは、Microsoft Update サーバーに接続できないことです。この場合、手動チェックを実行する必要があります。Update サーバーに接続できない場合は、更新ジョブは失敗します。StorSimple デバイスの Windows PowerShell インターフェイスから次のコマンドレットを実行して、接続を確認できます。

 `Test-Connection -Source <Fixed IP of your device controller> -Destination <Any IP or computer name outside of datacenter>`

両方のコントローラーでコマンドレットを実行します。
 
接続の存在を確認したにもかかわらず、この問題が解決しない場合は、Microsoft サポートに対処法をお問い合わせください。


## 次のステップ

詳細については、[Update 1.2 リリース](storsimple-update1-release-notes.md)に関するページを参照してください。

<!---HONumber=Nov15_HO4-->
---
author: dlepow
ms.service: virtual-machines-linux
ms.topic: include
ms.date: 07/10/2019
ms.author: danlep
ms.openlocfilehash: 35f506235f698fbcf42308e6f0b0f400e925df29
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/27/2020
ms.locfileid: "68361267"
---
### <a name="bastion-tier"></a>要塞層

要塞ホストは、アプリケーションおよびデータベース インスタンスにアクセスするためのジャンプ サーバーとして使用できるオプション コンポーネントです。 要塞ホスト VM には、パブリック IP アドレスを割り当てることができます (ただし推奨されるのは、オンプレミス ネットワークとの間に ExpressRoute 接続またはサイト間 VPN を設定してアクセスの安全性を確保することです)。 加えて、受信トラフィック用に SSH (ポート 22、Linux) または RDP (ポート 3389、Windows Server) のみを開放する必要があります。 高可用性を確保するために、要塞ホストは 2 つの可用性ゾーンまたは 1 つの可用性セットにデプロイしてください。

また、ご利用の VM で SSH エージェント転送を有効にすれば、要塞ホストから資格情報を転送することによって仮想ネットワーク内の他の VM にアクセスすることができます。 または、SSH トンネリングを使用して他のインスタンスにアクセスすることもできます。

エージェント転送の例を次に示します。

```
ssh -A -t user@BASTION_SERVER_IP ssh -A root@TARGET_SERVER_IP`
```

このコマンドは、要塞に接続した後、すぐに `ssh` を再実行して、ターゲット インスタンス上のターミナルを取得しています。 実際のクラスターの構成が異なる場合は、ターゲット インスタンスに対して root 以外のユーザーを指定しなければならないことがあります。 `-A` 引数により、ローカル コンピューター上の秘密キーが自動的に使用されるようにエージェント接続が転送されます。 エージェント転送はチェーンであるため、ターゲット インスタンスから開始された後続の SSH 接続でもローカルの秘密キーが使用されるよう、2 つ目の `ssh` コマンドにも `-A` が含まれていることに注意してください。